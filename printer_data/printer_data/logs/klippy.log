===== Config file =====
[virtual_sdcard]
path = ~/printer_data/gcodes
on_error_gcode = CANCEL_PRINT

[pause_resume]

[display_status]

[respond]

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = CANCEL_PRINT_BASE
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set allow_park = client.park_at_cancel|default(false)|lower == 'true' %}
	{% set retract = client.cancel_retract|default(5.0)|abs %}
	
	{% set park_x = "" if (client.park_at_cancel_x|default(none) is none)
	else "X=" ~ client.park_at_cancel_x %}
	{% set park_y = "" if (client.park_at_cancel_y|default(none) is none)
	else "Y=" ~ client.park_at_cancel_y %}
	{% set custom_park = park_x|length > 0 or park_y|length > 0 %}
	
	
	{% if printer['gcode_macro RESUME'].restore_idle_timeout > 0 %}
	SET_IDLE_TIMEOUT TIMEOUT={printer['gcode_macro RESUME'].restore_idle_timeout}
	{% endif %}
	{% if (custom_park or not printer.pause_resume.is_paused) and allow_park %} _TOOLHEAD_PARK_PAUSE_CANCEL {park_x} {park_y} {% endif %}
	_CLIENT_RETRACT LENGTH={retract}
	TURN_OFF_HEATERS
	M106 S0
	{client.user_cancel_macro|default("")}
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=idle_state VALUE=False
	
	SET_PAUSE_NEXT_LAYER ENABLE=0
	SET_PAUSE_AT_LAYER ENABLE=0 LAYER=0
	CANCEL_PRINT_BASE

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = PAUSE_BASE
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set idle_timeout = client.idle_timeout|default(0) %}
	{% set temp = printer[printer.toolhead.extruder].target if printer.toolhead.extruder != '' else 0 %}
	{% set restore = False if printer.toolhead.extruder == ''
	else True  if params.RESTORE|default(1)|int == 1 else False %}
	
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=last_extruder_temp VALUE="{{'restore': restore, 'temp': temp}}"
	
	{% if idle_timeout > 0 %}
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=restore_idle_timeout VALUE={printer.configfile.settings.idle_timeout.timeout}
	SET_IDLE_TIMEOUT TIMEOUT={idle_timeout}
	{% endif %}
	PAUSE_BASE
	{client.user_pause_macro|default("")}
	_TOOLHEAD_PARK_PAUSE_CANCEL {rawparams}

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = RESUME_BASE
variable_last_extruder_temp = {'restore': False, 'temp': 0}
variable_restore_idle_timeout = 0
variable_idle_state = False
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set sp_move = client.speed_move|default(velocity) %}
	{% set runout_resume = True if client.runout_sensor|default("") == ""
	else True if not printer[client.runout_sensor].enabled
	else printer[client.runout_sensor].filament_detected %}
	{% set can_extrude = True if printer.toolhead.extruder == ''
	else printer[printer.toolhead.extruder].can_extrude %}
	{% set do_resume = False %}
	{% set prompt_txt = [] %}
	
	
	{% if printer.idle_timeout.state|upper == "IDLE" or idle_state %}
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=idle_state VALUE=False
	{% if last_extruder_temp.restore %}
	
	RESPOND TYPE=echo MSG='{"Restoring \"%s\" temperature to %3.1f\u00B0C, this may take some time" % (printer.toolhead.extruder, last_extruder_temp.temp) }'
	M109 S{last_extruder_temp.temp}
	{% set do_resume = True %}
	{% elif can_extrude %}
	{% set do_resume = True %}
	{% else %}
	RESPOND TYPE=error MSG='{"Resume aborted !!! \"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder}'
	{% set _d = prompt_txt.append("\"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder) %}
	{% endif %}
	
	{% elif can_extrude %}
	{% set do_resume = True %}
	{% else %}
	RESPOND TYPE=error MSG='{"Resume aborted !!! \"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder}'
	{% set _d = prompt_txt.append("\"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder) %}
	{% endif %}
	{% if runout_resume %}
	{% if do_resume %}
	{% if restore_idle_timeout > 0 %} SET_IDLE_TIMEOUT TIMEOUT={restore_idle_timeout} {% endif %}
	{client.user_resume_macro|default("")}
	_CLIENT_EXTRUDE
	RESUME_BASE VELOCITY={params.VELOCITY|default(sp_move)}
	{% endif %}
	{% else %}
	RESPOND TYPE=error MSG='{"Resume aborted !!! \"%s\" detects no filament, please load filament and press RESUME" % (client.runout_sensor.split(" "))[1]}'
	{% set _d = prompt_txt.append("\"%s\" detects no filament, please load filament and press RESUME" % (client.runout_sensor.split(" "))[1]) %}
	{% endif %}
	
	{% if not (runout_resume and do_resume) %}
	RESPOND TYPE=command MSG="action:prompt_begin RESUME aborted !!!"
	{% for element in prompt_txt %}
	RESPOND TYPE=command MSG='{"action:prompt_text %s" % element}'
	{% endfor %}
	RESPOND TYPE=command MSG="action:prompt_footer_button Ok|RESPOND TYPE=command MSG=action:prompt_end|info"
	RESPOND TYPE=command MSG="action:prompt_show"
	{% endif %}

[gcode_macro SET_PAUSE_NEXT_LAYER]
description = Enable a pause if the next layer is reached
gcode = 
	{% set pause_next_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_next_layer %}
	{% set ENABLE = params.ENABLE|default(1)|int != 0 %}
	{% set MACRO = params.MACRO|default(pause_next_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_next_layer VALUE="{{ 'enable': ENABLE, 'call': MACRO }}"

[gcode_macro SET_PAUSE_AT_LAYER]
description = Enable/disable a pause if a given layer number is reached
gcode = 
	{% set pause_at_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_at_layer %}
	{% set ENABLE = params.ENABLE|int != 0 if params.ENABLE is defined
	else params.LAYER is defined %}
	{% set LAYER = params.LAYER|default(pause_at_layer.layer)|int %}
	{% set MACRO = params.MACRO|default(pause_at_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_at_layer VALUE="{{ 'enable': ENABLE, 'layer': LAYER, 'call': MACRO }}"

[gcode_macro SET_PRINT_STATS_INFO]
rename_existing = SET_PRINT_STATS_INFO_BASE
description = Overwrite, to get pause_next_layer and pause_at_layer feature
variable_pause_next_layer = { 'enable': False, 'call': "PAUSE" }
variable_pause_at_layer = { 'enable': False, 'layer': 0, 'call': "PAUSE" }
gcode = 
	{% if pause_next_layer.enable %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_next_layer" % pause_next_layer.call}'
	{pause_next_layer.call}
	SET_PAUSE_NEXT_LAYER ENABLE=0
	{% elif pause_at_layer.enable and params.CURRENT_LAYER is defined and params.CURRENT_LAYER|int == pause_at_layer.layer %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_at_layer [%d]" % (pause_at_layer.call, pause_at_layer.layer)}'
	{pause_at_layer.call}
	SET_PAUSE_AT_LAYER ENABLE=0
	{% endif %}
	SET_PRINT_STATS_INFO_BASE {rawparams}

[gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL]
description = Helper: park toolhead used in PAUSE and CANCEL_PRINT
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set use_custom     = client.use_custom_pos|default(false)|lower == 'true' %}
	{% set custom_park_x  = client.custom_park_x|default(0.0) %}
	{% set custom_park_y  = client.custom_park_y|default(0.0) %}
	{% set park_dz        = client.custom_park_dz|default(2.0)|abs %}
	{% set sp_hop         = client.speed_hop|default(15) * 60 %}
	{% set sp_move        = client.speed_move|default(velocity) * 60 %}
	
	{% set origin    = printer.gcode_move.homing_origin %}
	{% set act       = printer.gcode_move.gcode_position %}
	{% set max       = printer.toolhead.axis_maximum %}
	{% set cone      = printer.toolhead.cone_start_z|default(max.z) %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	
	{% set z_min = params.Z_MIN|default(0)|float %}
	{% set z_park = [[(act.z + park_dz), z_min]|max, (max.z - origin.z)]|min %}
	{% set x_park = params.X       if params.X is defined
	else custom_park_x  if use_custom
	else 0.0            if round_bed
	else (max.x - 5.0) %}
	{% set y_park = params.Y       if params.Y is defined
	else custom_park_y  if use_custom
	else (max.y - 5.0)  if round_bed and z_park < cone
	else 0.0            if round_bed
	else (max.y - 5.0) %}
	
	_CLIENT_RETRACT
	{% if "xyz" in printer.toolhead.homed_axes %}
	G90
	G1 Z{z_park} F{sp_hop}
	G1 X{x_park} Y{y_park} F{sp_move}
	{% if not printer.gcode_move.absolute_coordinates %} G91 {% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='Printer not homed'
	{% endif %}

[gcode_macro _CLIENT_EXTRUDE]
description = Extrudes, if the extruder is hot enough
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set use_fw_retract = (client.use_fw_retract|default(false)|lower == 'true') and (printer.firmware_retraction is defined) %}
	{% set length = params.LENGTH|default(client.unretract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_unretract)|default(35) %}
	{% set absolute_extrude = printer.gcode_move.absolute_extrude %}
	
	{% if printer.toolhead.extruder != '' %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if use_fw_retract %}
	{% if length < 0 %}
	G10
	{% else %}
	G11
	{% endif %}
	{% else %}
	M83
	G1 E{length} F{(speed|float|abs) * 60}
	{% if absolute_extrude %}
	M82
	{% endif %}
	{% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='{"\"%s\" not hot enough" % printer.toolhead.extruder}'
	{% endif %}
	{% endif %}

[gcode_macro _CLIENT_RETRACT]
description = Retracts, if the extruder is hot enough
gcode = 
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set length = params.LENGTH|default(client.retract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_retract)|default(35) %}
	
	_CLIENT_EXTRUDE LENGTH=-{length|float|abs} SPEED={speed|float|abs}

[gcode_macro START_PRINT]
gcode = 
	{% set BED_TEMP = params.BED_TEMP|default(55)|float %}
	{% set EXTRUDER_TEMP = params.EXTRUDER_TEMP|default(200)|float %}
	M117 Print Starting...
	G28 X Y
	G90
	M220 S100
	M221 S100
	G92 E0
	
	
	
	
	
	
	M140 S{BED_TEMP}
	
	M190 S{BED_TEMP}
	
	M117 Waiting for temperature
	
	
	M117 Homing All...
	
	G90
	
	G28
	
	M117 Z-Tilt Adjust
	Z_TILT_ADJUST
	
	M117 Generating mesh
	
	BED_MESH_CLEAR
	
	BED_MESH_CALIBRATE
	
	BED_MESH_PROFILE LOAD=default
	
	G1 X100 Y392 F10000
	
	M117 Heaters Recovering...
	
	
	M109 S{EXTRUDER_TEMP} T0; start warming extruder to preheat temp
	
	
	M117 Purging extruder...
	
	
	CLEAN_AND_PURGE_NOZZLE
	
	M117 Printing.....
	UPDATE_DELAYED_GCODE ID=clear_display DURATION=10

[gcode_macro END_PRINT]
gcode = 
	
	{% set th = printer.toolhead %}
	{% set x_safe = th.position.x + 20 * (1 if th.axis_maximum.x - th.position.x > 20 else -1) %}
	{% set y_safe = th.position.y + 20 * (1 if th.axis_maximum.y - th.position.y > 20 else -1) %}
	{% set z_safe = [th.position.z + 2, th.axis_maximum.z]|min %}
	
	SAVE_GCODE_STATE NAME=STATE_PRINT_END
	
	
	
	M400
	G92 E0
	
	G91
	G1 E-0.7 Z+5 F3000
	G90
	
	TURN_OFF_HEATERS
	
	G0 X{x_safe} Y{y_safe} Z{z_safe} F20000
	G0 X{th.axis_maximum.x//2} Y{th.axis_maximum.y - 2} F3600
	
	AFTER_PRINT_CLEAN_NOZZLE
	
	G0 X{th.axis_maximum.x/2} Y{th.axis_maximum.y - 2} F3600
	
	TURN_OFF_HEATERS
	
	M84 X Y E
	
	
	SET_PRESSURE_ADVANCE ADVANCE=0.0
	M117 Pressure Advance Set 0.0
	
	
	
	
	BED_MESH_CLEAR
	
	
	
	
	
	M117 Print Finished
	UPDATE_DELAYED_GCODE ID=clear_display DURATION=10
	
	RESTORE_GCODE_STATE NAME=STATE_PRINT_END

[gcode_macro PRIME_LINE]
gcode = 
	M117 Prime Line
	G92 E0
	
	G1 Z2.0 F3000
	
	G1 X40 Y2 Z0.3 F5000.0
	G1 X120 Y2 Z0.3 F500.0 E15
	G1 X120 Y2.3 Z0.3 F5000.0
	G1 X40 Y2.3 Z0.3 F500.0 E30
	G92 E0
	G1 Z2.0 F3000

[gcode_macro CLEAN_NOZZLE]
variable_start_x = 63
variable_start_y = 387
variable_wipe_dist_y = -3
variable_wipe_qty = 5
variable_wipe_spd = 50
variable_end_loc_x = 189
variable_end_loc_y = 185
gcode = 
	SAVE_GCODE_STATE NAME=STATE_PRINT_CURRENT
	
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	G90
	M220 S100
	M204 S100
	M221 S100
	
	
	G1 X{start_x} Y{start_y} F6000
	
	
	{% for wipes in range(1, (wipe_qty + 1)) %}
	
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	
	{% endfor %}
	
	G1 X{end_loc_x} F10000
	
	RESTORE_GCODE_STATE NAME=STATE_PRINT_CURRENT

[gcode_macro CLEAN_AND_PURGE_NOZZLE]
variable_start_x = 63
variable_start_y = 387
variable_start_z = 10
variable_wipe_dist_y = -3
variable_wipe_qty = 5
variable_wipe_spd = 50
variable_purge_loc_x = 100
variable_purge_loc_y = 392
variable_post_purge_y = 386
variable_end_loc_x = 189
variable_end_loc_y = 185
gcode = 
	SAVE_GCODE_STATE NAME=STATE_PRINT_CURRENT
	
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	G90
	
	
	
	
	
	G1 X{start_x} Y{start_y} F6000
	
	
	{% for wipes in range(1, (wipe_qty + 1)) %}
	
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	
	{% endfor %}
	
	G1 X{purge_loc_x}
	G1 Y{purge_loc_y}
	G92 E0
	G1 E30.0 F100
	G92 E0
	G1 E-0.5 F300
	
	G1 Y{post_purge_y} F10000
	G1 X{start_x}
	G1 X{end_loc_x} F10000
	
	RESTORE_GCODE_STATE NAME=STATE_PRINT_CURRENT

[gcode_macro AFTER_PRINT_CLEAN_NOZZLE]
variable_start_x = 63
variable_start_y = 387
variable_wipe_dist_y = -3
variable_wipe_qty = 5
variable_wipe_spd = 50
gcode = 
	SAVE_GCODE_STATE NAME=STATE_PRINT_CURRENT
	
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	G90
	
	
	
	
	G1 X{start_x} Y{start_y} F6000
	
	
	{% for wipes in range(1, (wipe_qty + 1)) %}
	
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	
	{% endfor %}
	
	RESTORE_GCODE_STATE NAME=STATE_PRINT_CURRENT

[delayed_gcode clear_display]
gcode = 
	M117

[gcode_macro Probe_Z_Height]
gcode = 
	G28
	
	PROBE_CALIBRATE

[gcode_macro automatic_bed_screw_adjust]
gcode = 
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	SCREWS_TILT_CALCULATE

[gcode_macro z_motor_alignment]
gcode = 
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	Z_TILT_ADJUST

[gcode_macro Accelerometer_Connection_Test]
gcode = 
	ACCELEROMETER_QUERY

[gcode_macro X_Axis_Resonance_Test]
gcode = 
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	TEST_RESONANCES AXIS=X

[gcode_macro Y_Axis_Resonance_Test]
gcode = 
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	TEST_RESONANCES AXIS=Y

[gcode_macro BED_MESH_CALIBRATE]
rename_existing = _BED_MESH_CALIBRATE
gcode = 
	
	{% set all_points = printer.exclude_object.objects | map(attribute='polygon') | sum(start=[]) %}
	{% set bed_mesh_min = printer.configfile.settings.bed_mesh.mesh_min %}
	{% set bed_mesh_max = printer.configfile.settings.bed_mesh.mesh_max %}
	{% set probe_count = printer.configfile.settings.bed_mesh.probe_count %}
	{% set kamp_settings = printer["gcode_macro _KAMP_Settings"] %}
	{% set verbose_enable = kamp_settings.verbose_enable | abs %}
	{% set probe_dock_enable = kamp_settings.probe_dock_enable | abs %}
	{% set attach_macro = kamp_settings.attach_macro | string %}
	{% set detach_macro = kamp_settings.detach_macro | string %}
	{% set mesh_margin = kamp_settings.mesh_margin | float %}
	{% set fuzz_amount = kamp_settings.fuzz_amount | float %}
	{% set probe_count = probe_count if probe_count|length > 1 else probe_count * 2  %}
	{% set max_probe_point_distance_x = ( bed_mesh_max[0] - bed_mesh_min[0] ) / (probe_count[0] - 1)  %}
	{% set max_probe_point_distance_y = ( bed_mesh_max[1] - bed_mesh_min[1] ) / (probe_count[1] - 1)  %}
	{% set x_min = all_points | map(attribute=0) | min | default(bed_mesh_min[0]) %}
	{% set y_min = all_points | map(attribute=1) | min | default(bed_mesh_min[1]) %}
	{% set x_max = all_points | map(attribute=0) | max | default(bed_mesh_max[0]) %}
	{% set y_max = all_points | map(attribute=1) | max | default(bed_mesh_max[1]) %}
	
	{% set fuzz_range = range((0) | int, (fuzz_amount * 100) | int + 1) %}
	{% set adapted_x_min = x_min - mesh_margin - (fuzz_range | random / 100.0) %}
	{% set adapted_y_min = y_min - mesh_margin - (fuzz_range | random / 100.0) %}
	{% set adapted_x_max = x_max + mesh_margin + (fuzz_range | random / 100.0) %}
	{% set adapted_y_max = y_max + mesh_margin + (fuzz_range | random / 100.0) %}
	
	{% set adapted_x_min = [adapted_x_min , bed_mesh_min[0]] | max %}
	{% set adapted_y_min = [adapted_y_min , bed_mesh_min[1]] | max %}
	{% set adapted_x_max = [adapted_x_max , bed_mesh_max[0]] | min %}
	{% set adapted_y_max = [adapted_y_max , bed_mesh_max[1]] | min %}
	
	{% set points_x = (((adapted_x_max - adapted_x_min) / max_probe_point_distance_x) | round(method='ceil') | int) + 1 %}
	{% set points_y = (((adapted_y_max - adapted_y_min) / max_probe_point_distance_y) | round(method='ceil') | int) + 1 %}
	
	{% if (([points_x, points_y]|max) > 6) %}
	{% set algorithm = "bicubic" %}
	{% set min_points = 4 %}
	{% else %}
	{% set algorithm = "lagrange" %}
	{% set min_points = 3 %}
	{% endif %}
	
	{% set points_x = [points_x , min_points]|max %}
	{% set points_y = [points_y , min_points]|max %}
	{% set points_x = [points_x , probe_count[0]]|min %}
	{% set points_y = [points_y , probe_count[1]]|min %}
	
	{% if verbose_enable == True %}
	{% if printer.exclude_object.objects != [] %}
	
	{ action_respond_info( "Algorithm: {}.".format(
	(algorithm),
	)) }
	
	{ action_respond_info("Default probe count: {},{}.".format(
	(probe_count[0]),
	(probe_count[1]),
	)) }
	
	{ action_respond_info("Adapted probe count: {},{}.".format(
	(points_x),
	(points_y),
	)) }
	
	{action_respond_info("Default mesh bounds: {}, {}.".format(
	(bed_mesh_min[0],bed_mesh_min[1]),
	(bed_mesh_max[0],bed_mesh_max[1]),
	)) }
	
	{% if mesh_margin > 0 %}
	{action_respond_info("Mesh margin is {}, mesh bounds extended by {}mm.".format(
	(mesh_margin),
	(mesh_margin),
	)) }
	{% else %}
	{action_respond_info("Mesh margin is 0, margin not increased.")}
	{% endif %}
	
	{% if fuzz_amount > 0 %}
	{action_respond_info("Mesh point fuzzing enabled, points fuzzed up to {}mm.".format(
	(fuzz_amount),
	)) }
	{% else %}
	{action_respond_info("Fuzz amount is 0, mesh points not fuzzed.")}
	{% endif %}
	
	{ action_respond_info("Adapted mesh bounds: {}, {}.".format(
	(adapted_x_min, adapted_y_min),
	(adapted_x_max, adapted_y_max),
	)) }
	
	{action_respond_info("KAMP adjustments successful. Happy KAMPing!")}
	
	{% else %}
	
	{action_respond_info("No objects detected! Check your gcode and make sure that EXCLUDE_OBJECT_DEFINE is happening before BED_MESH_CALIBRATE is called. Defaulting to regular meshing.")}
	G4 P5000
	{% endif %}
	
	{% endif %}
	
	{% if probe_dock_enable == True %}
	{attach_macro}
	{% endif %}
	
	_BED_MESH_CALIBRATE mesh_min={adapted_x_min},{adapted_y_min} mesh_max={adapted_x_max},{adapted_y_max} ALGORITHM={algorithm} PROBE_COUNT={points_x},{points_y}
	
	{% if probe_dock_enable == True %}
	{detach_macro}
	{% endif %}

[gcode_macro _KAMP_Settings]
description = This macro contains all adjustable settings for KAMP
variable_verbose_enable = True
variable_mesh_margin = 0
variable_fuzz_amount = 0
variable_probe_dock_enable = False
variable_attach_macro = 'Attach_Probe'
variable_detach_macro = 'Dock_Probe'
variable_purge_height = 0.8
variable_tip_distance = 0
variable_purge_margin = 10
variable_purge_amount = 30
variable_flow_rate = 12
variable_smart_park_height = 10
gcode = 
	
	{action_respond_info(" Running the KAMP_Settings macro does nothing, it is only used for storing KAMP settings. ")}

[led_effect sb_logo_busy]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (1,0,0)

[led_effect sb_logo_cleaning]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 0.02, 0.5)

[led_effect sb_logo_calibrating_z]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 0.0, 0.35)

[led_effect sb_logo_heating]
leds = 
	neopixel:sb_leds (1,3,7,8,6,2)
autostart = false
frame_rate = 24
layers = 
	comet  0.3  0 add (1, 0.18, 0)

[led_effect sb_logo_cooling]
leds = 
	neopixel:sb_leds (1,3,7,8,6,2)
autostart = false
frame_rate = 24
layers = 
	comet  0.3  0 add (0, 0, 1)

[led_effect sb_logo_homing]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 0.6, 0.2)

[led_effect sb_logo_leveling]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.5, 0.1, 0.4)

[led_effect sb_logo_meshing]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.2, 1.0, 0.0)

[led_effect sb_logo_printing]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	gradient  0.3  1 add (0.3, 0.0, 0.0),(0.3, 0.3, 0.0),(0.3, 0.1, 0.0)

[led_effect sb_logo_standby]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.01, 0.01, 0.01)

[led_effect sb_logo_part_ready]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 1.0, 0.0)

[led_effect sb_nozzle_heating]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (1.0, 0.18, 0.0, 0.0)

[led_effect sb_nozzle_cooling]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (0.0, 0.0, 1.0, 0.1)

[led_effect sb_nozzle_standby]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (0.6, 0.0, 0.0, 0.0)

[led_effect sb_nozzle_part_ready]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (0.6, 1.0, 0.0, 0.1)

[led_effect sb_critical_error]
leds = 
	neopixel:sb_leds
layers = 
	strobe         1  1.5   add        (1.0,  1.0, 1.0)
	breathing      2  0     difference (0.95, 0.0, 0.0)
	static         1  0     top        (1.0,  0.0, 0.0)
autostart = false
frame_rate = 24
run_on_error = true

[led_effect rainbow]
leds = 
	neopixel:chamber_leds
autostart = false
frame_rate = 24
layers = 
	gradient  0.3  1 add (0.3, 0.0, 0.0),(0.0, 0.3, 0.0),(0.0, 0.0, 0.3)

[led_effect set_nozzle_leds]
leds = 
	neopixel:sb_leds (9,10)
autostart = false
frame_rate = 24
layers = 
	static         0  0     top        (0.0,  0.0, 0.0, 1.0)

[led_effect set_logo_leds]
leds = 
	neopixel:sb_leds (1,2,3,4,5,6,7,8)
autostart = false
frame_rate = 24
layers = 
	static         0  0     top        (1.0,  1.0, 1.0)

[led_effect set_chamber_leds]
leds = 
	neopixel:chamber_leds
autostart = false
frame_rate = 24
layers = 
	static         0  0     top        (1.0,  1.0, 1.0)

[gcode_macro set_logo_leds_off]
gcode = 
	SET_LED_EFFECT EFFECT=set_logo_leds STOP=1

[gcode_macro set_logo_leds_on]
gcode = 
	SET_LED_EFFECT EFFECT=set_logo_leds

[gcode_macro set_nozzle_leds_on]
gcode = 
	SET_LED_EFFECT EFFECT=set_nozzle_leds

[gcode_macro set_nozzle_leds_off]
gcode = 
	SET_LED_EFFECT EFFECT=set_nozzle_leds STOP=1

[gcode_macro set_chamber_leds_off]
gcode = 
	SET_LED_EFFECT EFFECT=set_chamber_leds STOP=1

[gcode_macro set_chamber_leds_on]
gcode = 
	SET_LED_EFFECT EFFECT=set_chamber_leds

[gcode_macro status_off]
gcode = 
	STOP_LED_EFFECTS

[gcode_macro status_ready]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=rainbow

[gcode_macro status_part_ready]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_nozzle_part_ready
	SET_LED_EFFECT EFFECT=sb_logo_part_ready

[gcode_macro status_busy]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_busy
	set_nozzle_leds_on

[gcode_macro status_heating]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_heating
	SET_LED_EFFECT EFFECT=sb_nozzle_heating

[gcode_macro status_cooling]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_cooling
	SET_LED_EFFECT EFFECT=sb_nozzle_cooling

[gcode_macro status_leveling]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_leveling
	set_nozzle_leds_on

[gcode_macro status_homing]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_homing
	set_nozzle_leds_on

[gcode_macro status_cleaning]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_cleaning
	set_nozzle_leds_on

[gcode_macro status_meshing]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_meshing
	set_nozzle_leds_on

[gcode_macro status_calibrating_z]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_calibrating_z
	set_nozzle_leds_on

[gcode_macro status_printing]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_printing
	set_nozzle_leds_on

[printer]
kinematics = corexy
max_velocity = 300
max_accel = 5700
max_z_velocity = 5
max_z_accel = 100
square_corner_velocity = 5.0

[mcu]
serial = /dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00

[mcu rpi]
serial = /tmp/klipper_host_mcu

[adxl345]
cs_pin = rpi:None

[resonance_tester]
accel_chip = adxl345
probe_points = 
	189,185,20

[input_shaper]
shaper_freq_x = 61.8
shaper_type_x = mzv
shaper_freq_y = 38.4
shaper_type_y = zv

[stepper_x]
step_pin = P1.4
dir_pin = !P1.8
enable_pin = !P1.0
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 40
endstop_pin = ^P1.29
position_endstop = 383
position_min = -5
position_max = 383
homing_speed = 25
homing_retract_dist = 5.0

[tmc2209 stepper_x]
uart_pin = P1.1
interpolate = False
run_current = 1.00
stealthchop_threshold = 0

[stepper_y]
step_pin = P1.14
dir_pin = !P1.15
enable_pin = !P1.9
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 40
endstop_pin = ^P1.28
position_endstop = 392
position_min = -8
position_max = 392
homing_speed = 25
homing_retract_dist = 5.0

[tmc2209 stepper_y]
uart_pin = P1.10
interpolate = False
run_current = 1.00
stealthchop_threshold = 0

[stepper_z]
step_pin = P4.29
dir_pin = !P4.28
enable_pin = !P1.16
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 4
endstop_pin = probe:z_virtual_endstop
position_min = -5
position_max = 395

[tmc2209 stepper_z]
uart_pin = P1.17
interpolate = False
run_current = 0.580
stealthchop_threshold = 0

[stepper_z1]
step_pin = P2.11
dir_pin = !P2.12
enable_pin = !P0.21
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 4

[tmc2209 stepper_z1]
uart_pin = P0.22
interpolate = False
run_current = 0.580
stealthchop_threshold = 0

[extruder]
step_pin = P2.6
dir_pin = !P2.7
enable_pin = !P0.4
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 35.291
gear_ratio = 7.5:1
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = P2.3
sensor_type = PT1000
sensor_pin = P0.24
control = pid
pid_kp = 14.430
pid_ki = 1.023
pid_kd = 50.866
min_temp = 10
max_temp = 350
max_extrude_only_distance = 500
max_extrude_only_velocity = 120
min_extrude_temp = 180
max_extrude_cross_section = 50.
pressure_advance = 0.000
pressure_advance_smooth_time = 0.03

[tmc2209 extruder]
uart_pin = P0.5
interpolate = false
run_current = 0.79
stealthchop_threshold = 0
driver_tbl = 0
driver_hend = 6
driver_hstrt = 7
driver_toff = 4

[static_digital_output tmc_standby_pins]
pins = !P3.26, !P3.25, !P1.18, !P1.19, !P2.13

[heater_bed]
heater_pin = P2.5
sensor_type = EPCOS 100K B57560G104F
sensor_pin = P0.25
control = pid
pid_kp = 68.561
pid_ki = 0.619
pid_kd = 1897.417
min_temp = 0
max_temp = 130

[idle_timeout]
timeout = 3600

[bltouch]
sensor_pin = ^P1.27
control_pin = P1.23
x_offset = -33
y_offset = -5
z_offset = 2.500
samples = 1
samples_result = average
sample_retract_dist = 2.0
samples_tolerance = 0.05
samples_tolerance_retries = 3
stow_on_each_sample = False

[safe_z_home]
home_xy_position = 221,190
speed = 60
z_hop = 12
z_hop_speed = 5

[screws_tilt_adjust]
screw1 = 69, 319
screw1_name = rear left screw
screw2 = 368, 60
screw2_name = front right screw
screw3 = 368, 319
screw3_name = rear right screw
screw4 = 69, 60
screw4_name = front left screw
horizontal_move_z = 10.
speed = 50.
screw_thread = CW-M4

[z_tilt]
z_positions = -20, 183
	402, 183
points = 56, 183
	383, 183
speed = 50
horizontal_move_z = 10
retries = 20
retry_tolerance = 0.01

[bed_mesh]
speed = 120
horizontal_move_z = 5
mesh_min = 50, 80
mesh_max = 323, 314
probe_count = 7, 7
algorithm = bicubic
bicubic_tension = 0.5
fade_start = 0.6
fade_end = 10
fade_target = 0

[fan]
pin = P2.1

[heater_fan heatbreak_cooling_fan]
pin = P2.2

[display]
lcd_type = st7920
menu_timeout = 600
cs_pin = EXP1_7
sclk_pin = EXP1_6
sid_pin = EXP1_8
encoder_pins = ^EXP1_5, ^EXP1_3
click_pin = ^!EXP1_2

[output_pin beeper]
pin = EXP1_1

[board_pins]
aliases = 
	
	EXP1_1=P2.8,  EXP1_3=P0.19, EXP1_5=P0.20, EXP1_7=P0.17, EXP1_9=<GND>,
	EXP1_2=P0.16, EXP1_4=<RST>, EXP1_6=P0.15, EXP1_8=P0.18, EXP1_10=<5V>

[filament_motion_sensor SmartFilamentSensor_T0]
detection_length = 7.00
extruder = extruder
switch_pin = ^P1.26
pause_on_runout = True
event_delay = 3.0
pause_delay = 0.5
runout_gcode = 
	M117 Runout Detected!

[temperature_sensor raspberry_pi]
sensor_type = temperature_host
min_temp = 10
max_temp = 100

[temperature_sensor Mainboard]
sensor_type = NTC 100K MGB18-104F39050L32
sensor_pin = P1.30
min_temp = 10
max_temp = 100

[neopixel chamber_leds]
pin = P1.22
chain_count = 85
color_order = GRB
initial_red = 0.0
initial_green = 0.0
initial_blue = 0.0
initial_white = 0.0

[neopixel sb_leds]
pin = P1.24
chain_count = 10
color_order = GRB,GRB,GRB,GRB,GRB,GRB,GRB,GRB,GRBW,GRBW
initial_red = 0.0
initial_green = 0.0
initial_blue = 0.0
initial_white = 0.0

[exclude_object]

[gcode_arcs]
resolution = 0.1
=======================
Loaded MCU 'mcu' 105 commands (v0.11.0-205-g5f0d252b / gcc: (15:8-2019-q3-1+b1) 8.3.1 20190703 (release) [gcc-8-branch revision 273027] binutils: (2.34-4+rpi1+14) 2.34)
MCU 'mcu' config: ADC_MAX=4095 BUS_PINS_i2c0=P0.28,P0.27 BUS_PINS_i2c1=P0.1,P0.0 BUS_PINS_i2c1a=P0.20,P0.19 BUS_PINS_i2c2=P0.11,P0.10 BUS_PINS_ssp0=P0.17,P0.18,P0.15 BUS_PINS_ssp1=P0.8,P0.9,P0.7 CLOCK_FREQ=120000000 MCU=lpc1769 PWM_MAX=255 RESERVE_PINS_USB=P0.30,P0.29,P2.9 STATS_SUMSQ_BASE=256 STEPPER_BOTH_EDGE=1
Configured MCU 'mcu' (1024 moves)
Loaded MCU 'rpi' 113 commands (v0.11.0-240-g6d48adf9 / gcc: (Raspbian 10.2.1-6+rpi1) 10.2.1 20210110 binutils: (GNU Binutils for Raspbian) 2.35.2)
MCU 'rpi' config: ADC_MAX=4095 CLOCK_FREQ=50000000 MCU=linux PCA9685_MAX=4096 PWM_MAX=32768 STATS_SUMSQ_BASE=256
Configured MCU 'rpi' (1024 moves)
Args: ['/home/pi/klipper/klippy/klippy.py', '/home/pi/printer_data/config/printer.cfg', '-l', '/home/pi/printer_data/logs/klippy.log', '-I', '/home/pi/printer_data/comms/klippy.serial', '-a', '/home/pi/printer_data/comms/klippy.sock']
Git version: 'v0.12.0-60-g0665dc89-dirty'
Untracked files: klippy/extras/led_effect.py
Branch: master
Remote: origin
Tracked URL: https://github.com/Klipper3d/klipper.git
CPU: 4 core ?
Python: '3.9.2 (default, Mar 12 2021, 04:06:34) \n[GCC 10.2.1 20210110]'
webhooks client 4128197672: {'program': 'Moonraker', 'version': 'v0.8.0-243-g84a8538'}
=============== Log rollover at Fri Jan 12 18:47:55 2024 ===============
Stats 38.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000008 mcu_task_stddev=0.000010 bytes_write=6394 bytes_read=8530 bytes_retransmit=9 bytes_invalid=0 send_seq=340 receive_seq=340 retransmit_seq=2 srtt=0.001 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119992369 rpi: mcu_awake=0.001 mcu_task_avg=0.000010 mcu_task_stddev=0.000010 bytes_write=913 bytes_read=4761 bytes_retransmit=0 bytes_invalid=0 send_seq=126 receive_seq=126 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=50000088 adj=50001300  heater_bed: target=0 temp=17.5 pwm=0.000 raspberry_pi: temp=26.3 Mainboard: temp=17.6 sysload=0.63 cputime=3.065 memavail=3481276 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.2 pwm=0.000
Stats 39.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000008 mcu_task_stddev=0.000010 bytes_write=6400 bytes_read=8678 bytes_retransmit=9 bytes_invalid=0 send_seq=341 receive_seq=341 retransmit_seq=2 srtt=0.001 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119992528 rpi: mcu_awake=0.001 mcu_task_avg=0.000017 mcu_task_stddev=0.000019 bytes_write=919 bytes_read=4790 bytes_retransmit=0 bytes_invalid=0 send_seq=127 receive_seq=127 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=50000040 adj=50001647  heater_bed: target=0 temp=17.6 pwm=0.000 raspberry_pi: temp=26.3 Mainboard: temp=17.7 sysload=0.63 cputime=3.086 memavail=3478288 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.2 pwm=0.000
Stats 40.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000008 mcu_task_stddev=0.000010 bytes_write=6406 bytes_read=8841 bytes_retransmit=9 bytes_invalid=0 send_seq=342 receive_seq=342 retransmit_seq=2 srtt=0.001 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119992650 rpi: mcu_awake=0.001 mcu_task_avg=0.000017 mcu_task_stddev=0.000019 bytes_write=925 bytes_read=4806 bytes_retransmit=0 bytes_invalid=0 send_seq=128 receive_seq=128 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999986 adj=50001542  heater_bed: target=0 temp=17.7 pwm=0.000 raspberry_pi: temp=26.8 Mainboard: temp=17.8 sysload=0.58 cputime=3.106 memavail=3477840 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.1 pwm=0.000
Stats 41.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000008 mcu_task_stddev=0.000010 bytes_write=6412 bytes_read=9018 bytes_retransmit=9 bytes_invalid=0 send_seq=343 receive_seq=343 retransmit_seq=2 srtt=0.001 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119992776 rpi: mcu_awake=0.001 mcu_task_avg=0.000017 mcu_task_stddev=0.000019 bytes_write=931 bytes_read=4822 bytes_retransmit=0 bytes_invalid=0 send_seq=129 receive_seq=129 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999952 adj=50001454  heater_bed: target=0 temp=17.5 pwm=0.000 raspberry_pi: temp=26.3 Mainboard: temp=17.7 sysload=0.58 cputime=3.124 memavail=3481948 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.1 pwm=0.000
Stats 42.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6418 bytes_read=9180 bytes_retransmit=9 bytes_invalid=0 send_seq=344 receive_seq=344 retransmit_seq=2 srtt=0.000 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119992882 rpi: mcu_awake=0.001 mcu_task_avg=0.000017 mcu_task_stddev=0.000019 bytes_write=937 bytes_read=4838 bytes_retransmit=0 bytes_invalid=0 send_seq=130 receive_seq=130 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999926 adj=50001429  heater_bed: target=0 temp=17.6 pwm=0.000 raspberry_pi: temp=26.3 Mainboard: temp=17.8 sysload=0.58 cputime=3.143 memavail=3481692 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.0 pwm=0.000
Stats 43.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6424 bytes_read=9358 bytes_retransmit=9 bytes_invalid=0 send_seq=345 receive_seq=345 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119993013 rpi: mcu_awake=0.001 mcu_task_avg=0.000017 mcu_task_stddev=0.000019 bytes_write=943 bytes_read=4854 bytes_retransmit=0 bytes_invalid=0 send_seq=131 receive_seq=131 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999918 adj=50001451  heater_bed: target=0 temp=17.5 pwm=0.000 raspberry_pi: temp=25.8 Mainboard: temp=17.8 sysload=0.58 cputime=3.165 memavail=3481020 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.2 pwm=0.000
Stats 44.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6430 bytes_read=9520 bytes_retransmit=9 bytes_invalid=0 send_seq=346 receive_seq=346 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119993125 rpi: mcu_awake=0.001 mcu_task_avg=0.000011 mcu_task_stddev=0.000013 bytes_write=949 bytes_read=4883 bytes_retransmit=0 bytes_invalid=0 send_seq=132 receive_seq=132 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999950 adj=50001480  heater_bed: target=0 temp=17.5 pwm=0.000 raspberry_pi: temp=25.8 Mainboard: temp=17.8 sysload=0.58 cputime=3.199 memavail=3480324 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=18.8 pwm=0.000
Stats 45.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6436 bytes_read=9668 bytes_retransmit=9 bytes_invalid=0 send_seq=347 receive_seq=347 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119993223 rpi: mcu_awake=0.001 mcu_task_avg=0.000011 mcu_task_stddev=0.000013 bytes_write=955 bytes_read=4899 bytes_retransmit=0 bytes_invalid=0 send_seq=133 receive_seq=133 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999965 adj=50001733  heater_bed: target=0 temp=17.7 pwm=0.000 raspberry_pi: temp=26.3 Mainboard: temp=17.7 sysload=0.53 cputime=3.231 memavail=3479400 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.0 pwm=0.000
Stats 46.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6442 bytes_read=9846 bytes_retransmit=9 bytes_invalid=0 send_seq=348 receive_seq=348 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119993310 rpi: mcu_awake=0.001 mcu_task_avg=0.000011 mcu_task_stddev=0.000013 bytes_write=961 bytes_read=4915 bytes_retransmit=0 bytes_invalid=0 send_seq=134 receive_seq=134 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999993 adj=50001854  heater_bed: target=0 temp=17.6 pwm=0.000 raspberry_pi: temp=26.3 Mainboard: temp=17.8 sysload=0.53 cputime=3.265 memavail=3478728 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=18.8 pwm=0.000
Stats 47.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6448 bytes_read=10022 bytes_retransmit=9 bytes_invalid=0 send_seq=349 receive_seq=349 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119993397 rpi: mcu_awake=0.001 mcu_task_avg=0.000011 mcu_task_stddev=0.000013 bytes_write=967 bytes_read=4931 bytes_retransmit=0 bytes_invalid=0 send_seq=135 receive_seq=135 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999998 adj=50002040  heater_bed: target=0 temp=17.6 pwm=0.000 raspberry_pi: temp=26.3 Mainboard: temp=17.9 sysload=0.53 cputime=3.298 memavail=3478056 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.0 pwm=0.000
Stats 48.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6454 bytes_read=10170 bytes_retransmit=9 bytes_invalid=0 send_seq=350 receive_seq=350 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119993483 rpi: mcu_awake=0.001 mcu_task_avg=0.000011 mcu_task_stddev=0.000013 bytes_write=973 bytes_read=4947 bytes_retransmit=0 bytes_invalid=0 send_seq=136 receive_seq=136 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=50000190 adj=50002035  heater_bed: target=0 temp=17.6 pwm=0.000 raspberry_pi: temp=25.8 Mainboard: temp=17.9 sysload=0.53 cputime=3.330 memavail=3477864 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.0 pwm=0.000
Stats 49.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6460 bytes_read=10348 bytes_retransmit=9 bytes_invalid=0 send_seq=351 receive_seq=351 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119993548 rpi: mcu_awake=0.001 mcu_task_avg=0.000019 mcu_task_stddev=0.000019 bytes_write=979 bytes_read=4976 bytes_retransmit=0 bytes_invalid=0 send_seq=137 receive_seq=137 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=50000197 adj=50003179  heater_bed: target=0 temp=17.4 pwm=0.000 raspberry_pi: temp=26.3 Mainboard: temp=17.9 sysload=0.53 cputime=3.363 memavail=3481896 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.1 pwm=0.000
Stats 50.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6466 bytes_read=10510 bytes_retransmit=9 bytes_invalid=0 send_seq=352 receive_seq=352 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119993611 rpi: mcu_awake=0.001 mcu_task_avg=0.000019 mcu_task_stddev=0.000019 bytes_write=985 bytes_read=4992 bytes_retransmit=0 bytes_invalid=0 send_seq=138 receive_seq=138 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=50000173 adj=50002980  heater_bed: target=0 temp=17.6 pwm=0.000 raspberry_pi: temp=26.8 Mainboard: temp=17.9 sysload=0.57 cputime=3.396 memavail=3481896 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=18.8 pwm=0.000
Stats 51.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6472 bytes_read=10658 bytes_retransmit=9 bytes_invalid=0 send_seq=353 receive_seq=353 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119993676 rpi: mcu_awake=0.001 mcu_task_avg=0.000019 mcu_task_stddev=0.000019 bytes_write=991 bytes_read=5008 bytes_retransmit=0 bytes_invalid=0 send_seq=139 receive_seq=139 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=50000162 adj=50002623  heater_bed: target=0 temp=17.6 pwm=0.000 raspberry_pi: temp=25.8 Mainboard: temp=17.9 sysload=0.57 cputime=3.428 memavail=3480956 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.3 pwm=0.000
Resetting prediction variance 82.468: freq=50000018 diff=14806007 stddev=19730.438
Resetting prediction variance 83.452: freq=50053944 diff=13073687 stddev=50000.000
Resetting prediction variance 84.436: freq=50097523 diff=11625151 stddev=50000.000
Resetting prediction variance 85.421: freq=50133344 diff=10387113 stddev=50000.000
Resetting prediction variance 86.406: freq=50163178 diff=9302692 stddev=50000.000
Resetting prediction variance 87.390: freq=50188257 diff=8338462 stddev=50000.000
Resetting prediction variance 88.375: freq=50209480 diff=7469920 stddev=50000.000
Resetting prediction variance 89.359: freq=50227523 diff=6679279 stddev=50000.000
Resetting prediction variance 90.344: freq=50242901 diff=5954576 stddev=50000.000
Resetting prediction variance 91.329: freq=50256019 diff=5287299 stddev=50000.000
Resetting prediction variance 92.314: freq=50267203 diff=4669008 stddev=50000.000
Resetting prediction variance 93.298: freq=50276714 diff=4093408 stddev=50000.000
Resetting prediction variance 94.283: freq=50284767 diff=3557701 stddev=50000.000
Resetting prediction variance 95.267: freq=50291542 diff=3057444 stddev=50000.000
Resetting prediction variance 96.252: freq=50297191 diff=2586953 stddev=50000.000
Resetting prediction variance 97.236: freq=50301838 diff=2148257 stddev=50000.000
Resetting prediction variance 98.220: freq=50305597 diff=1738978 stddev=50000.000
Resetting prediction variance 99.205: freq=50308565 diff=1354262 stddev=50000.000
Resetting prediction variance 100.189: freq=50310823 diff=993770 stddev=50000.000
Resetting prediction variance 101.174: freq=50312445 diff=655863 stddev=50000.000
Resetting prediction variance 102.159: freq=50313493 diff=346781 stddev=50000.000
Resetting prediction variance 104.130: freq=50314103 diff=-1959179 stddev=49753.086
Resetting prediction variance 105.115: freq=50311136 diff=-4316187 stddev=50000.000
Resetting prediction variance 106.100: freq=50304705 diff=-6224084 stddev=50000.000
Resetting prediction variance 107.084: freq=50295571 diff=-7749504 stddev=50000.000
Resetting prediction variance 108.071: freq=50284361 diff=-8949678 stddev=50000.000
Resetting prediction variance 109.056: freq=50271588 diff=-9872388 stddev=50000.000
Resetting prediction variance 110.040: freq=50257679 diff=-10556886 stddev=50000.000
Resetting prediction variance 111.025: freq=50242984 diff=-11043160 stddev=50000.000
Resetting prediction variance 112.010: freq=50227789 diff=-11362437 stddev=50000.000
Resetting prediction variance 112.995: freq=50212324 diff=-11539493 stddev=50000.000
Resetting prediction variance 113.980: freq=50196779 diff=-11594655 stddev=50000.000
Resetting prediction variance 114.965: freq=50181312 diff=-11557629 stddev=50000.000
Resetting prediction variance 115.950: freq=50166036 diff=-11435839 stddev=50000.000
Resetting prediction variance 116.934: freq=50151053 diff=-11250088 stddev=50000.000
Resetting prediction variance 117.919: freq=50136437 diff=-11012190 stddev=50000.000
Resetting prediction variance 118.904: freq=50122242 diff=-10728355 stddev=50000.000
Resetting prediction variance 119.889: freq=50108516 diff=-10411934 stddev=50000.000
Resetting prediction variance 120.874: freq=50095289 diff=-10067903 stddev=50000.000
Resetting prediction variance 121.859: freq=50082585 diff=-9705138 stddev=50000.000
Resetting prediction variance 122.844: freq=50070418 diff=-9324302 stddev=50000.000
Resetting prediction variance 123.828: freq=50058798 diff=-8940032 stddev=50000.000
Resetting prediction variance 124.812: freq=50047722 diff=-8550262 stddev=50000.000
Resetting prediction variance 125.797: freq=50037187 diff=-8159577 stddev=50000.000
Resetting prediction variance 126.782: freq=50027186 diff=-7769966 stddev=50000.000
Resetting prediction variance 127.766: freq=50017708 diff=-7384902 stddev=50000.000
Resetting prediction variance 128.750: freq=50008743 diff=-7009624 stddev=50000.000
Resetting prediction variance 129.735: freq=50000272 diff=-6637440 stddev=50000.000
Resetting prediction variance 130.719: freq=49992284 diff=-6273358 stddev=50000.000
Resetting prediction variance 131.704: freq=49984764 diff=-5918732 stddev=50000.000
Resetting prediction variance 132.688: freq=49977697 diff=-5574791 stddev=50000.000
Resetting prediction variance 133.673: freq=49971064 diff=-5236896 stddev=50000.000
Resetting prediction variance 134.658: freq=49964854 diff=-4915048 stddev=50000.000
Resetting prediction variance 135.642: freq=49959045 diff=-4605564 stddev=50000.000
Resetting prediction variance 136.627: freq=49953619 diff=-4219752 stddev=50000.000
Resetting prediction variance 137.612: freq=49948661 diff=-3838699 stddev=50000.000
Resetting prediction variance 138.597: freq=49944164 diff=-3487918 stddev=50000.000
Resetting prediction variance 139.581: freq=49940088 diff=-3155573 stddev=50000.000
Resetting prediction variance 140.566: freq=49936410 diff=-2845151 stddev=50000.000
Starting Klippy...
Args: ['/home/pi/klipper/klippy/klippy.py', '/home/pi/printer_data/config/printer.cfg', '-l', '/home/pi/printer_data/logs/klippy.log', '-I', '/home/pi/printer_data/comms/klippy.serial', '-a', '/home/pi/printer_data/comms/klippy.sock']
Git version: 'v0.12.0-65-g96ab9069-dirty'
Untracked files: klippy/extras/led_effect.py
Branch: master
Remote: origin
Tracked URL: https://github.com/Klipper3d/klipper.git
CPU: 4 core ?
Python: '3.9.2 (default, Mar 12 2021, 04:06:34) \n[GCC 10.2.1 20210110]'
Start printer at Fri Jan 12 18:49:37 2024 (1705085377.7 141.6)
===== Config file =====
[virtual_sdcard]
path = ~/printer_data/gcodes
on_error_gcode = CANCEL_PRINT

[pause_resume]

[display_status]

[respond]

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = CANCEL_PRINT_BASE
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set allow_park = client.park_at_cancel|default(false)|lower == 'true' %}
	{% set retract = client.cancel_retract|default(5.0)|abs %}
	
	{% set park_x = "" if (client.park_at_cancel_x|default(none) is none)
	else "X=" ~ client.park_at_cancel_x %}
	{% set park_y = "" if (client.park_at_cancel_y|default(none) is none)
	else "Y=" ~ client.park_at_cancel_y %}
	{% set custom_park = park_x|length > 0 or park_y|length > 0 %}
	
	
	{% if printer['gcode_macro RESUME'].restore_idle_timeout > 0 %}
	SET_IDLE_TIMEOUT TIMEOUT={printer['gcode_macro RESUME'].restore_idle_timeout}
	{% endif %}
	{% if (custom_park or not printer.pause_resume.is_paused) and allow_park %} _TOOLHEAD_PARK_PAUSE_CANCEL {park_x} {park_y} {% endif %}
	_CLIENT_RETRACT LENGTH={retract}
	TURN_OFF_HEATERS
	M106 S0
	{client.user_cancel_macro|default("")}
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=idle_state VALUE=False
	
	SET_PAUSE_NEXT_LAYER ENABLE=0
	SET_PAUSE_AT_LAYER ENABLE=0 LAYER=0
	CANCEL_PRINT_BASE

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = PAUSE_BASE
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set idle_timeout = client.idle_timeout|default(0) %}
	{% set temp = printer[printer.toolhead.extruder].target if printer.toolhead.extruder != '' else 0 %}
	{% set restore = False if printer.toolhead.extruder == ''
	else True  if params.RESTORE|default(1)|int == 1 else False %}
	
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=last_extruder_temp VALUE="{{'restore': restore, 'temp': temp}}"
	
	{% if idle_timeout > 0 %}
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=restore_idle_timeout VALUE={printer.configfile.settings.idle_timeout.timeout}
	SET_IDLE_TIMEOUT TIMEOUT={idle_timeout}
	{% endif %}
	PAUSE_BASE
	{client.user_pause_macro|default("")}
	_TOOLHEAD_PARK_PAUSE_CANCEL {rawparams}

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = RESUME_BASE
variable_last_extruder_temp = {'restore': False, 'temp': 0}
variable_restore_idle_timeout = 0
variable_idle_state = False
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set sp_move = client.speed_move|default(velocity) %}
	{% set runout_resume = True if client.runout_sensor|default("") == ""
	else True if not printer[client.runout_sensor].enabled
	else printer[client.runout_sensor].filament_detected %}
	{% set can_extrude = True if printer.toolhead.extruder == ''
	else printer[printer.toolhead.extruder].can_extrude %}
	{% set do_resume = False %}
	{% set prompt_txt = [] %}
	
	
	{% if printer.idle_timeout.state|upper == "IDLE" or idle_state %}
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=idle_state VALUE=False
	{% if last_extruder_temp.restore %}
	
	RESPOND TYPE=echo MSG='{"Restoring \"%s\" temperature to %3.1f\u00B0C, this may take some time" % (printer.toolhead.extruder, last_extruder_temp.temp) }'
	M109 S{last_extruder_temp.temp}
	{% set do_resume = True %}
	{% elif can_extrude %}
	{% set do_resume = True %}
	{% else %}
	RESPOND TYPE=error MSG='{"Resume aborted !!! \"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder}'
	{% set _d = prompt_txt.append("\"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder) %}
	{% endif %}
	
	{% elif can_extrude %}
	{% set do_resume = True %}
	{% else %}
	RESPOND TYPE=error MSG='{"Resume aborted !!! \"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder}'
	{% set _d = prompt_txt.append("\"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder) %}
	{% endif %}
	{% if runout_resume %}
	{% if do_resume %}
	{% if restore_idle_timeout > 0 %} SET_IDLE_TIMEOUT TIMEOUT={restore_idle_timeout} {% endif %}
	{client.user_resume_macro|default("")}
	_CLIENT_EXTRUDE
	RESUME_BASE VELOCITY={params.VELOCITY|default(sp_move)}
	{% endif %}
	{% else %}
	RESPOND TYPE=error MSG='{"Resume aborted !!! \"%s\" detects no filament, please load filament and press RESUME" % (client.runout_sensor.split(" "))[1]}'
	{% set _d = prompt_txt.append("\"%s\" detects no filament, please load filament and press RESUME" % (client.runout_sensor.split(" "))[1]) %}
	{% endif %}
	
	{% if not (runout_resume and do_resume) %}
	RESPOND TYPE=command MSG="action:prompt_begin RESUME aborted !!!"
	{% for element in prompt_txt %}
	RESPOND TYPE=command MSG='{"action:prompt_text %s" % element}'
	{% endfor %}
	RESPOND TYPE=command MSG="action:prompt_footer_button Ok|RESPOND TYPE=command MSG=action:prompt_end|info"
	RESPOND TYPE=command MSG="action:prompt_show"
	{% endif %}

[gcode_macro SET_PAUSE_NEXT_LAYER]
description = Enable a pause if the next layer is reached
gcode = 
	{% set pause_next_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_next_layer %}
	{% set ENABLE = params.ENABLE|default(1)|int != 0 %}
	{% set MACRO = params.MACRO|default(pause_next_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_next_layer VALUE="{{ 'enable': ENABLE, 'call': MACRO }}"

[gcode_macro SET_PAUSE_AT_LAYER]
description = Enable/disable a pause if a given layer number is reached
gcode = 
	{% set pause_at_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_at_layer %}
	{% set ENABLE = params.ENABLE|int != 0 if params.ENABLE is defined
	else params.LAYER is defined %}
	{% set LAYER = params.LAYER|default(pause_at_layer.layer)|int %}
	{% set MACRO = params.MACRO|default(pause_at_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_at_layer VALUE="{{ 'enable': ENABLE, 'layer': LAYER, 'call': MACRO }}"

[gcode_macro SET_PRINT_STATS_INFO]
rename_existing = SET_PRINT_STATS_INFO_BASE
description = Overwrite, to get pause_next_layer and pause_at_layer feature
variable_pause_next_layer = { 'enable': False, 'call': "PAUSE" }
variable_pause_at_layer = { 'enable': False, 'layer': 0, 'call': "PAUSE" }
gcode = 
	{% if pause_next_layer.enable %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_next_layer" % pause_next_layer.call}'
	{pause_next_layer.call}
	SET_PAUSE_NEXT_LAYER ENABLE=0
	{% elif pause_at_layer.enable and params.CURRENT_LAYER is defined and params.CURRENT_LAYER|int == pause_at_layer.layer %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_at_layer [%d]" % (pause_at_layer.call, pause_at_layer.layer)}'
	{pause_at_layer.call}
	SET_PAUSE_AT_LAYER ENABLE=0
	{% endif %}
	SET_PRINT_STATS_INFO_BASE {rawparams}

[gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL]
description = Helper: park toolhead used in PAUSE and CANCEL_PRINT
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set use_custom     = client.use_custom_pos|default(false)|lower == 'true' %}
	{% set custom_park_x  = client.custom_park_x|default(0.0) %}
	{% set custom_park_y  = client.custom_park_y|default(0.0) %}
	{% set park_dz        = client.custom_park_dz|default(2.0)|abs %}
	{% set sp_hop         = client.speed_hop|default(15) * 60 %}
	{% set sp_move        = client.speed_move|default(velocity) * 60 %}
	
	{% set origin    = printer.gcode_move.homing_origin %}
	{% set act       = printer.gcode_move.gcode_position %}
	{% set max       = printer.toolhead.axis_maximum %}
	{% set cone      = printer.toolhead.cone_start_z|default(max.z) %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	
	{% set z_min = params.Z_MIN|default(0)|float %}
	{% set z_park = [[(act.z + park_dz), z_min]|max, (max.z - origin.z)]|min %}
	{% set x_park = params.X       if params.X is defined
	else custom_park_x  if use_custom
	else 0.0            if round_bed
	else (max.x - 5.0) %}
	{% set y_park = params.Y       if params.Y is defined
	else custom_park_y  if use_custom
	else (max.y - 5.0)  if round_bed and z_park < cone
	else 0.0            if round_bed
	else (max.y - 5.0) %}
	
	_CLIENT_RETRACT
	{% if "xyz" in printer.toolhead.homed_axes %}
	G90
	G1 Z{z_park} F{sp_hop}
	G1 X{x_park} Y{y_park} F{sp_move}
	{% if not printer.gcode_move.absolute_coordinates %} G91 {% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='Printer not homed'
	{% endif %}

[gcode_macro _CLIENT_EXTRUDE]
description = Extrudes, if the extruder is hot enough
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set use_fw_retract = (client.use_fw_retract|default(false)|lower == 'true') and (printer.firmware_retraction is defined) %}
	{% set length = params.LENGTH|default(client.unretract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_unretract)|default(35) %}
	{% set absolute_extrude = printer.gcode_move.absolute_extrude %}
	
	{% if printer.toolhead.extruder != '' %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if use_fw_retract %}
	{% if length < 0 %}
	G10
	{% else %}
	G11
	{% endif %}
	{% else %}
	M83
	G1 E{length} F{(speed|float|abs) * 60}
	{% if absolute_extrude %}
	M82
	{% endif %}
	{% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='{"\"%s\" not hot enough" % printer.toolhead.extruder}'
	{% endif %}
	{% endif %}

[gcode_macro _CLIENT_RETRACT]
description = Retracts, if the extruder is hot enough
gcode = 
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set length = params.LENGTH|default(client.retract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_retract)|default(35) %}
	
	_CLIENT_EXTRUDE LENGTH=-{length|float|abs} SPEED={speed|float|abs}

[gcode_macro START_PRINT]
gcode = 
	{% set BED_TEMP = params.BED_TEMP|default(55)|float %}
	{% set EXTRUDER_TEMP = params.EXTRUDER_TEMP|default(200)|float %}
	M117 Print Starting...
	G28 X Y
	G90
	M220 S100
	M221 S100
	G92 E0
	
	
	
	
	
	
	M140 S{BED_TEMP}
	
	M190 S{BED_TEMP}
	
	M117 Waiting for temperature
	
	
	M117 Homing All...
	
	G90
	
	G28
	
	M117 Z-Tilt Adjust
	Z_TILT_ADJUST
	
	M117 Generating mesh
	
	BED_MESH_CLEAR
	
	BED_MESH_CALIBRATE
	
	BED_MESH_PROFILE LOAD=default
	
	G1 X100 Y392 F10000
	
	M117 Heaters Recovering...
	
	
	M109 S{EXTRUDER_TEMP} T0; start warming extruder to preheat temp
	
	
	M117 Purging extruder...
	
	
	CLEAN_AND_PURGE_NOZZLE
	
	M117 Printing.....
	UPDATE_DELAYED_GCODE ID=clear_display DURATION=10

[gcode_macro END_PRINT]
gcode = 
	
	{% set th = printer.toolhead %}
	{% set x_safe = th.position.x + 20 * (1 if th.axis_maximum.x - th.position.x > 20 else -1) %}
	{% set y_safe = th.position.y + 20 * (1 if th.axis_maximum.y - th.position.y > 20 else -1) %}
	{% set z_safe = [th.position.z + 2, th.axis_maximum.z]|min %}
	
	SAVE_GCODE_STATE NAME=STATE_PRINT_END
	
	
	
	M400
	G92 E0
	
	G91
	G1 E-0.7 Z+5 F3000
	G90
	
	TURN_OFF_HEATERS
	
	G0 X{x_safe} Y{y_safe} Z{z_safe} F20000
	G0 X{th.axis_maximum.x//2} Y{th.axis_maximum.y - 2} F3600
	
	AFTER_PRINT_CLEAN_NOZZLE
	
	G0 X{th.axis_maximum.x/2} Y{th.axis_maximum.y - 2} F3600
	
	TURN_OFF_HEATERS
	
	M84 X Y E
	
	
	SET_PRESSURE_ADVANCE ADVANCE=0.0
	M117 Pressure Advance Set 0.0
	
	
	
	
	BED_MESH_CLEAR
	
	
	
	
	
	M117 Print Finished
	UPDATE_DELAYED_GCODE ID=clear_display DURATION=10
	
	RESTORE_GCODE_STATE NAME=STATE_PRINT_END

[gcode_macro PRIME_LINE]
gcode = 
	M117 Prime Line
	G92 E0
	
	G1 Z2.0 F3000
	
	G1 X40 Y2 Z0.3 F5000.0
	G1 X120 Y2 Z0.3 F500.0 E15
	G1 X120 Y2.3 Z0.3 F5000.0
	G1 X40 Y2.3 Z0.3 F500.0 E30
	G92 E0
	G1 Z2.0 F3000

[gcode_macro CLEAN_NOZZLE]
variable_start_x = 63
variable_start_y = 387
variable_wipe_dist_y = -3
variable_wipe_qty = 5
variable_wipe_spd = 50
variable_end_loc_x = 189
variable_end_loc_y = 185
gcode = 
	SAVE_GCODE_STATE NAME=STATE_PRINT_CURRENT
	
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	G90
	M220 S100
	M204 S100
	M221 S100
	
	
	G1 X{start_x} Y{start_y} F6000
	
	
	{% for wipes in range(1, (wipe_qty + 1)) %}
	
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	
	{% endfor %}
	
	G1 X{end_loc_x} F10000
	
	RESTORE_GCODE_STATE NAME=STATE_PRINT_CURRENT

[gcode_macro CLEAN_AND_PURGE_NOZZLE]
variable_start_x = 63
variable_start_y = 387
variable_start_z = 10
variable_wipe_dist_y = -3
variable_wipe_qty = 5
variable_wipe_spd = 50
variable_purge_loc_x = 100
variable_purge_loc_y = 392
variable_post_purge_y = 386
variable_end_loc_x = 189
variable_end_loc_y = 185
gcode = 
	SAVE_GCODE_STATE NAME=STATE_PRINT_CURRENT
	
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	G90
	
	
	
	
	
	G1 X{start_x} Y{start_y} F6000
	
	
	{% for wipes in range(1, (wipe_qty + 1)) %}
	
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	
	{% endfor %}
	
	G1 X{purge_loc_x}
	G1 Y{purge_loc_y}
	G92 E0
	G1 E30.0 F100
	G92 E0
	G1 E-0.5 F300
	
	G1 Y{post_purge_y} F10000
	G1 X{start_x}
	G1 X{end_loc_x} F10000
	
	RESTORE_GCODE_STATE NAME=STATE_PRINT_CURRENT

[gcode_macro AFTER_PRINT_CLEAN_NOZZLE]
variable_start_x = 63
variable_start_y = 387
variable_wipe_dist_y = -3
variable_wipe_qty = 5
variable_wipe_spd = 50
gcode = 
	SAVE_GCODE_STATE NAME=STATE_PRINT_CURRENT
	
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	G90
	
	
	
	
	G1 X{start_x} Y{start_y} F6000
	
	
	{% for wipes in range(1, (wipe_qty + 1)) %}
	
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	
	{% endfor %}
	
	RESTORE_GCODE_STATE NAME=STATE_PRINT_CURRENT

[delayed_gcode clear_display]
gcode = 
	M117

[gcode_macro Probe_Z_Height]
gcode = 
	G28
	
	PROBE_CALIBRATE

[gcode_macro automatic_bed_screw_adjust]
gcode = 
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	SCREWS_TILT_CALCULATE

[gcode_macro z_motor_alignment]
gcode = 
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	Z_TILT_ADJUST

[gcode_macro Accelerometer_Connection_Test]
gcode = 
	ACCELEROMETER_QUERY

[gcode_macro X_Axis_Resonance_Test]
gcode = 
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	TEST_RESONANCES AXIS=X

[gcode_macro Y_Axis_Resonance_Test]
gcode = 
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	TEST_RESONANCES AXIS=Y

[gcode_macro BED_MESH_CALIBRATE]
rename_existing = _BED_MESH_CALIBRATE
gcode = 
	
	{% set all_points = printer.exclude_object.objects | map(attribute='polygon') | sum(start=[]) %}
	{% set bed_mesh_min = printer.configfile.settings.bed_mesh.mesh_min %}
	{% set bed_mesh_max = printer.configfile.settings.bed_mesh.mesh_max %}
	{% set probe_count = printer.configfile.settings.bed_mesh.probe_count %}
	{% set kamp_settings = printer["gcode_macro _KAMP_Settings"] %}
	{% set verbose_enable = kamp_settings.verbose_enable | abs %}
	{% set probe_dock_enable = kamp_settings.probe_dock_enable | abs %}
	{% set attach_macro = kamp_settings.attach_macro | string %}
	{% set detach_macro = kamp_settings.detach_macro | string %}
	{% set mesh_margin = kamp_settings.mesh_margin | float %}
	{% set fuzz_amount = kamp_settings.fuzz_amount | float %}
	{% set probe_count = probe_count if probe_count|length > 1 else probe_count * 2  %}
	{% set max_probe_point_distance_x = ( bed_mesh_max[0] - bed_mesh_min[0] ) / (probe_count[0] - 1)  %}
	{% set max_probe_point_distance_y = ( bed_mesh_max[1] - bed_mesh_min[1] ) / (probe_count[1] - 1)  %}
	{% set x_min = all_points | map(attribute=0) | min | default(bed_mesh_min[0]) %}
	{% set y_min = all_points | map(attribute=1) | min | default(bed_mesh_min[1]) %}
	{% set x_max = all_points | map(attribute=0) | max | default(bed_mesh_max[0]) %}
	{% set y_max = all_points | map(attribute=1) | max | default(bed_mesh_max[1]) %}
	
	{% set fuzz_range = range((0) | int, (fuzz_amount * 100) | int + 1) %}
	{% set adapted_x_min = x_min - mesh_margin - (fuzz_range | random / 100.0) %}
	{% set adapted_y_min = y_min - mesh_margin - (fuzz_range | random / 100.0) %}
	{% set adapted_x_max = x_max + mesh_margin + (fuzz_range | random / 100.0) %}
	{% set adapted_y_max = y_max + mesh_margin + (fuzz_range | random / 100.0) %}
	
	{% set adapted_x_min = [adapted_x_min , bed_mesh_min[0]] | max %}
	{% set adapted_y_min = [adapted_y_min , bed_mesh_min[1]] | max %}
	{% set adapted_x_max = [adapted_x_max , bed_mesh_max[0]] | min %}
	{% set adapted_y_max = [adapted_y_max , bed_mesh_max[1]] | min %}
	
	{% set points_x = (((adapted_x_max - adapted_x_min) / max_probe_point_distance_x) | round(method='ceil') | int) + 1 %}
	{% set points_y = (((adapted_y_max - adapted_y_min) / max_probe_point_distance_y) | round(method='ceil') | int) + 1 %}
	
	{% if (([points_x, points_y]|max) > 6) %}
	{% set algorithm = "bicubic" %}
	{% set min_points = 4 %}
	{% else %}
	{% set algorithm = "lagrange" %}
	{% set min_points = 3 %}
	{% endif %}
	
	{% set points_x = [points_x , min_points]|max %}
	{% set points_y = [points_y , min_points]|max %}
	{% set points_x = [points_x , probe_count[0]]|min %}
	{% set points_y = [points_y , probe_count[1]]|min %}
	
	{% if verbose_enable == True %}
	{% if printer.exclude_object.objects != [] %}
	
	{ action_respond_info( "Algorithm: {}.".format(
	(algorithm),
	)) }
	
	{ action_respond_info("Default probe count: {},{}.".format(
	(probe_count[0]),
	(probe_count[1]),
	)) }
	
	{ action_respond_info("Adapted probe count: {},{}.".format(
	(points_x),
	(points_y),
	)) }
	
	{action_respond_info("Default mesh bounds: {}, {}.".format(
	(bed_mesh_min[0],bed_mesh_min[1]),
	(bed_mesh_max[0],bed_mesh_max[1]),
	)) }
	
	{% if mesh_margin > 0 %}
	{action_respond_info("Mesh margin is {}, mesh bounds extended by {}mm.".format(
	(mesh_margin),
	(mesh_margin),
	)) }
	{% else %}
	{action_respond_info("Mesh margin is 0, margin not increased.")}
	{% endif %}
	
	{% if fuzz_amount > 0 %}
	{action_respond_info("Mesh point fuzzing enabled, points fuzzed up to {}mm.".format(
	(fuzz_amount),
	)) }
	{% else %}
	{action_respond_info("Fuzz amount is 0, mesh points not fuzzed.")}
	{% endif %}
	
	{ action_respond_info("Adapted mesh bounds: {}, {}.".format(
	(adapted_x_min, adapted_y_min),
	(adapted_x_max, adapted_y_max),
	)) }
	
	{action_respond_info("KAMP adjustments successful. Happy KAMPing!")}
	
	{% else %}
	
	{action_respond_info("No objects detected! Check your gcode and make sure that EXCLUDE_OBJECT_DEFINE is happening before BED_MESH_CALIBRATE is called. Defaulting to regular meshing.")}
	G4 P5000
	{% endif %}
	
	{% endif %}
	
	{% if probe_dock_enable == True %}
	{attach_macro}
	{% endif %}
	
	_BED_MESH_CALIBRATE mesh_min={adapted_x_min},{adapted_y_min} mesh_max={adapted_x_max},{adapted_y_max} ALGORITHM={algorithm} PROBE_COUNT={points_x},{points_y}
	
	{% if probe_dock_enable == True %}
	{detach_macro}
	{% endif %}

[gcode_macro _KAMP_Settings]
description = This macro contains all adjustable settings for KAMP
variable_verbose_enable = True
variable_mesh_margin = 0
variable_fuzz_amount = 0
variable_probe_dock_enable = False
variable_attach_macro = 'Attach_Probe'
variable_detach_macro = 'Dock_Probe'
variable_purge_height = 0.8
variable_tip_distance = 0
variable_purge_margin = 10
variable_purge_amount = 30
variable_flow_rate = 12
variable_smart_park_height = 10
gcode = 
	
	{action_respond_info(" Running the KAMP_Settings macro does nothing, it is only used for storing KAMP settings. ")}

[led_effect sb_logo_busy]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (1,0,0)

[led_effect sb_logo_cleaning]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 0.02, 0.5)

[led_effect sb_logo_calibrating_z]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 0.0, 0.35)

[led_effect sb_logo_heating]
leds = 
	neopixel:sb_leds (1,3,7,8,6,2)
autostart = false
frame_rate = 24
layers = 
	comet  0.3  0 add (1, 0.18, 0)

[led_effect sb_logo_cooling]
leds = 
	neopixel:sb_leds (1,3,7,8,6,2)
autostart = false
frame_rate = 24
layers = 
	comet  0.3  0 add (0, 0, 1)

[led_effect sb_logo_homing]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 0.6, 0.2)

[led_effect sb_logo_leveling]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.5, 0.1, 0.4)

[led_effect sb_logo_meshing]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.2, 1.0, 0.0)

[led_effect sb_logo_printing]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	gradient  0.3  1 add (0.3, 0.0, 0.0),(0.3, 0.3, 0.0),(0.3, 0.1, 0.0)

[led_effect sb_logo_standby]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.01, 0.01, 0.01)

[led_effect sb_logo_part_ready]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 1.0, 0.0)

[led_effect sb_nozzle_heating]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (1.0, 0.18, 0.0, 0.0)

[led_effect sb_nozzle_cooling]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (0.0, 0.0, 1.0, 0.1)

[led_effect sb_nozzle_standby]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (0.6, 0.0, 0.0, 0.0)

[led_effect sb_nozzle_part_ready]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (0.6, 1.0, 0.0, 0.1)

[led_effect sb_critical_error]
leds = 
	neopixel:sb_leds
layers = 
	strobe         1  1.5   add        (1.0,  1.0, 1.0)
	breathing      2  0     difference (0.95, 0.0, 0.0)
	static         1  0     top        (1.0,  0.0, 0.0)
autostart = false
frame_rate = 24
run_on_error = true

[led_effect rainbow]
leds = 
	neopixel:chamber_leds
autostart = false
frame_rate = 24
layers = 
	gradient  0.3  1 add (0.3, 0.0, 0.0),(0.0, 0.3, 0.0),(0.0, 0.0, 0.3)

[led_effect set_nozzle_leds]
leds = 
	neopixel:sb_leds (9,10)
autostart = false
frame_rate = 24
layers = 
	static         0  0     top        (0.0,  0.0, 0.0, 1.0)

[led_effect set_logo_leds]
leds = 
	neopixel:sb_leds (1,2,3,4,5,6,7,8)
autostart = false
frame_rate = 24
layers = 
	static         0  0     top        (1.0,  1.0, 1.0)

[led_effect set_chamber_leds]
leds = 
	neopixel:chamber_leds
autostart = false
frame_rate = 24
layers = 
	static         0  0     top        (1.0,  1.0, 1.0)

[gcode_macro set_logo_leds_off]
gcode = 
	SET_LED_EFFECT EFFECT=set_logo_leds STOP=1

[gcode_macro set_logo_leds_on]
gcode = 
	SET_LED_EFFECT EFFECT=set_logo_leds

[gcode_macro set_nozzle_leds_on]
gcode = 
	SET_LED_EFFECT EFFECT=set_nozzle_leds

[gcode_macro set_nozzle_leds_off]
gcode = 
	SET_LED_EFFECT EFFECT=set_nozzle_leds STOP=1

[gcode_macro set_chamber_leds_off]
gcode = 
	SET_LED_EFFECT EFFECT=set_chamber_leds STOP=1

[gcode_macro set_chamber_leds_on]
gcode = 
	SET_LED_EFFECT EFFECT=set_chamber_leds

[gcode_macro status_off]
gcode = 
	STOP_LED_EFFECTS

[gcode_macro status_ready]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=rainbow

[gcode_macro status_part_ready]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_nozzle_part_ready
	SET_LED_EFFECT EFFECT=sb_logo_part_ready

[gcode_macro status_busy]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_busy
	set_nozzle_leds_on

[gcode_macro status_heating]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_heating
	SET_LED_EFFECT EFFECT=sb_nozzle_heating

[gcode_macro status_cooling]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_cooling
	SET_LED_EFFECT EFFECT=sb_nozzle_cooling

[gcode_macro status_leveling]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_leveling
	set_nozzle_leds_on

[gcode_macro status_homing]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_homing
	set_nozzle_leds_on

[gcode_macro status_cleaning]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_cleaning
	set_nozzle_leds_on

[gcode_macro status_meshing]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_meshing
	set_nozzle_leds_on

[gcode_macro status_calibrating_z]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_calibrating_z
	set_nozzle_leds_on

[gcode_macro status_printing]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_printing
	set_nozzle_leds_on

[printer]
kinematics = corexy
max_velocity = 300
max_accel = 5700
max_z_velocity = 5
max_z_accel = 100
square_corner_velocity = 5.0

[mcu]
serial = /dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00

[mcu rpi]
serial = /tmp/klipper_host_mcu

[adxl345]
cs_pin = rpi:None

[resonance_tester]
accel_chip = adxl345
probe_points = 
	189,185,20

[input_shaper]
shaper_freq_x = 61.8
shaper_type_x = mzv
shaper_freq_y = 38.4
shaper_type_y = zv

[stepper_x]
step_pin = P1.4
dir_pin = !P1.8
enable_pin = !P1.0
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 40
endstop_pin = ^P1.29
position_endstop = 383
position_min = -5
position_max = 383
homing_speed = 25
homing_retract_dist = 5.0

[tmc2209 stepper_x]
uart_pin = P1.1
interpolate = False
run_current = 1.00
stealthchop_threshold = 0

[stepper_y]
step_pin = P1.14
dir_pin = !P1.15
enable_pin = !P1.9
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 40
endstop_pin = ^P1.28
position_endstop = 392
position_min = -8
position_max = 392
homing_speed = 25
homing_retract_dist = 5.0

[tmc2209 stepper_y]
uart_pin = P1.10
interpolate = False
run_current = 1.00
stealthchop_threshold = 0

[stepper_z]
step_pin = P4.29
dir_pin = !P4.28
enable_pin = !P1.16
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 4
endstop_pin = probe:z_virtual_endstop
position_min = -5
position_max = 395

[tmc2209 stepper_z]
uart_pin = P1.17
interpolate = False
run_current = 0.580
stealthchop_threshold = 0

[stepper_z1]
step_pin = P2.11
dir_pin = !P2.12
enable_pin = !P0.21
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 4

[tmc2209 stepper_z1]
uart_pin = P0.22
interpolate = False
run_current = 0.580
stealthchop_threshold = 0

[extruder]
step_pin = P2.6
dir_pin = !P2.7
enable_pin = !P0.4
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 35.291
gear_ratio = 7.5:1
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = P2.3
sensor_type = PT1000
sensor_pin = P0.24
control = pid
pid_kp = 14.430
pid_ki = 1.023
pid_kd = 50.866
min_temp = 10
max_temp = 350
max_extrude_only_distance = 500
max_extrude_only_velocity = 120
min_extrude_temp = 180
max_extrude_cross_section = 50.
pressure_advance = 0.000
pressure_advance_smooth_time = 0.03

[tmc2209 extruder]
uart_pin = P0.5
interpolate = false
run_current = 0.79
stealthchop_threshold = 0
driver_tbl = 0
driver_hend = 6
driver_hstrt = 7
driver_toff = 4

[static_digital_output tmc_standby_pins]
pins = !P3.26, !P3.25, !P1.18, !P1.19, !P2.13

[heater_bed]
heater_pin = P2.5
sensor_type = EPCOS 100K B57560G104F
sensor_pin = P0.25
control = pid
pid_kp = 68.561
pid_ki = 0.619
pid_kd = 1897.417
min_temp = 0
max_temp = 130

[idle_timeout]
timeout = 3600

[bltouch]
sensor_pin = ^P1.27
control_pin = P1.23
x_offset = -33
y_offset = -5
z_offset = 2.500
samples = 1
samples_result = average
sample_retract_dist = 2.0
samples_tolerance = 0.05
samples_tolerance_retries = 3
stow_on_each_sample = False

[safe_z_home]
home_xy_position = 221,190
speed = 60
z_hop = 12
z_hop_speed = 5

[screws_tilt_adjust]
screw1 = 69, 319
screw1_name = rear left screw
screw2 = 368, 60
screw2_name = front right screw
screw3 = 368, 319
screw3_name = rear right screw
screw4 = 69, 60
screw4_name = front left screw
horizontal_move_z = 10.
speed = 50.
screw_thread = CW-M4

[z_tilt]
z_positions = -20, 183
	402, 183
points = 56, 183
	383, 183
speed = 50
horizontal_move_z = 10
retries = 20
retry_tolerance = 0.01

[bed_mesh]
speed = 120
horizontal_move_z = 5
mesh_min = 50, 80
mesh_max = 323, 314
probe_count = 7, 7
algorithm = bicubic
bicubic_tension = 0.5
fade_start = 0.6
fade_end = 10
fade_target = 0

[fan]
pin = P2.1

[heater_fan heatbreak_cooling_fan]
pin = P2.2

[display]
lcd_type = st7920
menu_timeout = 600
cs_pin = EXP1_7
sclk_pin = EXP1_6
sid_pin = EXP1_8
encoder_pins = ^EXP1_5, ^EXP1_3
click_pin = ^!EXP1_2

[output_pin beeper]
pin = EXP1_1

[board_pins]
aliases = 
	
	EXP1_1=P2.8,  EXP1_3=P0.19, EXP1_5=P0.20, EXP1_7=P0.17, EXP1_9=<GND>,
	EXP1_2=P0.16, EXP1_4=<RST>, EXP1_6=P0.15, EXP1_8=P0.18, EXP1_10=<5V>

[filament_motion_sensor SmartFilamentSensor_T0]
detection_length = 7.00
extruder = extruder
switch_pin = ^P1.26
pause_on_runout = True
event_delay = 3.0
pause_delay = 0.5
runout_gcode = 
	M117 Runout Detected!

[temperature_sensor raspberry_pi]
sensor_type = temperature_host
min_temp = 10
max_temp = 100

[temperature_sensor Mainboard]
sensor_type = NTC 100K MGB18-104F39050L32
sensor_pin = P1.30
min_temp = 10
max_temp = 100

[neopixel chamber_leds]
pin = P1.22
chain_count = 85
color_order = GRB
initial_red = 0.0
initial_green = 0.0
initial_blue = 0.0
initial_white = 0.0

[neopixel sb_leds]
pin = P1.24
chain_count = 10
color_order = GRB,GRB,GRB,GRB,GRB,GRB,GRB,GRB,GRBW,GRBW
initial_red = 0.0
initial_green = 0.0
initial_blue = 0.0
initial_white = 0.0

[exclude_object]

[gcode_arcs]
resolution = 0.1
=======================
Extruder max_extrude_ratio=20.787584
mcu 'mcu': Starting serial connect
webhooks client 4121379024: New connection
webhooks client 4121379024: Client info {'program': 'Moonraker', 'version': 'v0.8.0-243-g84a8538'}
mcu 'mcu': got {'oid': 26, 'next_clock': 1043330816, 'value': 31637, '#name': 'analog_in_state', '#sent_time': 143.47722584, '#receive_time': 143.481044933}
mcu 'mcu': got {'oid': 31, 'next_clock': 1049330816, 'value': 6098, '#name': 'analog_in_state', '#sent_time': 143.528947044, '#receive_time': 143.531059821}
mcu 'mcu': got {'oid': 19, 'next_clock': 1070930816, 'value': 31698, '#name': 'analog_in_state', '#sent_time': 143.681973118, '#receive_time': 143.711059618}
mcu 'mcu': got {'oid': 26, 'next_clock': 1079330816, 'value': 31642, '#name': 'analog_in_state', '#sent_time': 143.732914673, '#receive_time': 143.781110562}
mcu 'mcu': got {'oid': 31, 'next_clock': 1085330816, 'value': 6101, '#name': 'analog_in_state', '#sent_time': 143.784511118, '#receive_time': 143.831088543}
Loaded MCU 'mcu' 105 commands (v0.11.0-205-g5f0d252b / gcc: (15:8-2019-q3-1+b1) 8.3.1 20190703 (release) [gcc-8-branch revision 273027] binutils: (2.34-4+rpi1+14) 2.34)
MCU 'mcu' config: ADC_MAX=4095 BUS_PINS_i2c0=P0.28,P0.27 BUS_PINS_i2c1=P0.1,P0.0 BUS_PINS_i2c1a=P0.20,P0.19 BUS_PINS_i2c2=P0.11,P0.10 BUS_PINS_ssp0=P0.17,P0.18,P0.15 BUS_PINS_ssp1=P0.8,P0.9,P0.7 CLOCK_FREQ=120000000 MCU=lpc1769 PWM_MAX=255 RESERVE_PINS_USB=P0.30,P0.29,P2.9 STATS_SUMSQ_BASE=256 STEPPER_BOTH_EDGE=1
mcu 'rpi': Starting connect
mcu 'mcu': got {'oid': 19, 'next_clock': 1106930816, 'value': 31698, '#name': 'analog_in_state', '#sent_time': 143.894530247, '#receive_time': 144.011078803}
mcu 'mcu': got {'oid': 26, 'next_clock': 1115330816, 'value': 31637, '#name': 'analog_in_state', '#sent_time': 143.894530247, '#receive_time': 144.081101284}
mcu 'mcu': got {'oid': 31, 'next_clock': 1121330816, 'value': 6101, '#name': 'analog_in_state', '#sent_time': 143.894530247, '#receive_time': 144.131117803}
mcu 'mcu': got {'oid': 19, 'next_clock': 1142930816, 'value': 31703, '#name': 'analog_in_state', '#sent_time': 143.894530247, '#receive_time': 144.311074377}
mcu 'mcu': got {'oid': 26, 'next_clock': 1151330816, 'value': 31639, '#name': 'analog_in_state', '#sent_time': 143.894530247, '#receive_time': 144.381037654}
Loaded MCU 'rpi' 113 commands (v0.11.0-240-g6d48adf9 / gcc: (Raspbian 10.2.1-6+rpi1) 10.2.1 20210110 binutils: (GNU Binutils for Raspbian) 2.35.2)
MCU 'rpi' config: ADC_MAX=4095 CLOCK_FREQ=50000000 MCU=linux PCA9685_MAX=4096 PWM_MAX=32768 STATS_SUMSQ_BASE=256
Configured MCU 'mcu' (1024 moves)
Configured MCU 'rpi' (1024 moves)
mcu 'rpi': got {'oid': 1, 'clock': 2475413581, 'query_ticks': 1454, 'next_sequence': 0, 'buffered': 0, 'fifo': 0, 'limit_count': 0, '#name': 'adxl345_status', '#sent_time': 144.425501228, '#receive_time': 144.425674802}
Starting heater checks for heater_bed
webhooks client 4121379024: Disconnected
bed_mesh: generated points
Index |  Tool Adjusted  |   Probe
  0   | (83.0, 85.0)    | (50.0, 80.0)
  1   | (128.5, 85.0)   | (95.5, 80.0)
  2   | (174.0, 85.0)   | (141.0, 80.0)
  3   | (219.5, 85.0)   | (186.5, 80.0)
  4   | (265.0, 85.0)   | (232.0, 80.0)
  5   | (310.5, 85.0)   | (277.5, 80.0)
  6   | (356.0, 85.0)   | (323.0, 80.0)
  7   | (356.0, 124.0)  | (323.0, 119.0)
  8   | (310.5, 124.0)  | (277.5, 119.0)
  9   | (265.0, 124.0)  | (232.0, 119.0)
  10  | (219.5, 124.0)  | (186.5, 119.0)
  11  | (174.0, 124.0)  | (141.0, 119.0)
  12  | (128.5, 124.0)  | (95.5, 119.0)
  13  | (83.0, 124.0)   | (50.0, 119.0)
  14  | (83.0, 163.0)   | (50.0, 158.0)
  15  | (128.5, 163.0)  | (95.5, 158.0)
  16  | (174.0, 163.0)  | (141.0, 158.0)
  17  | (219.5, 163.0)  | (186.5, 158.0)
  18  | (265.0, 163.0)  | (232.0, 158.0)
  19  | (310.5, 163.0)  | (277.5, 158.0)
  20  | (356.0, 163.0)  | (323.0, 158.0)
  21  | (356.0, 202.0)  | (323.0, 197.0)
  22  | (310.5, 202.0)  | (277.5, 197.0)
  23  | (265.0, 202.0)  | (232.0, 197.0)
  24  | (219.5, 202.0)  | (186.5, 197.0)
  25  | (174.0, 202.0)  | (141.0, 197.0)
  26  | (128.5, 202.0)  | (95.5, 197.0)
  27  | (83.0, 202.0)   | (50.0, 197.0)
  28  | (83.0, 241.0)   | (50.0, 236.0)
  29  | (128.5, 241.0)  | (95.5, 236.0)
  30  | (174.0, 241.0)  | (141.0, 236.0)
  31  | (219.5, 241.0)  | (186.5, 236.0)
  32  | (265.0, 241.0)  | (232.0, 236.0)
  33  | (310.5, 241.0)  | (277.5, 236.0)
  34  | (356.0, 241.0)  | (323.0, 236.0)
  35  | (356.0, 280.0)  | (323.0, 275.0)
  36  | (310.5, 280.0)  | (277.5, 275.0)
  37  | (265.0, 280.0)  | (232.0, 275.0)
  38  | (219.5, 280.0)  | (186.5, 275.0)
  39  | (174.0, 280.0)  | (141.0, 275.0)
  40  | (128.5, 280.0)  | (95.5, 275.0)
  41  | (83.0, 280.0)   | (50.0, 275.0)
  42  | (83.0, 319.0)   | (50.0, 314.0)
  43  | (128.5, 319.0)  | (95.5, 314.0)
  44  | (174.0, 319.0)  | (141.0, 314.0)
  45  | (219.5, 319.0)  | (186.5, 314.0)
  46  | (265.0, 319.0)  | (232.0, 314.0)
  47  | (310.5, 319.0)  | (277.5, 314.0)
  48  | (356.0, 319.0)  | (323.0, 314.0)
Starting heater checks for extruder
webhooks client 4123725584: New connection
webhooks client 4123725584: Client info {'program': 'Moonraker', 'version': 'v0.8.0-247-g3008a13'}
webhooks: registering remote method 'shutdown_machine' for connection id: 4123725584
webhooks: registering remote method 'reboot_machine' for connection id: 4123725584
webhooks: registering remote method 'pause_job_queue' for connection id: 4123725584
webhooks: registering remote method 'start_job_queue' for connection id: 4123725584
Resetting prediction variance 1108.338: freq=49992916 diff=315545 stddev=5713.009
Resetting prediction variance 1109.323: freq=49993379 diff=311595 stddev=50000.000
Resetting prediction variance 1110.307: freq=49993822 diff=310119 stddev=50000.000
Resetting prediction variance 1111.292: freq=49994250 diff=308742 stddev=50000.000
Resetting prediction variance 1112.277: freq=49994665 diff=311992 stddev=50000.000
Resetting prediction variance 1113.262: freq=49995073 diff=312056 stddev=50000.000
Resetting prediction variance 1114.246: freq=49995473 diff=308925 stddev=50000.000
Resetting prediction variance 1115.230: freq=49995860 diff=307586 stddev=50000.000
Resetting prediction variance 1116.215: freq=49996237 diff=304448 stddev=50000.000
Resetting prediction variance 1117.199: freq=49996604 diff=303105 stddev=50000.000
Resetting prediction variance 1118.183: freq=49996963 diff=302482 stddev=50000.000
Resetting prediction variance 1119.168: freq=49997315 diff=301503 stddev=50000.000
Resetting prediction variance 1120.152: freq=49997661 diff=297388 stddev=50000.000
Resetting prediction variance 1121.137: freq=49997998 diff=295959 stddev=50000.000
Resetting prediction variance 1122.121: freq=49998328 diff=293537 stddev=50000.000
Resetting prediction variance 1123.106: freq=49998652 diff=291195 stddev=50000.000
Resetting prediction variance 1124.090: freq=49998970 diff=288769 stddev=50000.000
Resetting prediction variance 1125.075: freq=49999281 diff=285224 stddev=50000.000
Resetting prediction variance 1126.060: freq=49999586 diff=282347 stddev=50000.000
Resetting prediction variance 1127.044: freq=49999885 diff=279712 stddev=50000.000
Resetting prediction variance 1128.029: freq=50000179 diff=276729 stddev=50000.000
Resetting prediction variance 1129.014: freq=50000468 diff=272867 stddev=50000.000
Resetting prediction variance 1129.999: freq=50000750 diff=270713 stddev=50000.000
Resetting prediction variance 1130.984: freq=50001029 diff=267966 stddev=50000.000
Resetting prediction variance 1131.968: freq=50001303 diff=264092 stddev=50000.000
Resetting prediction variance 1132.953: freq=50001571 diff=259835 stddev=50000.000
Resetting prediction variance 1133.938: freq=50001834 diff=257740 stddev=50000.000
Resetting prediction variance 1134.922: freq=50002093 diff=253812 stddev=50000.000
MCU 'rpi' shutdown: Force shutdown command
clocksync state: mcu_freq=50000000 last_clock=74655590931 clock_est=(1473.621 73228048234 49997539.879) min_half_rtt=0.000057 min_rtt_time=180.843 time_avg=1473.621(843.338) clock_avg=73228048234.637(42164832519.642) pred_variance=276262855.600 clock_adj=(17.055 49998775.000)
Dumping serial stats: bytes_write=9074 bytes_read=29953 bytes_retransmit=0 bytes_invalid=0 send_seq=1477 receive_seq=1477 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0
Dumping send queue 100 messages
Sent 0 1404.705218 1404.705218 6: seq: 11, get_clock
Sent 1 1405.689745 1405.689745 6: seq: 12, get_clock
Sent 2 1406.674423 1406.674423 6: seq: 13, get_clock
Sent 3 1407.658691 1407.658691 6: seq: 14, get_clock
Sent 4 1408.642814 1408.642814 6: seq: 15, get_clock
Sent 5 1409.627037 1409.627037 6: seq: 16, get_clock
Sent 6 1410.611687 1410.611687 6: seq: 17, get_clock
Sent 7 1411.596023 1411.596023 6: seq: 18, get_clock
Sent 8 1412.580234 1412.580234 6: seq: 19, get_clock
Sent 9 1413.565123 1413.565123 6: seq: 1a, get_clock
Sent 10 1414.549662 1414.549662 6: seq: 1b, get_clock
Sent 11 1415.534282 1415.534282 6: seq: 1c, get_clock
Sent 12 1416.519065 1416.519065 6: seq: 1d, get_clock
Sent 13 1417.503827 1417.503827 6: seq: 1e, get_clock
Sent 14 1418.488330 1418.488330 6: seq: 1f, get_clock
Sent 15 1419.473182 1419.473182 6: seq: 10, get_clock
Sent 16 1420.457237 1420.457237 6: seq: 11, get_clock
Sent 17 1421.442051 1421.442051 6: seq: 12, get_clock
Sent 18 1422.426211 1422.426211 6: seq: 13, get_clock
Sent 19 1423.410564 1423.410564 6: seq: 14, get_clock
Sent 20 1424.395077 1424.395077 6: seq: 15, get_clock
Sent 21 1425.379453 1425.379453 6: seq: 16, get_clock
Sent 22 1426.363941 1426.363941 6: seq: 17, get_clock
Sent 23 1427.348052 1427.348052 6: seq: 18, get_clock
Sent 24 1428.332148 1428.332148 6: seq: 19, get_clock
Sent 25 1429.316248 1429.316248 6: seq: 1a, get_clock
Sent 26 1430.300701 1430.300701 6: seq: 1b, get_clock
Sent 27 1431.285057 1431.285057 6: seq: 1c, get_clock
Sent 28 1432.269173 1432.269173 6: seq: 1d, get_clock
Sent 29 1433.253551 1433.253551 6: seq: 1e, get_clock
Sent 30 1434.238496 1434.238496 6: seq: 1f, get_clock
Sent 31 1435.223491 1435.223491 6: seq: 10, get_clock
Sent 32 1436.207612 1436.207612 6: seq: 11, get_clock
Sent 33 1437.191923 1437.191923 6: seq: 12, get_clock
Sent 34 1438.176815 1438.176815 6: seq: 13, get_clock
Sent 35 1439.160966 1439.160966 6: seq: 14, get_clock
Sent 36 1440.145655 1440.145655 6: seq: 15, get_clock
Sent 37 1441.130488 1441.130488 6: seq: 16, get_clock
Sent 38 1442.114733 1442.114733 6: seq: 17, get_clock
Sent 39 1443.098991 1443.098991 6: seq: 18, get_clock
Sent 40 1444.083528 1444.083528 6: seq: 19, get_clock
Sent 41 1445.068572 1445.068572 6: seq: 1a, get_clock
Sent 42 1446.053607 1446.053607 6: seq: 1b, get_clock
Sent 43 1447.037773 1447.037773 6: seq: 1c, get_clock
Sent 44 1448.022556 1448.022556 6: seq: 1d, get_clock
Sent 45 1449.007426 1449.007426 6: seq: 1e, get_clock
Sent 46 1449.991610 1449.991610 6: seq: 1f, get_clock
Sent 47 1450.976357 1450.976357 6: seq: 10, get_clock
Sent 48 1451.961297 1451.961297 6: seq: 11, get_clock
Sent 49 1452.945530 1452.945530 6: seq: 12, get_clock
Sent 50 1453.929752 1453.929752 6: seq: 13, get_clock
Sent 51 1454.914757 1454.914757 6: seq: 14, get_clock
Sent 52 1455.899337 1455.899337 6: seq: 15, get_clock
Sent 53 1456.883922 1456.883922 6: seq: 16, get_clock
Sent 54 1457.868545 1457.868545 6: seq: 17, get_clock
Sent 55 1458.853094 1458.853094 6: seq: 18, get_clock
Sent 56 1459.837929 1459.837929 6: seq: 19, get_clock
Sent 57 1460.822289 1460.822289 6: seq: 1a, get_clock
Sent 58 1461.806276 1461.806276 6: seq: 1b, get_clock
Sent 59 1462.791299 1462.791299 6: seq: 1c, get_clock
Sent 60 1463.775677 1463.775677 6: seq: 1d, get_clock
Sent 61 1464.760124 1464.760124 6: seq: 1e, get_clock
Sent 62 1465.744294 1465.744294 6: seq: 1f, get_clock
Sent 63 1466.728350 1466.728350 6: seq: 10, get_clock
Sent 64 1467.712494 1467.712494 6: seq: 11, get_clock
Sent 65 1468.696659 1468.696659 6: seq: 12, get_clock
Sent 66 1469.680654 1469.680654 6: seq: 13, get_clock
Sent 67 1470.665460 1470.665460 6: seq: 14, get_clock
Sent 68 1471.650404 1471.650404 6: seq: 15, get_clock
Sent 69 1472.635336 1472.635336 6: seq: 16, get_clock
Sent 70 1473.620104 1473.620104 6: seq: 17, get_clock
Sent 71 1474.604553 1474.604553 6: seq: 18, get_clock
Sent 72 1475.588839 1475.588839 6: seq: 19, get_clock
Sent 73 1476.573457 1476.573457 6: seq: 1a, get_clock
Sent 74 1477.557451 1477.557451 6: seq: 1b, get_clock
Sent 75 1478.542257 1478.542257 6: seq: 1c, get_clock
Sent 76 1479.527148 1479.527148 6: seq: 1d, get_clock
Sent 77 1480.512015 1480.512015 6: seq: 1e, get_clock
Sent 78 1481.496817 1481.496817 6: seq: 1f, get_clock
Sent 79 1482.481538 1482.481538 6: seq: 10, get_clock
Sent 80 1483.466357 1483.466357 6: seq: 11, get_clock
Sent 81 1484.451013 1484.451013 6: seq: 12, get_clock
Sent 82 1485.435633 1485.435633 6: seq: 13, get_clock
Sent 83 1486.420489 1486.420489 6: seq: 14, get_clock
Sent 84 1487.405162 1487.405162 6: seq: 15, get_clock
Sent 85 1488.389988 1488.389988 6: seq: 16, get_clock
Sent 86 1489.374871 1489.374871 6: seq: 17, get_clock
Sent 87 1490.359672 1490.359672 6: seq: 18, get_clock
Sent 88 1491.344533 1491.344533 6: seq: 19, get_clock
Sent 89 1492.329204 1492.329204 6: seq: 1a, get_clock
Sent 90 1493.313456 1493.313456 6: seq: 1b, get_clock
Sent 91 1494.297883 1494.297883 6: seq: 1c, get_clock
Sent 92 1495.282421 1495.282421 6: seq: 1d, get_clock
Sent 93 1496.266976 1496.266976 6: seq: 1e, get_clock
Sent 94 1497.251322 1497.251322 6: seq: 1f, get_clock
Sent 95 1498.235733 1498.235733 6: seq: 10, get_clock
Sent 96 1499.220143 1499.220143 6: seq: 11, get_clock
Sent 97 1500.204151 1500.204151 6: seq: 12, get_clock
Sent 98 1501.189080 1501.189080 6: seq: 13, get_clock
Sent 99 1502.173785 1502.173785 6: seq: 14, get_clock
Dumping receive queue 100 messages
Receive: 0 1421.442347 1421.442051 11: seq: 13, clock clock=1899749371
Receive: 1 1422.426547 1422.426211 11: seq: 14, clock clock=1948956064
Receive: 2 1423.158024 1422.426211 13: seq: 14, stats count=55 sum=51292 sumsq=394722
Receive: 3 1423.410831 1423.410564 11: seq: 15, clock clock=1998169732
Receive: 4 1424.395355 1424.395077 11: seq: 16, clock clock=2047393569
Receive: 5 1425.379721 1425.379453 11: seq: 17, clock clock=2096611659
Receive: 6 1426.364158 1426.363941 11: seq: 18, clock clock=2145832051
Receive: 7 1427.348320 1427.348052 11: seq: 19, clock clock=2195037696
Receive: 8 1428.158252 1427.348052 13: seq: 19, stats count=55 sum=50416 sumsq=367925
Receive: 9 1428.332439 1428.332148 11: seq: 1a, clock clock=2244240442
Receive: 10 1429.316536 1429.316248 11: seq: 1b, clock clock=2293442785
Receive: 11 1430.300971 1430.300701 11: seq: 1c, clock clock=2342662509
Receive: 12 1431.285384 1431.285057 11: seq: 1d, clock clock=2391877603
Receive: 13 1432.269505 1432.269173 11: seq: 1e, clock clock=2441081331
Receive: 14 1433.253962 1433.253551 11: seq: 1f, clock clock=2490298275
Receive: 15 1433.253985 1433.253551 13: seq: 1f, stats count=56 sum=58014 sumsq=528971
Receive: 16 1434.238926 1434.238496 11: seq: 10, clock clock=2539545367
Receive: 17 1435.223884 1435.223491 11: seq: 11, clock clock=2588791109
Receive: 18 1436.208011 1436.207612 11: seq: 12, clock clock=2637994884
Receive: 19 1437.192229 1437.191923 11: seq: 13, clock clock=2687207277
Receive: 20 1438.177195 1438.176815 11: seq: 14, clock clock=2736449457
Receive: 21 1438.258796 1438.176815 13: seq: 14, stats count=56 sum=54121 sumsq=458044
Receive: 22 1439.161317 1439.160966 11: seq: 15, clock clock=2785653972
Receive: 23 1440.146012 1440.145655 11: seq: 16, clock clock=2834886213
Receive: 24 1441.130893 1441.130488 11: seq: 17, clock clock=2884127740
Receive: 25 1442.115048 1442.114733 11: seq: 18, clock clock=2933335725
Receive: 26 1443.099310 1443.098991 11: seq: 19, clock clock=2982546295
Receive: 27 1443.259061 1443.098991 13: seq: 19, stats count=55 sum=54390 sumsq=450222
Receive: 28 1444.083838 1444.083528 11: seq: 1a, clock clock=3031770107
Receive: 29 1445.068891 1445.068572 11: seq: 1b, clock clock=3081020344
Receive: 30 1446.053946 1446.053607 11: seq: 1c, clock clock=3130270216
Receive: 31 1447.038109 1447.037773 11: seq: 1d, clock clock=3179475581
Receive: 32 1448.022866 1448.022556 11: seq: 1e, clock clock=3228711494
Receive: 33 1448.359219 1448.022556 13: seq: 1e, stats count=56 sum=54678 sumsq=449775
Receive: 34 1449.007766 1449.007426 11: seq: 1f, clock clock=3277953732
Receive: 35 1449.991944 1449.991610 11: seq: 10, clock clock=3327160007
Receive: 36 1450.976624 1450.976357 11: seq: 11, clock clock=3376392367
Receive: 37 1451.961576 1451.961297 11: seq: 12, clock clock=3425637476
Receive: 38 1452.945808 1452.945530 11: seq: 13, clock clock=3474846347
Receive: 39 1453.359531 1452.945530 13: seq: 13, stats count=55 sum=52252 sumsq=395756
Receive: 40 1453.930099 1453.929752 11: seq: 14, clock clock=3524056944
Receive: 41 1454.915086 1454.914757 11: seq: 15, clock clock=3573303597
Receive: 42 1455.899756 1455.899337 11: seq: 16, clock clock=3622534547
Receive: 43 1456.884267 1456.883922 11: seq: 17, clock clock=3671757335
Receive: 44 1457.868862 1457.868545 11: seq: 18, clock clock=3720984657
Receive: 45 1458.359823 1457.868545 13: seq: 18, stats count=55 sum=54704 sumsq=453425
Receive: 46 1458.853350 1458.853094 11: seq: 19, clock clock=3770208125
Receive: 47 1459.838093 1459.837929 11: seq: 1a, clock clock=3819444771
Receive: 48 1460.822448 1460.822289 11: seq: 1b, clock clock=3868659990
Receive: 49 1461.806428 1461.806276 11: seq: 1c, clock clock=3917856115
Receive: 50 1462.791456 1462.791299 11: seq: 1d, clock clock=3967104869
Receive: 51 1463.459929 1462.791299 13: seq: 1d, stats count=56 sum=31054 sumsq=149175
Receive: 52 1463.775836 1463.775677 11: seq: 1e, clock clock=4016320251
Receive: 53 1464.760443 1464.760124 11: seq: 1f, clock clock=4065544312
Receive: 54 1465.744641 1465.744294 11: seq: 10, clock clock=4114751137
Receive: 55 1466.728677 1466.728350 11: seq: 11, clock clock=4163950223
Receive: 56 1467.712771 1467.712494 11: seq: 12, clock clock=4213153203
Receive: 57 1468.460301 1467.712494 13: seq: 12, stats count=55 sum=47885 sumsq=355433
Receive: 58 1468.696838 1468.696659 10: seq: 13, clock clock=4262356033
Receive: 59 1469.680812 1469.680654 10: seq: 14, clock clock=16585701
Receive: 60 1470.665617 1470.665460 10: seq: 15, clock clock=65823026
Receive: 61 1471.650551 1471.650404 10: seq: 16, clock clock=115067014
Receive: 62 1472.635484 1472.635336 10: seq: 17, clock clock=164310846
Receive: 63 1473.460665 1472.635336 13: seq: 17, stats count=55 sum=27202 sumsq=105837
Receive: 64 1473.620469 1473.620104 11: seq: 18, clock clock=213551157
Receive: 65 1474.604873 1474.604553 11: seq: 19, clock clock=262770321
Receive: 66 1475.589158 1475.588839 11: seq: 1a, clock clock=311981891
Receive: 67 1476.573793 1476.573457 11: seq: 1b, clock clock=361210417
Receive: 68 1477.557787 1477.557451 11: seq: 1c, clock clock=410407009
Receive: 69 1478.542596 1478.542257 11: seq: 1d, clock clock=459643797
Receive: 70 1478.542624 1478.542257 13: seq: 1d, stats count=56 sum=58329 sumsq=518467
Receive: 71 1479.527466 1479.527148 11: seq: 1e, clock clock=508885261
Receive: 72 1480.512331 1480.512015 11: seq: 1f, clock clock=558125812
Receive: 73 1481.497190 1481.496817 11: seq: 10, clock clock=607365476
Receive: 74 1482.481843 1482.481538 11: seq: 11, clock clock=656595532
Receive: 75 1483.466678 1483.466357 11: seq: 12, clock clock=705834376
Receive: 76 1483.561245 1483.466357 13: seq: 12, stats count=56 sum=53594 sumsq=428099
Receive: 77 1484.451342 1484.451013 11: seq: 13, clock clock=755064308
Receive: 78 1485.435995 1485.435633 11: seq: 14, clock clock=804293350
Receive: 79 1486.420669 1486.420489 11: seq: 15, clock clock=853528401
Receive: 80 1487.405326 1487.405162 11: seq: 16, clock clock=902758758
Receive: 81 1488.390130 1488.389988 11: seq: 17, clock clock=951995818
Receive: 82 1488.661443 1488.389988 13: seq: 17, stats count=56 sum=38142 sumsq=259098
Receive: 83 1489.375016 1489.374871 11: seq: 18, clock clock=1001237125
Receive: 84 1490.359840 1490.359672 11: seq: 19, clock clock=1050474951
Receive: 85 1491.344851 1491.344533 11: seq: 1a, clock clock=1099718594
Receive: 86 1492.329649 1492.329204 11: seq: 1b, clock clock=1148950532
Receive: 87 1493.313890 1493.313456 11: seq: 1c, clock clock=1198161482
Receive: 88 1493.661932 1493.313456 13: seq: 1c, stats count=55 sum=43953 sumsq=302920
Receive: 89 1494.298277 1494.297883 11: seq: 1d, clock clock=1247378920
Receive: 90 1495.282734 1495.282421 11: seq: 1e, clock clock=1296600610
Receive: 91 1496.267286 1496.266976 11: seq: 1f, clock clock=1345825229
Receive: 92 1497.251668 1497.251322 11: seq: 10, clock clock=1395041263
Receive: 93 1498.236018 1498.235733 11: seq: 11, clock clock=1444256309
Receive: 94 1498.662216 1498.235733 13: seq: 11, stats count=55 sum=53072 sumsq=432948
Receive: 95 1499.220464 1499.220143 11: seq: 12, clock clock=1493474683
Receive: 96 1500.204476 1500.204151 11: seq: 13, clock clock=1542671864
Receive: 97 1501.189409 1501.189080 11: seq: 14, clock clock=1591915369
Receive: 98 1502.174097 1502.173785 11: seq: 15, clock clock=1641146899
Receive: 99 1503.033929 1502.173785 12: seq: 15, shutdown clock=1684122394 static_string_id=Force shutdown command
Transition to shutdown state: MCU 'rpi' shutdown: Force shutdown command
Dumping gcode input 0 blocks
Dumping 20 requests for client 4123725584
Received 152.342868: b'{"id": 3908717896, "method": "register_remote_method", "params": {"response_template": {"method": "start_job_queue"}, "remote_method": "start_job_queue"}}'
Received 152.345687: b'{"id": 3889718752, "method": "objects/query", "params": {"objects": {"heaters": null}}}'
Received 152.345981: b'{"id": 3889719040, "method": "objects/query", "params": {"objects": {"heaters": null}}}'
Received 152.355684: b'{"id": 3908714992, "method": "info", "params": {}}'
Received 152.356190: b'{"id": 3889719328, "method": "objects/list", "params": {}}'
Received 152.356190: b'{"id": 3889718272, "method": "gcode/help", "params": {}}'
Received 152.384374: b'{"id": 3889718800, "method": "objects/subscribe", "params": {"objects": {"gcode": null, "webhooks": null, "configfile": null, "mcu": null, "mcu rpi": null, "gcode_move": null, "print_stats": null, "virtual_sdcard": null, "pause_resume": null, "display_status": null, "gcode_macro CANCEL_PRINT": null, "gcode_macro PAUSE": null, "gcode_macro RESUME": null, "gcode_macro SET_PAUSE_NEXT_LAYER": null, "gcode_macro SET_PAUSE_AT_LAYER": null, "gcode_macro SET_PRINT_STATS_INFO": null, "gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL": null, "gcode_macro _CLIENT_EXTRUDE": null, "gcode_macro _CLIENT_RETRACT": null, "gcode_macro START_PRINT": null, "gcode_macro END_PRINT": null, "gcode_macro PRIME_LINE": null, "gcode_macro CLEAN_NOZZLE": null, "gcode_macro CLEAN_AND_PURGE_NOZZLE": null, "gcode_macro AFTER_PRINT_CLEAN_NOZZLE": null, "gcode_macro Probe_Z_Height": null, "gcode_macro automatic_bed_screw_adjust": null, "gcode_macro z_motor_alignment": null, "gcode_macro Accelerometer_Connection_Test": null, "gcode_macro X_Axis_Resonance_Test": null, "gcode_macro Y_Axis_Resonance_Test": null, "gcode_macro BED_MESH_CALIBRATE": null, "gcode_macro _KAMP_Settings": null, "gcode_macro set_logo_leds_off": null, "gcode_macro set_logo_leds_on": null, "gcode_macro set_nozzle_leds_on": null, "gcode_macro set_nozzle_leds_off": null, "gcode_macro set_chamber_leds_off": null, "gcode_macro set_chamber_leds_on": null, "gcode_macro status_off": null, "gcode_macro status_ready": null, "gcode_macro status_part_ready": null, "gcode_macro status_busy": null, "gcode_macro status_heating": null, "gcode_macro status_cooling": null, "gcode_macro status_leveling": null, "gcode_macro status_homing": null, "gcode_macro status_cleaning": null, "gcode_macro status_meshing": null, "gcode_macro status_calibrating_z": null, "gcode_macro status_printing": null, "stepper_enable": null, "tmc2209 stepper_x": null, "tmc2209 stepper_y": null, "tmc2209 stepper_z": null, "tmc2209 stepper_z1": null, "tmc2209 extruder": null, "heaters": null, "heater_bed": null, "idle_timeout": null, "probe": null, "screws_tilt_adjust": null, "z_tilt": null, "bed_mesh": null, "fan": null, "heater_fan heatbreak_cooling_fan": null, "output_pin beeper": null, "filament_motion_sensor SmartFilamentSensor_T0": null, "temperature_host raspberry_pi": null, "temperature_sensor raspberry_pi": null, "temperature_sensor Mainboard": null, "neopixel chamber_leds": null, "neopixel sb_leds": null, "exclude_object": null, "motion_report": null, "query_endstops": null, "system_stats": null, "manual_probe": null, "toolhead": null, "extruder": null}, "response_template": {"method": "process_status_update"}}}'
Received 152.599172: b'{"id": 3908715016, "method": "objects/subscribe", "params": {"objects": {"webhooks": null, "print_stats": null, "heater_bed": null, "temperature_sensor raspberry_pi": null, "temperature_sensor Mainboard": null, "extruder": null, "gcode": null, "configfile": null, "mcu": null, "mcu rpi": null, "gcode_move": null, "virtual_sdcard": null, "pause_resume": null, "display_status": null, "gcode_macro CANCEL_PRINT": null, "gcode_macro PAUSE": null, "gcode_macro RESUME": null, "gcode_macro SET_PAUSE_NEXT_LAYER": null, "gcode_macro SET_PAUSE_AT_LAYER": null, "gcode_macro SET_PRINT_STATS_INFO": null, "gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL": null, "gcode_macro _CLIENT_EXTRUDE": null, "gcode_macro _CLIENT_RETRACT": null, "gcode_macro START_PRINT": null, "gcode_macro END_PRINT": null, "gcode_macro PRIME_LINE": null, "gcode_macro CLEAN_NOZZLE": null, "gcode_macro CLEAN_AND_PURGE_NOZZLE": null, "gcode_macro AFTER_PRINT_CLEAN_NOZZLE": null, "gcode_macro Probe_Z_Height": null, "gcode_macro automatic_bed_screw_adjust": null, "gcode_macro z_motor_alignment": null, "gcode_macro Accelerometer_Connection_Test": null, "gcode_macro X_Axis_Resonance_Test": null, "gcode_macro Y_Axis_Resonance_Test": null, "gcode_macro BED_MESH_CALIBRATE": null, "gcode_macro _KAMP_Settings": null, "gcode_macro set_logo_leds_off": null, "gcode_macro set_logo_leds_on": null, "gcode_macro set_nozzle_leds_on": null, "gcode_macro set_nozzle_leds_off": null, "gcode_macro set_chamber_leds_off": null, "gcode_macro set_chamber_leds_on": null, "gcode_macro status_off": null, "gcode_macro status_ready": null, "gcode_macro status_part_ready": null, "gcode_macro status_busy": null, "gcode_macro status_heating": null, "gcode_macro status_cooling": null, "gcode_macro status_leveling": null, "gcode_macro status_homing": null, "gcode_macro status_cleaning": null, "gcode_macro status_meshing": null, "gcode_macro status_calibrating_z": null, "gcode_macro status_printing": null, "stepper_enable": null, "tmc2209 stepper_x": null, "tmc2209 stepper_y": null, "tmc2209 stepper_z": null, "tmc2209 stepper_z1": null, "tmc2209 extruder": null, "heaters": null, "idle_timeout": null, "probe": null, "screws_tilt_adjust": null, "z_tilt": null, "bed_mesh": null, "fan": null, "heater_fan heatbreak_cooling_fan": null, "output_pin beeper": null, "filament_motion_sensor SmartFilamentSensor_T0": null, "temperature_host raspberry_pi": null, "neopixel chamber_leds": null, "neopixel sb_leds": null, "exclude_object": null, "motion_report": null, "query_endstops": null, "system_stats": null, "manual_probe": null, "toolhead": null}, "response_template": {"method": "process_status_update"}}}'
Received 152.844482: b'{"id": 3908716192, "method": "objects/subscribe", "params": {"objects": {"webhooks": null, "print_stats": null, "heater_bed": null, "temperature_sensor raspberry_pi": null, "temperature_sensor Mainboard": null, "extruder": null, "gcode": null, "configfile": null, "mcu": null, "mcu rpi": null, "gcode_move": null, "virtual_sdcard": null, "pause_resume": null, "display_status": null, "gcode_macro CANCEL_PRINT": null, "gcode_macro PAUSE": null, "gcode_macro RESUME": null, "gcode_macro SET_PAUSE_NEXT_LAYER": null, "gcode_macro SET_PAUSE_AT_LAYER": null, "gcode_macro SET_PRINT_STATS_INFO": null, "gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL": null, "gcode_macro _CLIENT_EXTRUDE": null, "gcode_macro _CLIENT_RETRACT": null, "gcode_macro START_PRINT": null, "gcode_macro END_PRINT": null, "gcode_macro PRIME_LINE": null, "gcode_macro CLEAN_NOZZLE": null, "gcode_macro CLEAN_AND_PURGE_NOZZLE": null, "gcode_macro AFTER_PRINT_CLEAN_NOZZLE": null, "gcode_macro Probe_Z_Height": null, "gcode_macro automatic_bed_screw_adjust": null, "gcode_macro z_motor_alignment": null, "gcode_macro Accelerometer_Connection_Test": null, "gcode_macro X_Axis_Resonance_Test": null, "gcode_macro Y_Axis_Resonance_Test": null, "gcode_macro BED_MESH_CALIBRATE": null, "gcode_macro _KAMP_Settings": null, "gcode_macro set_logo_leds_off": null, "gcode_macro set_logo_leds_on": null, "gcode_macro set_nozzle_leds_on": null, "gcode_macro set_nozzle_leds_off": null, "gcode_macro set_chamber_leds_off": null, "gcode_macro set_chamber_leds_on": null, "gcode_macro status_off": null, "gcode_macro status_ready": null, "gcode_macro status_part_ready": null, "gcode_macro status_busy": null, "gcode_macro status_heating": null, "gcode_macro status_cooling": null, "gcode_macro status_leveling": null, "gcode_macro status_homing": null, "gcode_macro status_cleaning": null, "gcode_macro status_meshing": null, "gcode_macro status_calibrating_z": null, "gcode_macro status_printing": null, "stepper_enable": null, "tmc2209 stepper_x": null, "tmc2209 stepper_y": null, "tmc2209 stepper_z": null, "tmc2209 stepper_z1": null, "tmc2209 extruder": null, "heaters": null, "idle_timeout": null, "probe": null, "screws_tilt_adjust": null, "z_tilt": null, "bed_mesh": null, "fan": null, "heater_fan heatbreak_cooling_fan": null, "output_pin beeper": null, "filament_motion_sensor SmartFilamentSensor_T0": null, "temperature_host raspberry_pi": null, "neopixel chamber_leds": null, "neopixel sb_leds": null, "exclude_object": null, "motion_report": null, "query_endstops": null, "system_stats": null, "manual_probe": null, "toolhead": null}, "response_template": {"method": "process_status_update"}}}'
Received 152.868522: b'{"id": 3889718800, "method": "objects/query", "params": {"objects": {"extruder": ["can_extrude"]}}}'
Received 169.304011: b'{"id": 3908804768, "method": "info", "params": {}}'
Received 169.304011: b'{"id": 3890094456, "method": "objects/list", "params": {}}'
Received 169.305020: b'{"id": 3890094720, "method": "gcode/help", "params": {}}'
Received 169.355228: b'{"id": 3889925136, "method": "objects/subscribe", "params": {"objects": {"gcode": null, "webhooks": null, "configfile": null, "mcu": null, "mcu rpi": null, "gcode_move": null, "print_stats": null, "virtual_sdcard": null, "pause_resume": null, "display_status": null, "gcode_macro CANCEL_PRINT": null, "gcode_macro PAUSE": null, "gcode_macro RESUME": null, "gcode_macro SET_PAUSE_NEXT_LAYER": null, "gcode_macro SET_PAUSE_AT_LAYER": null, "gcode_macro SET_PRINT_STATS_INFO": null, "gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL": null, "gcode_macro _CLIENT_EXTRUDE": null, "gcode_macro _CLIENT_RETRACT": null, "gcode_macro START_PRINT": null, "gcode_macro END_PRINT": null, "gcode_macro PRIME_LINE": null, "gcode_macro CLEAN_NOZZLE": null, "gcode_macro CLEAN_AND_PURGE_NOZZLE": null, "gcode_macro AFTER_PRINT_CLEAN_NOZZLE": null, "gcode_macro Probe_Z_Height": null, "gcode_macro automatic_bed_screw_adjust": null, "gcode_macro z_motor_alignment": null, "gcode_macro Accelerometer_Connection_Test": null, "gcode_macro X_Axis_Resonance_Test": null, "gcode_macro Y_Axis_Resonance_Test": null, "gcode_macro BED_MESH_CALIBRATE": null, "gcode_macro _KAMP_Settings": null, "gcode_macro set_logo_leds_off": null, "gcode_macro set_logo_leds_on": null, "gcode_macro set_nozzle_leds_on": null, "gcode_macro set_nozzle_leds_off": null, "gcode_macro set_chamber_leds_off": null, "gcode_macro set_chamber_leds_on": null, "gcode_macro status_off": null, "gcode_macro status_ready": null, "gcode_macro status_part_ready": null, "gcode_macro status_busy": null, "gcode_macro status_heating": null, "gcode_macro status_cooling": null, "gcode_macro status_leveling": null, "gcode_macro status_homing": null, "gcode_macro status_cleaning": null, "gcode_macro status_meshing": null, "gcode_macro status_calibrating_z": null, "gcode_macro status_printing": null, "stepper_enable": null, "tmc2209 stepper_x": null, "tmc2209 stepper_y": null, "tmc2209 stepper_z": null, "tmc2209 stepper_z1": null, "tmc2209 extruder": null, "heaters": null, "heater_bed": null, "idle_timeout": null, "probe": null, "screws_tilt_adjust": null, "z_tilt": null, "bed_mesh": null, "fan": null, "heater_fan heatbreak_cooling_fan": null, "output_pin beeper": null, "filament_motion_sensor SmartFilamentSensor_T0": null, "temperature_host raspberry_pi": null, "temperature_sensor raspberry_pi": null, "temperature_sensor Mainboard": null, "neopixel chamber_leds": null, "neopixel sb_leds": null, "exclude_object": null, "motion_report": null, "query_endstops": null, "system_stats": null, "manual_probe": null, "toolhead": null, "extruder": null}, "response_template": {"method": "process_status_update"}}}'
Received 169.633934: b'{"id": 3889926048, "method": "objects/query", "params": {"objects": {"extruder": ["can_extrude"]}}}'
Received 177.355987: b'{"id": 3890096760, "method": "info", "params": {}}'
Received 177.356462: b'{"id": 3889901944, "method": "objects/list", "params": {}}'
Received 177.356462: b'{"id": 3889902112, "method": "gcode/help", "params": {}}'
Received 177.398983: b'{"id": 3890094840, "method": "objects/subscribe", "params": {"objects": {"gcode": null, "webhooks": null, "configfile": null, "mcu": null, "mcu rpi": null, "gcode_move": null, "print_stats": null, "virtual_sdcard": null, "pause_resume": null, "display_status": null, "gcode_macro CANCEL_PRINT": null, "gcode_macro PAUSE": null, "gcode_macro RESUME": null, "gcode_macro SET_PAUSE_NEXT_LAYER": null, "gcode_macro SET_PAUSE_AT_LAYER": null, "gcode_macro SET_PRINT_STATS_INFO": null, "gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL": null, "gcode_macro _CLIENT_EXTRUDE": null, "gcode_macro _CLIENT_RETRACT": null, "gcode_macro START_PRINT": null, "gcode_macro END_PRINT": null, "gcode_macro PRIME_LINE": null, "gcode_macro CLEAN_NOZZLE": null, "gcode_macro CLEAN_AND_PURGE_NOZZLE": null, "gcode_macro AFTER_PRINT_CLEAN_NOZZLE": null, "gcode_macro Probe_Z_Height": null, "gcode_macro automatic_bed_screw_adjust": null, "gcode_macro z_motor_alignment": null, "gcode_macro Accelerometer_Connection_Test": null, "gcode_macro X_Axis_Resonance_Test": null, "gcode_macro Y_Axis_Resonance_Test": null, "gcode_macro BED_MESH_CALIBRATE": null, "gcode_macro _KAMP_Settings": null, "gcode_macro set_logo_leds_off": null, "gcode_macro set_logo_leds_on": null, "gcode_macro set_nozzle_leds_on": null, "gcode_macro set_nozzle_leds_off": null, "gcode_macro set_chamber_leds_off": null, "gcode_macro set_chamber_leds_on": null, "gcode_macro status_off": null, "gcode_macro status_ready": null, "gcode_macro status_part_ready": null, "gcode_macro status_busy": null, "gcode_macro status_heating": null, "gcode_macro status_cooling": null, "gcode_macro status_leveling": null, "gcode_macro status_homing": null, "gcode_macro status_cleaning": null, "gcode_macro status_meshing": null, "gcode_macro status_calibrating_z": null, "gcode_macro status_printing": null, "stepper_enable": null, "tmc2209 stepper_x": null, "tmc2209 stepper_y": null, "tmc2209 stepper_z": null, "tmc2209 stepper_z1": null, "tmc2209 extruder": null, "heaters": null, "heater_bed": null, "idle_timeout": null, "probe": null, "screws_tilt_adjust": null, "z_tilt": null, "bed_mesh": null, "fan": null, "heater_fan heatbreak_cooling_fan": null, "output_pin beeper": null, "filament_motion_sensor SmartFilamentSensor_T0": null, "temperature_host raspberry_pi": null, "temperature_sensor raspberry_pi": null, "temperature_sensor Mainboard": null, "neopixel chamber_leds": null, "neopixel sb_leds": null, "exclude_object": null, "motion_report": null, "query_endstops": null, "system_stats": null, "manual_probe": null, "toolhead": null, "extruder": null}, "response_template": {"method": "process_status_update"}}}'
Received 177.928834: b'{"id": 3889923096, "method": "objects/query", "params": {"objects": {"extruder": ["can_extrude"]}}}'
gcode state: absolute_coord=True absolute_extrude=True base_position=[0.0, 0.0, 0.0, 0.0] last_position=[0.0, 0.0, 0.0, 0.0] homing_position=[0.0, 0.0, 0.0, 0.0] speed_factor=0.016666666666666666 extrude_factor=1.0 speed=25.0
Reactor garbage collection: (267.082853655, 0.0, 0.0)
MCU 'mcu' shutdown: Command request
clocksync state: mcu_freq=120000000 last_clock=181281267378 clock_est=(1474.092 177854815419 119995071.818) min_half_rtt=0.000079 min_rtt_time=1470.154 time_avg=1474.092(843.526) clock_avg=177854815419.461(101219018695.691) pred_variance=8656001.468
Dumping serial stats: bytes_write=20222 bytes_read=233239 bytes_retransmit=0 bytes_invalid=0 send_seq=2227 receive_seq=2227 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0
Dumping send queue 100 messages
Sent 0 1445.533869 1445.533869 6: seq: 1f, get_clock
Sent 1 1446.366816 1446.366816 9: seq: 10, st7920_send_cmds oid=7 cmds=b'\x81'
Sent 2 1446.372505 1446.372505 12: seq: 11, st7920_send_data oid=7 data=b' 20 '
Sent 3 1446.518849 1446.518849 6: seq: 12, get_clock
Sent 4 1446.867149 1446.867149 9: seq: 13, st7920_send_cmds oid=7 cmds=b'\x81'
Sent 5 1446.872590 1446.872590 12: seq: 14, st7920_send_data oid=7 data=b' 19 '
Sent 6 1447.368744 1447.368744 9: seq: 15, st7920_send_cmds oid=7 cmds=b'\x81'
Sent 7 1447.374196 1447.374196 12: seq: 16, st7920_send_data oid=7 data=b' 20 '
Sent 8 1447.503197 1447.503197 6: seq: 17, get_clock
Sent 9 1447.869138 1447.869138 16: seq: 18, st7920_send_cmds oid=7 cmds=b'\x81', st7920_send_data oid=7 data=b' 19 '
Sent 10 1448.491358 1448.491358 6: seq: 19, get_clock
Sent 11 1449.476155 1449.476155 6: seq: 1a, get_clock
Sent 12 1449.872219 1449.872219 9: seq: 1b, st7920_send_cmds oid=7 cmds=b'\x81'
Sent 13 1449.877666 1449.877666 12: seq: 1c, st7920_send_data oid=7 data=b' 20 '
Sent 14 1450.461117 1450.461117 6: seq: 1d, get_clock
Sent 15 1450.873577 1450.873577 9: seq: 1e, st7920_send_cmds oid=7 cmds=b'\x81'
Sent 16 1450.879186 1450.879186 12: seq: 1f, st7920_send_data oid=7 data=b' 19 '
Sent 17 1451.445857 1451.445857 6: seq: 10, get_clock
Sent 18 1452.430286 1452.430286 6: seq: 11, get_clock
Sent 19 1452.875090 1452.875090 9: seq: 12, st7920_send_cmds oid=7 cmds=b'\x81'
Sent 20 1452.880554 1452.880554 12: seq: 13, st7920_send_data oid=7 data=b' 20 '
Sent 21 1453.414370 1453.414370 6: seq: 14, get_clock
Sent 22 1453.876965 1453.876965 16: seq: 15, st7920_send_cmds oid=7 cmds=b'\x81', st7920_send_data oid=7 data=b' 19 '
Sent 23 1454.399245 1454.399245 6: seq: 16, get_clock
Sent 24 1455.383986 1455.383986 6: seq: 17, get_clock
Sent 25 1456.368670 1456.368670 6: seq: 18, get_clock
Sent 26 1457.352819 1457.352819 6: seq: 19, get_clock
Sent 27 1458.337432 1458.337432 6: seq: 1a, get_clock
Sent 28 1459.321815 1459.321815 6: seq: 1b, get_clock
Sent 29 1459.880081 1459.880081 16: seq: 1c, st7920_send_cmds oid=7 cmds=b'\x81', st7920_send_data oid=7 data=b' 20 '
Sent 30 1460.306407 1460.306407 6: seq: 1d, get_clock
Sent 31 1461.290635 1461.290635 6: seq: 1e, get_clock
Sent 32 1462.275618 1462.275618 6: seq: 1f, get_clock
Sent 33 1463.260141 1463.260141 6: seq: 10, get_clock
Sent 34 1464.244993 1464.244993 6: seq: 11, get_clock
Sent 35 1464.887547 1464.887547 9: seq: 12, st7920_send_cmds oid=7 cmds=b'\x81'
Sent 36 1464.892964 1464.892964 12: seq: 13, st7920_send_data oid=7 data=b' 19 '
Sent 37 1465.229426 1465.229426 6: seq: 14, get_clock
Sent 38 1465.888899 1465.888899 9: seq: 15, st7920_send_cmds oid=7 cmds=b'\x81'
Sent 39 1465.894305 1465.894305 12: seq: 16, st7920_send_data oid=7 data=b' 20 '
Sent 40 1466.214159 1466.214159 6: seq: 17, get_clock
Sent 41 1466.390361 1466.390361 9: seq: 18, st7920_send_cmds oid=7 cmds=b'\x81'
Sent 42 1466.395832 1466.395832 12: seq: 19, st7920_send_data oid=7 data=b' 19 '
Sent 43 1467.199175 1467.199175 6: seq: 1a, get_clock
Sent 44 1468.184061 1468.184061 6: seq: 1b, get_clock
Sent 45 1468.390418 1468.390418 16: seq: 1c, st7920_send_cmds oid=7 cmds=b'\x81', st7920_send_data oid=7 data=b' 20 '
Sent 46 1469.168924 1469.168924 6: seq: 1d, get_clock
Sent 47 1470.153771 1470.153771 6: seq: 1e, get_clock
Sent 48 1471.138412 1471.138412 6: seq: 1f, get_clock
Sent 49 1472.122493 1472.122493 6: seq: 10, get_clock
Sent 50 1473.106592 1473.106592 6: seq: 11, get_clock
Sent 51 1473.897385 1473.897385 9: seq: 12, st7920_send_cmds oid=7 cmds=b'\x81'
Sent 52 1473.902906 1473.902906 12: seq: 13, st7920_send_data oid=7 data=b' 19 '
Sent 53 1474.091491 1474.091491 6: seq: 14, get_clock
Sent 54 1475.076547 1475.076547 6: seq: 15, get_clock
Sent 55 1476.061214 1476.061214 6: seq: 16, get_clock
Sent 56 1477.045934 1477.045934 6: seq: 17, get_clock
Sent 57 1478.030844 1478.030844 6: seq: 18, get_clock
Sent 58 1478.903610 1478.903610 16: seq: 19, st7920_send_cmds oid=7 cmds=b'\x81', st7920_send_data oid=7 data=b' 20 '
Sent 59 1479.015586 1479.015586 6: seq: 1a, get_clock
Sent 60 1479.999723 1479.999723 6: seq: 1b, get_clock
Sent 61 1480.984332 1480.984332 6: seq: 1c, get_clock
Sent 62 1481.969037 1481.969037 6: seq: 1d, get_clock
Sent 63 1482.407718 1482.407718 16: seq: 1e, st7920_send_cmds oid=7 cmds=b'\x81', st7920_send_data oid=7 data=b' 19 '
Sent 64 1482.953519 1482.953519 6: seq: 1f, get_clock
Sent 65 1483.938111 1483.938111 6: seq: 10, get_clock
Sent 66 1484.923100 1484.923100 6: seq: 11, get_clock
Sent 67 1485.907648 1485.907648 6: seq: 12, get_clock
Sent 68 1486.411778 1486.411778 16: seq: 13, st7920_send_cmds oid=7 cmds=b'\x81', st7920_send_data oid=7 data=b' 20 '
Sent 69 1486.892158 1486.892158 6: seq: 14, get_clock
Sent 70 1487.876781 1487.876781 6: seq: 15, get_clock
Sent 71 1488.861707 1488.861707 6: seq: 16, get_clock
Sent 72 1488.914810 1488.914810 16: seq: 17, st7920_send_cmds oid=7 cmds=b'\x81', st7920_send_data oid=7 data=b' 19 '
Sent 73 1489.414939 1489.414939 16: seq: 18, st7920_send_cmds oid=7 cmds=b'\x81', st7920_send_data oid=7 data=b' 20 '
Sent 74 1489.846631 1489.846631 6: seq: 19, get_clock
Sent 75 1490.417032 1490.417032 16: seq: 1a, st7920_send_cmds oid=7 cmds=b'\x81', st7920_send_data oid=7 data=b' 19 '
Sent 76 1490.831468 1490.831468 6: seq: 1b, get_clock
Sent 77 1490.919501 1490.919501 9: seq: 1c, st7920_send_cmds oid=7 cmds=b'\x81'
Sent 78 1490.925010 1490.925010 12: seq: 1d, st7920_send_data oid=7 data=b' 20 '
Sent 79 1491.816003 1491.816003 6: seq: 1e, get_clock
Sent 80 1492.800770 1492.800770 6: seq: 1f, get_clock
Sent 81 1493.422500 1493.422500 9: seq: 10, st7920_send_cmds oid=7 cmds=b'\x81'
Sent 82 1493.428191 1493.428191 12: seq: 11, st7920_send_data oid=7 data=b' 19 '
Sent 83 1493.785777 1493.785777 6: seq: 12, get_clock
Sent 84 1494.770717 1494.770717 6: seq: 13, get_clock
Sent 85 1495.755504 1495.755504 6: seq: 14, get_clock
Sent 86 1496.740430 1496.740430 6: seq: 15, get_clock
Sent 87 1497.725041 1497.725041 6: seq: 16, get_clock
Sent 88 1498.709264 1498.709264 6: seq: 17, get_clock
Sent 89 1499.693535 1499.693535 6: seq: 18, get_clock
Sent 90 1500.678128 1500.678128 6: seq: 19, get_clock
Sent 91 1500.931581 1500.931581 9: seq: 1a, st7920_send_cmds oid=7 cmds=b'\x81'
Sent 92 1500.937260 1500.937260 12: seq: 1b, st7920_send_data oid=7 data=b' 20 '
Sent 93 1501.662496 1501.662496 6: seq: 1c, get_clock
Sent 94 1502.433311 1502.433311 9: seq: 1d, st7920_send_cmds oid=7 cmds=b'\x81'
Sent 95 1502.438997 1502.438997 12: seq: 1e, st7920_send_data oid=7 data=b' 19 '
Sent 96 1502.646815 1502.646815 6: seq: 1f, get_clock
Sent 97 1502.934869 1502.934869 9: seq: 10, st7920_send_cmds oid=7 cmds=b'\x81'
Sent 98 1502.940332 1502.940332 12: seq: 11, st7920_send_data oid=7 data=b' 20 '
Sent 99 1503.045055 1503.045055 6: seq: 12, emergency_stop
Dumping receive queue 100 messages
Receive: 0 1494.186829 1493.785777 14: seq: 13, analog_in_state oid=31 next_clock=4207540864 value=6101
Receive: 1 1494.366977 1493.785777 14: seq: 13, analog_in_state oid=19 next_clock=4229140864 value=31688
Receive: 2 1494.436868 1493.785777 14: seq: 13, analog_in_state oid=26 next_clock=4237540864 value=31534
Receive: 3 1494.486820 1493.785777 13: seq: 13, analog_in_state oid=31 next_clock=4243540864 value=6106
Receive: 4 1494.666872 1493.785777 14: seq: 13, analog_in_state oid=19 next_clock=4265140864 value=31690
Receive: 5 1494.736844 1493.785777 14: seq: 13, analog_in_state oid=26 next_clock=4273540864 value=31535
Receive: 6 1494.771048 1494.770717 10: seq: 14, clock clock=4242515112
Receive: 7 1494.786862 1494.770717 13: seq: 14, analog_in_state oid=31 next_clock=4279540864 value=6101
Receive: 8 1494.966860 1494.770717 14: seq: 14, analog_in_state oid=19 next_clock=6173568 value=31694
Receive: 9 1495.036845 1494.770717 14: seq: 14, analog_in_state oid=26 next_clock=14573568 value=31533
Receive: 10 1495.086861 1494.770717 13: seq: 14, analog_in_state oid=31 next_clock=20573568 value=6104
Receive: 11 1495.266914 1494.770717 14: seq: 14, analog_in_state oid=19 next_clock=42173568 value=31695
Receive: 12 1495.336994 1494.770717 14: seq: 14, analog_in_state oid=26 next_clock=50573568 value=31538
Receive: 13 1495.386902 1494.770717 13: seq: 14, analog_in_state oid=31 next_clock=56573568 value=6100
Receive: 14 1495.566907 1494.770717 14: seq: 14, analog_in_state oid=19 next_clock=78173568 value=31692
Receive: 15 1495.636904 1494.770717 14: seq: 14, analog_in_state oid=26 next_clock=86573568 value=31535
Receive: 16 1495.686869 1494.770717 13: seq: 14, analog_in_state oid=31 next_clock=92573568 value=6102
Receive: 17 1495.755745 1495.755504 10: seq: 15, clock clock=65715076
Receive: 18 1495.866923 1495.755504 14: seq: 15, analog_in_state oid=19 next_clock=114173568 value=31696
Receive: 19 1495.936922 1495.755504 14: seq: 15, analog_in_state oid=26 next_clock=122573568 value=31532
Receive: 20 1495.986902 1495.755504 13: seq: 15, analog_in_state oid=31 next_clock=128573568 value=6102
Receive: 21 1496.166948 1495.755504 14: seq: 15, analog_in_state oid=19 next_clock=150173568 value=31689
Receive: 22 1496.236922 1495.755504 14: seq: 15, analog_in_state oid=26 next_clock=158573568 value=31533
Receive: 23 1496.287035 1495.755504 13: seq: 15, analog_in_state oid=31 next_clock=164573568 value=6099
Receive: 24 1496.466917 1495.755504 14: seq: 15, analog_in_state oid=19 next_clock=186173568 value=31700
Receive: 25 1496.536888 1495.755504 14: seq: 15, analog_in_state oid=26 next_clock=194573568 value=31531
Receive: 26 1496.586910 1495.755504 13: seq: 15, analog_in_state oid=31 next_clock=200573568 value=6101
Receive: 27 1496.740812 1496.740430 10: seq: 16, clock clock=183910086
Receive: 28 1496.766981 1496.740430 15: seq: 16, analog_in_state oid=19 next_clock=222173568 value=31692
Receive: 29 1496.836947 1496.740430 15: seq: 16, analog_in_state oid=26 next_clock=230573568 value=31535
Receive: 30 1496.886930 1496.740430 14: seq: 16, analog_in_state oid=31 next_clock=236573568 value=6105
Receive: 31 1496.969699 1496.740430 15: seq: 16, stats count=223 sum=214623 sumsq=1964678
Receive: 32 1497.066916 1496.740430 15: seq: 16, analog_in_state oid=19 next_clock=258173568 value=31691
Receive: 33 1497.136967 1496.740430 15: seq: 16, analog_in_state oid=26 next_clock=266573568 value=31534
Receive: 34 1497.186922 1496.740430 14: seq: 16, analog_in_state oid=31 next_clock=272573568 value=6097
Receive: 35 1497.367124 1496.740430 15: seq: 16, analog_in_state oid=19 next_clock=294173568 value=31690
Receive: 36 1497.436973 1496.740430 15: seq: 16, analog_in_state oid=26 next_clock=302573568 value=31531
Receive: 37 1497.486939 1496.740430 14: seq: 16, analog_in_state oid=31 next_clock=308573568 value=6102
Receive: 38 1497.667000 1496.740430 15: seq: 16, analog_in_state oid=19 next_clock=330173568 value=31695
Receive: 39 1497.725331 1497.725041 11: seq: 17, clock clock=302050791
Receive: 40 1497.736965 1497.725041 15: seq: 17, analog_in_state oid=26 next_clock=338573568 value=31534
Receive: 41 1497.787183 1497.725041 14: seq: 17, analog_in_state oid=31 next_clock=344573568 value=6101
Receive: 42 1497.966997 1497.725041 15: seq: 17, analog_in_state oid=19 next_clock=366173568 value=31689
Receive: 43 1498.036959 1497.725041 15: seq: 17, analog_in_state oid=26 next_clock=374573568 value=31539
Receive: 44 1498.086979 1497.725041 14: seq: 17, analog_in_state oid=31 next_clock=380573568 value=6102
Receive: 45 1498.267110 1497.725041 15: seq: 17, analog_in_state oid=19 next_clock=402173568 value=31690
Receive: 46 1498.336996 1497.725041 15: seq: 17, analog_in_state oid=26 next_clock=410573568 value=31530
Receive: 47 1498.387026 1497.725041 14: seq: 17, analog_in_state oid=31 next_clock=416573568 value=6097
Receive: 48 1498.567025 1497.725041 15: seq: 17, analog_in_state oid=19 next_clock=438173568 value=31686
Receive: 49 1498.637068 1497.725041 15: seq: 17, analog_in_state oid=26 next_clock=446573568 value=31537
Receive: 50 1498.687037 1497.725041 14: seq: 17, analog_in_state oid=31 next_clock=452573568 value=6102
Receive: 51 1498.709572 1498.709264 11: seq: 18, clock clock=420152076
Receive: 52 1498.867075 1498.709264 15: seq: 18, analog_in_state oid=19 next_clock=474173568 value=31691
Receive: 53 1498.937079 1498.709264 15: seq: 18, analog_in_state oid=26 next_clock=482573568 value=31539
Receive: 54 1498.987051 1498.709264 14: seq: 18, analog_in_state oid=31 next_clock=488573568 value=6108
Receive: 55 1499.167062 1498.709264 15: seq: 18, analog_in_state oid=19 next_clock=510173568 value=31690
Receive: 56 1499.237114 1498.709264 15: seq: 18, analog_in_state oid=26 next_clock=518573568 value=31535
Receive: 57 1499.287025 1498.709264 14: seq: 18, analog_in_state oid=31 next_clock=524573568 value=6102
Receive: 58 1499.467083 1498.709264 15: seq: 18, analog_in_state oid=19 next_clock=546173568 value=31691
Receive: 59 1499.537024 1498.709264 15: seq: 18, analog_in_state oid=26 next_clock=554573568 value=31532
Receive: 60 1499.587022 1498.709264 14: seq: 18, analog_in_state oid=31 next_clock=560573568 value=6104
Receive: 61 1499.693854 1499.693535 11: seq: 19, clock clock=538260811
Receive: 62 1499.767102 1499.693535 15: seq: 19, analog_in_state oid=19 next_clock=582173568 value=31687
Receive: 63 1499.837076 1499.693535 15: seq: 19, analog_in_state oid=26 next_clock=590573568 value=31537
Receive: 64 1499.887119 1499.693535 14: seq: 19, analog_in_state oid=31 next_clock=596573568 value=6101
Receive: 65 1500.067082 1499.693535 15: seq: 19, analog_in_state oid=19 next_clock=618173568 value=31695
Receive: 66 1500.137095 1499.693535 15: seq: 19, analog_in_state oid=26 next_clock=626573568 value=31537
Receive: 67 1500.187053 1499.693535 14: seq: 19, analog_in_state oid=31 next_clock=632573568 value=6100
Receive: 68 1500.367163 1499.693535 15: seq: 19, analog_in_state oid=19 next_clock=654173568 value=31687
Receive: 69 1500.437127 1499.693535 15: seq: 19, analog_in_state oid=26 next_clock=662573568 value=31536
Receive: 70 1500.487096 1499.693535 14: seq: 19, analog_in_state oid=31 next_clock=668573568 value=6100
Receive: 71 1500.667117 1499.693535 15: seq: 19, analog_in_state oid=19 next_clock=690173568 value=31695
Receive: 72 1500.678403 1500.678128 11: seq: 1a, clock clock=656406696
Receive: 73 1500.737097 1500.678128 15: seq: 1a, analog_in_state oid=26 next_clock=698573568 value=31539
Receive: 74 1500.787105 1500.678128 14: seq: 1a, analog_in_state oid=31 next_clock=704573568 value=6108
Receive: 75 1500.967077 1500.937260 15: seq: 1c, analog_in_state oid=19 next_clock=726173568 value=31689
Receive: 76 1501.037091 1500.937260 15: seq: 1c, analog_in_state oid=26 next_clock=734573568 value=31534
Receive: 77 1501.087068 1500.937260 14: seq: 1c, analog_in_state oid=31 next_clock=740573568 value=6106
Receive: 78 1501.267138 1500.937260 15: seq: 1c, analog_in_state oid=19 next_clock=762173568 value=31688
Receive: 79 1501.337108 1500.937260 15: seq: 1c, analog_in_state oid=26 next_clock=770573568 value=31537
Receive: 80 1501.387148 1500.937260 14: seq: 1c, analog_in_state oid=31 next_clock=776573568 value=6103
Receive: 81 1501.567219 1500.937260 15: seq: 1c, analog_in_state oid=19 next_clock=798173568 value=31688
Receive: 82 1501.637157 1500.937260 15: seq: 1c, analog_in_state oid=26 next_clock=806573568 value=31531
Receive: 83 1501.662789 1501.662496 11: seq: 1d, clock clock=774526006
Receive: 84 1501.687111 1501.662496 14: seq: 1d, analog_in_state oid=31 next_clock=812573568 value=6103
Receive: 85 1501.867147 1501.662496 15: seq: 1d, analog_in_state oid=19 next_clock=834173568 value=31696
Receive: 86 1501.937172 1501.662496 15: seq: 1d, analog_in_state oid=26 next_clock=842573568 value=31533
Receive: 87 1501.969889 1501.662496 15: seq: 1d, stats count=223 sum=214519 sumsq=1950646
Receive: 88 1501.987119 1501.662496 14: seq: 1d, analog_in_state oid=31 next_clock=848573568 value=6101
Receive: 89 1502.167298 1501.662496 15: seq: 1d, analog_in_state oid=19 next_clock=870173568 value=31694
Receive: 90 1502.237154 1501.662496 15: seq: 1d, analog_in_state oid=26 next_clock=878573568 value=31536
Receive: 91 1502.287128 1501.662496 14: seq: 1d, analog_in_state oid=31 next_clock=884573568 value=6099
Receive: 92 1502.467122 1502.438997 15: seq: 1f, analog_in_state oid=19 next_clock=906173568 value=31687
Receive: 93 1502.537142 1502.438997 15: seq: 1f, analog_in_state oid=26 next_clock=914573568 value=31538
Receive: 94 1502.587133 1502.438997 14: seq: 1f, analog_in_state oid=31 next_clock=920573568 value=6104
Receive: 95 1502.647138 1502.646815 11: seq: 10, clock clock=892640946
Receive: 96 1502.767170 1502.646815 15: seq: 10, analog_in_state oid=19 next_clock=942173568 value=31692
Receive: 97 1502.837172 1502.646815 15: seq: 10, analog_in_state oid=26 next_clock=950573568 value=31536
Receive: 98 1502.887190 1502.646815 14: seq: 10, analog_in_state oid=31 next_clock=956573568 value=6106
Receive: 99 1503.045436 1503.045055 12: seq: 13, shutdown clock=940424965 static_string_id=Command request
b'Got EOF when reading from device'
Starting Klippy...
Args: ['/home/pi/klipper/klippy/klippy.py', '/home/pi/printer_data/config/printer.cfg', '-l', '/home/pi/printer_data/logs/klippy.log', '-I', '/home/pi/printer_data/comms/klippy.serial', '-a', '/home/pi/printer_data/comms/klippy.sock']
Git version: 'v0.12.0-65-g96ab9069-dirty'
Untracked files: klippy/extras/gcode_shell_command.py, klippy/extras/led_effect.py
Branch: master
Remote: origin
Tracked URL: https://github.com/Klipper3d/klipper.git
CPU: 4 core ?
Python: '3.9.2 (default, Mar 12 2021, 04:06:34) \n[GCC 10.2.1 20210110]'
Start printer at Fri Jan 12 19:12:26 2024 (1705086746.3 1510.1)
===== Config file =====
[virtual_sdcard]
path = ~/printer_data/gcodes
on_error_gcode = CANCEL_PRINT

[pause_resume]

[display_status]

[respond]

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = CANCEL_PRINT_BASE
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set allow_park = client.park_at_cancel|default(false)|lower == 'true' %}
	{% set retract = client.cancel_retract|default(5.0)|abs %}
	
	{% set park_x = "" if (client.park_at_cancel_x|default(none) is none)
	else "X=" ~ client.park_at_cancel_x %}
	{% set park_y = "" if (client.park_at_cancel_y|default(none) is none)
	else "Y=" ~ client.park_at_cancel_y %}
	{% set custom_park = park_x|length > 0 or park_y|length > 0 %}
	
	
	{% if printer['gcode_macro RESUME'].restore_idle_timeout > 0 %}
	SET_IDLE_TIMEOUT TIMEOUT={printer['gcode_macro RESUME'].restore_idle_timeout}
	{% endif %}
	{% if (custom_park or not printer.pause_resume.is_paused) and allow_park %} _TOOLHEAD_PARK_PAUSE_CANCEL {park_x} {park_y} {% endif %}
	_CLIENT_RETRACT LENGTH={retract}
	TURN_OFF_HEATERS
	M106 S0
	{client.user_cancel_macro|default("")}
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=idle_state VALUE=False
	
	SET_PAUSE_NEXT_LAYER ENABLE=0
	SET_PAUSE_AT_LAYER ENABLE=0 LAYER=0
	CANCEL_PRINT_BASE

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = PAUSE_BASE
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set idle_timeout = client.idle_timeout|default(0) %}
	{% set temp = printer[printer.toolhead.extruder].target if printer.toolhead.extruder != '' else 0 %}
	{% set restore = False if printer.toolhead.extruder == ''
	else True  if params.RESTORE|default(1)|int == 1 else False %}
	
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=last_extruder_temp VALUE="{{'restore': restore, 'temp': temp}}"
	
	{% if idle_timeout > 0 %}
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=restore_idle_timeout VALUE={printer.configfile.settings.idle_timeout.timeout}
	SET_IDLE_TIMEOUT TIMEOUT={idle_timeout}
	{% endif %}
	PAUSE_BASE
	{client.user_pause_macro|default("")}
	_TOOLHEAD_PARK_PAUSE_CANCEL {rawparams}

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = RESUME_BASE
variable_last_extruder_temp = {'restore': False, 'temp': 0}
variable_restore_idle_timeout = 0
variable_idle_state = False
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set sp_move = client.speed_move|default(velocity) %}
	{% set runout_resume = True if client.runout_sensor|default("") == ""
	else True if not printer[client.runout_sensor].enabled
	else printer[client.runout_sensor].filament_detected %}
	{% set can_extrude = True if printer.toolhead.extruder == ''
	else printer[printer.toolhead.extruder].can_extrude %}
	{% set do_resume = False %}
	{% set prompt_txt = [] %}
	
	
	{% if printer.idle_timeout.state|upper == "IDLE" or idle_state %}
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=idle_state VALUE=False
	{% if last_extruder_temp.restore %}
	
	RESPOND TYPE=echo MSG='{"Restoring \"%s\" temperature to %3.1f\u00B0C, this may take some time" % (printer.toolhead.extruder, last_extruder_temp.temp) }'
	M109 S{last_extruder_temp.temp}
	{% set do_resume = True %}
	{% elif can_extrude %}
	{% set do_resume = True %}
	{% else %}
	RESPOND TYPE=error MSG='{"Resume aborted !!! \"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder}'
	{% set _d = prompt_txt.append("\"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder) %}
	{% endif %}
	
	{% elif can_extrude %}
	{% set do_resume = True %}
	{% else %}
	RESPOND TYPE=error MSG='{"Resume aborted !!! \"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder}'
	{% set _d = prompt_txt.append("\"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder) %}
	{% endif %}
	{% if runout_resume %}
	{% if do_resume %}
	{% if restore_idle_timeout > 0 %} SET_IDLE_TIMEOUT TIMEOUT={restore_idle_timeout} {% endif %}
	{client.user_resume_macro|default("")}
	_CLIENT_EXTRUDE
	RESUME_BASE VELOCITY={params.VELOCITY|default(sp_move)}
	{% endif %}
	{% else %}
	RESPOND TYPE=error MSG='{"Resume aborted !!! \"%s\" detects no filament, please load filament and press RESUME" % (client.runout_sensor.split(" "))[1]}'
	{% set _d = prompt_txt.append("\"%s\" detects no filament, please load filament and press RESUME" % (client.runout_sensor.split(" "))[1]) %}
	{% endif %}
	
	{% if not (runout_resume and do_resume) %}
	RESPOND TYPE=command MSG="action:prompt_begin RESUME aborted !!!"
	{% for element in prompt_txt %}
	RESPOND TYPE=command MSG='{"action:prompt_text %s" % element}'
	{% endfor %}
	RESPOND TYPE=command MSG="action:prompt_footer_button Ok|RESPOND TYPE=command MSG=action:prompt_end|info"
	RESPOND TYPE=command MSG="action:prompt_show"
	{% endif %}

[gcode_macro SET_PAUSE_NEXT_LAYER]
description = Enable a pause if the next layer is reached
gcode = 
	{% set pause_next_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_next_layer %}
	{% set ENABLE = params.ENABLE|default(1)|int != 0 %}
	{% set MACRO = params.MACRO|default(pause_next_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_next_layer VALUE="{{ 'enable': ENABLE, 'call': MACRO }}"

[gcode_macro SET_PAUSE_AT_LAYER]
description = Enable/disable a pause if a given layer number is reached
gcode = 
	{% set pause_at_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_at_layer %}
	{% set ENABLE = params.ENABLE|int != 0 if params.ENABLE is defined
	else params.LAYER is defined %}
	{% set LAYER = params.LAYER|default(pause_at_layer.layer)|int %}
	{% set MACRO = params.MACRO|default(pause_at_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_at_layer VALUE="{{ 'enable': ENABLE, 'layer': LAYER, 'call': MACRO }}"

[gcode_macro SET_PRINT_STATS_INFO]
rename_existing = SET_PRINT_STATS_INFO_BASE
description = Overwrite, to get pause_next_layer and pause_at_layer feature
variable_pause_next_layer = { 'enable': False, 'call': "PAUSE" }
variable_pause_at_layer = { 'enable': False, 'layer': 0, 'call': "PAUSE" }
gcode = 
	{% if pause_next_layer.enable %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_next_layer" % pause_next_layer.call}'
	{pause_next_layer.call}
	SET_PAUSE_NEXT_LAYER ENABLE=0
	{% elif pause_at_layer.enable and params.CURRENT_LAYER is defined and params.CURRENT_LAYER|int == pause_at_layer.layer %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_at_layer [%d]" % (pause_at_layer.call, pause_at_layer.layer)}'
	{pause_at_layer.call}
	SET_PAUSE_AT_LAYER ENABLE=0
	{% endif %}
	SET_PRINT_STATS_INFO_BASE {rawparams}

[gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL]
description = Helper: park toolhead used in PAUSE and CANCEL_PRINT
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set use_custom     = client.use_custom_pos|default(false)|lower == 'true' %}
	{% set custom_park_x  = client.custom_park_x|default(0.0) %}
	{% set custom_park_y  = client.custom_park_y|default(0.0) %}
	{% set park_dz        = client.custom_park_dz|default(2.0)|abs %}
	{% set sp_hop         = client.speed_hop|default(15) * 60 %}
	{% set sp_move        = client.speed_move|default(velocity) * 60 %}
	
	{% set origin    = printer.gcode_move.homing_origin %}
	{% set act       = printer.gcode_move.gcode_position %}
	{% set max       = printer.toolhead.axis_maximum %}
	{% set cone      = printer.toolhead.cone_start_z|default(max.z) %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	
	{% set z_min = params.Z_MIN|default(0)|float %}
	{% set z_park = [[(act.z + park_dz), z_min]|max, (max.z - origin.z)]|min %}
	{% set x_park = params.X       if params.X is defined
	else custom_park_x  if use_custom
	else 0.0            if round_bed
	else (max.x - 5.0) %}
	{% set y_park = params.Y       if params.Y is defined
	else custom_park_y  if use_custom
	else (max.y - 5.0)  if round_bed and z_park < cone
	else 0.0            if round_bed
	else (max.y - 5.0) %}
	
	_CLIENT_RETRACT
	{% if "xyz" in printer.toolhead.homed_axes %}
	G90
	G1 Z{z_park} F{sp_hop}
	G1 X{x_park} Y{y_park} F{sp_move}
	{% if not printer.gcode_move.absolute_coordinates %} G91 {% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='Printer not homed'
	{% endif %}

[gcode_macro _CLIENT_EXTRUDE]
description = Extrudes, if the extruder is hot enough
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set use_fw_retract = (client.use_fw_retract|default(false)|lower == 'true') and (printer.firmware_retraction is defined) %}
	{% set length = params.LENGTH|default(client.unretract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_unretract)|default(35) %}
	{% set absolute_extrude = printer.gcode_move.absolute_extrude %}
	
	{% if printer.toolhead.extruder != '' %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if use_fw_retract %}
	{% if length < 0 %}
	G10
	{% else %}
	G11
	{% endif %}
	{% else %}
	M83
	G1 E{length} F{(speed|float|abs) * 60}
	{% if absolute_extrude %}
	M82
	{% endif %}
	{% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='{"\"%s\" not hot enough" % printer.toolhead.extruder}'
	{% endif %}
	{% endif %}

[gcode_macro _CLIENT_RETRACT]
description = Retracts, if the extruder is hot enough
gcode = 
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set length = params.LENGTH|default(client.retract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_retract)|default(35) %}
	
	_CLIENT_EXTRUDE LENGTH=-{length|float|abs} SPEED={speed|float|abs}

[gcode_macro START_PRINT]
gcode = 
	{% set BED_TEMP = params.BED_TEMP|default(55)|float %}
	{% set EXTRUDER_TEMP = params.EXTRUDER_TEMP|default(200)|float %}
	M117 Print Starting...
	G28 X Y
	G90
	M220 S100
	M221 S100
	G92 E0
	
	
	
	
	
	
	M140 S{BED_TEMP}
	
	M190 S{BED_TEMP}
	
	M117 Waiting for temperature
	
	
	M117 Homing All...
	
	G90
	
	G28
	
	M117 Z-Tilt Adjust
	Z_TILT_ADJUST
	
	M117 Generating mesh
	
	BED_MESH_CLEAR
	
	BED_MESH_CALIBRATE
	
	BED_MESH_PROFILE LOAD=default
	
	G1 X100 Y392 F10000
	
	M117 Heaters Recovering...
	
	
	M109 S{EXTRUDER_TEMP} T0; start warming extruder to preheat temp
	
	
	M117 Purging extruder...
	
	
	CLEAN_AND_PURGE_NOZZLE
	
	M117 Printing.....
	UPDATE_DELAYED_GCODE ID=clear_display DURATION=10

[gcode_macro END_PRINT]
gcode = 
	
	{% set th = printer.toolhead %}
	{% set x_safe = th.position.x + 20 * (1 if th.axis_maximum.x - th.position.x > 20 else -1) %}
	{% set y_safe = th.position.y + 20 * (1 if th.axis_maximum.y - th.position.y > 20 else -1) %}
	{% set z_safe = [th.position.z + 2, th.axis_maximum.z]|min %}
	
	SAVE_GCODE_STATE NAME=STATE_PRINT_END
	
	
	
	M400
	G92 E0
	
	G91
	G1 E-0.7 Z+5 F3000
	G90
	
	TURN_OFF_HEATERS
	
	G0 X{x_safe} Y{y_safe} Z{z_safe} F20000
	G0 X{th.axis_maximum.x//2} Y{th.axis_maximum.y - 2} F3600
	
	AFTER_PRINT_CLEAN_NOZZLE
	
	G0 X{th.axis_maximum.x/2} Y{th.axis_maximum.y - 2} F3600
	
	TURN_OFF_HEATERS
	
	M84 X Y E
	
	
	SET_PRESSURE_ADVANCE ADVANCE=0.0
	M117 Pressure Advance Set 0.0
	
	
	
	
	BED_MESH_CLEAR
	
	
	
	
	
	M117 Print Finished
	UPDATE_DELAYED_GCODE ID=clear_display DURATION=10
	
	RESTORE_GCODE_STATE NAME=STATE_PRINT_END

[gcode_macro PRIME_LINE]
gcode = 
	M117 Prime Line
	G92 E0
	
	G1 Z2.0 F3000
	
	G1 X40 Y2 Z0.3 F5000.0
	G1 X120 Y2 Z0.3 F500.0 E15
	G1 X120 Y2.3 Z0.3 F5000.0
	G1 X40 Y2.3 Z0.3 F500.0 E30
	G92 E0
	G1 Z2.0 F3000

[gcode_macro CLEAN_NOZZLE]
variable_start_x = 63
variable_start_y = 387
variable_wipe_dist_y = -3
variable_wipe_qty = 5
variable_wipe_spd = 50
variable_end_loc_x = 189
variable_end_loc_y = 185
gcode = 
	SAVE_GCODE_STATE NAME=STATE_PRINT_CURRENT
	
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	G90
	M220 S100
	M204 S100
	M221 S100
	
	
	G1 X{start_x} Y{start_y} F6000
	
	
	{% for wipes in range(1, (wipe_qty + 1)) %}
	
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	
	{% endfor %}
	
	G1 X{end_loc_x} F10000
	
	RESTORE_GCODE_STATE NAME=STATE_PRINT_CURRENT

[gcode_macro CLEAN_AND_PURGE_NOZZLE]
variable_start_x = 63
variable_start_y = 387
variable_start_z = 10
variable_wipe_dist_y = -3
variable_wipe_qty = 5
variable_wipe_spd = 50
variable_purge_loc_x = 100
variable_purge_loc_y = 392
variable_post_purge_y = 386
variable_end_loc_x = 189
variable_end_loc_y = 185
gcode = 
	SAVE_GCODE_STATE NAME=STATE_PRINT_CURRENT
	
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	G90
	
	
	
	
	
	G1 X{start_x} Y{start_y} F6000
	
	
	{% for wipes in range(1, (wipe_qty + 1)) %}
	
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	
	{% endfor %}
	
	G1 X{purge_loc_x}
	G1 Y{purge_loc_y}
	G92 E0
	G1 E30.0 F100
	G92 E0
	G1 E-0.5 F300
	
	G1 Y{post_purge_y} F10000
	G1 X{start_x}
	G1 X{end_loc_x} F10000
	
	RESTORE_GCODE_STATE NAME=STATE_PRINT_CURRENT

[gcode_macro AFTER_PRINT_CLEAN_NOZZLE]
variable_start_x = 63
variable_start_y = 387
variable_wipe_dist_y = -3
variable_wipe_qty = 5
variable_wipe_spd = 50
gcode = 
	SAVE_GCODE_STATE NAME=STATE_PRINT_CURRENT
	
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	G90
	
	
	
	
	G1 X{start_x} Y{start_y} F6000
	
	
	{% for wipes in range(1, (wipe_qty + 1)) %}
	
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	
	{% endfor %}
	
	RESTORE_GCODE_STATE NAME=STATE_PRINT_CURRENT

[delayed_gcode clear_display]
gcode = 
	M117

[gcode_macro Probe_Z_Height]
gcode = 
	G28
	
	PROBE_CALIBRATE

[gcode_macro automatic_bed_screw_adjust]
gcode = 
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	SCREWS_TILT_CALCULATE

[gcode_macro z_motor_alignment]
gcode = 
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	Z_TILT_ADJUST

[gcode_macro Accelerometer_Connection_Test]
gcode = 
	ACCELEROMETER_QUERY

[gcode_macro X_Axis_Resonance_Test]
gcode = 
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	TEST_RESONANCES AXIS=X

[gcode_macro Y_Axis_Resonance_Test]
gcode = 
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	TEST_RESONANCES AXIS=Y

[gcode_macro BED_MESH_CALIBRATE]
rename_existing = _BED_MESH_CALIBRATE
gcode = 
	
	{% set all_points = printer.exclude_object.objects | map(attribute='polygon') | sum(start=[]) %}
	{% set bed_mesh_min = printer.configfile.settings.bed_mesh.mesh_min %}
	{% set bed_mesh_max = printer.configfile.settings.bed_mesh.mesh_max %}
	{% set probe_count = printer.configfile.settings.bed_mesh.probe_count %}
	{% set kamp_settings = printer["gcode_macro _KAMP_Settings"] %}
	{% set verbose_enable = kamp_settings.verbose_enable | abs %}
	{% set probe_dock_enable = kamp_settings.probe_dock_enable | abs %}
	{% set attach_macro = kamp_settings.attach_macro | string %}
	{% set detach_macro = kamp_settings.detach_macro | string %}
	{% set mesh_margin = kamp_settings.mesh_margin | float %}
	{% set fuzz_amount = kamp_settings.fuzz_amount | float %}
	{% set probe_count = probe_count if probe_count|length > 1 else probe_count * 2  %}
	{% set max_probe_point_distance_x = ( bed_mesh_max[0] - bed_mesh_min[0] ) / (probe_count[0] - 1)  %}
	{% set max_probe_point_distance_y = ( bed_mesh_max[1] - bed_mesh_min[1] ) / (probe_count[1] - 1)  %}
	{% set x_min = all_points | map(attribute=0) | min | default(bed_mesh_min[0]) %}
	{% set y_min = all_points | map(attribute=1) | min | default(bed_mesh_min[1]) %}
	{% set x_max = all_points | map(attribute=0) | max | default(bed_mesh_max[0]) %}
	{% set y_max = all_points | map(attribute=1) | max | default(bed_mesh_max[1]) %}
	
	{% set fuzz_range = range((0) | int, (fuzz_amount * 100) | int + 1) %}
	{% set adapted_x_min = x_min - mesh_margin - (fuzz_range | random / 100.0) %}
	{% set adapted_y_min = y_min - mesh_margin - (fuzz_range | random / 100.0) %}
	{% set adapted_x_max = x_max + mesh_margin + (fuzz_range | random / 100.0) %}
	{% set adapted_y_max = y_max + mesh_margin + (fuzz_range | random / 100.0) %}
	
	{% set adapted_x_min = [adapted_x_min , bed_mesh_min[0]] | max %}
	{% set adapted_y_min = [adapted_y_min , bed_mesh_min[1]] | max %}
	{% set adapted_x_max = [adapted_x_max , bed_mesh_max[0]] | min %}
	{% set adapted_y_max = [adapted_y_max , bed_mesh_max[1]] | min %}
	
	{% set points_x = (((adapted_x_max - adapted_x_min) / max_probe_point_distance_x) | round(method='ceil') | int) + 1 %}
	{% set points_y = (((adapted_y_max - adapted_y_min) / max_probe_point_distance_y) | round(method='ceil') | int) + 1 %}
	
	{% if (([points_x, points_y]|max) > 6) %}
	{% set algorithm = "bicubic" %}
	{% set min_points = 4 %}
	{% else %}
	{% set algorithm = "lagrange" %}
	{% set min_points = 3 %}
	{% endif %}
	
	{% set points_x = [points_x , min_points]|max %}
	{% set points_y = [points_y , min_points]|max %}
	{% set points_x = [points_x , probe_count[0]]|min %}
	{% set points_y = [points_y , probe_count[1]]|min %}
	
	{% if verbose_enable == True %}
	{% if printer.exclude_object.objects != [] %}
	
	{ action_respond_info( "Algorithm: {}.".format(
	(algorithm),
	)) }
	
	{ action_respond_info("Default probe count: {},{}.".format(
	(probe_count[0]),
	(probe_count[1]),
	)) }
	
	{ action_respond_info("Adapted probe count: {},{}.".format(
	(points_x),
	(points_y),
	)) }
	
	{action_respond_info("Default mesh bounds: {}, {}.".format(
	(bed_mesh_min[0],bed_mesh_min[1]),
	(bed_mesh_max[0],bed_mesh_max[1]),
	)) }
	
	{% if mesh_margin > 0 %}
	{action_respond_info("Mesh margin is {}, mesh bounds extended by {}mm.".format(
	(mesh_margin),
	(mesh_margin),
	)) }
	{% else %}
	{action_respond_info("Mesh margin is 0, margin not increased.")}
	{% endif %}
	
	{% if fuzz_amount > 0 %}
	{action_respond_info("Mesh point fuzzing enabled, points fuzzed up to {}mm.".format(
	(fuzz_amount),
	)) }
	{% else %}
	{action_respond_info("Fuzz amount is 0, mesh points not fuzzed.")}
	{% endif %}
	
	{ action_respond_info("Adapted mesh bounds: {}, {}.".format(
	(adapted_x_min, adapted_y_min),
	(adapted_x_max, adapted_y_max),
	)) }
	
	{action_respond_info("KAMP adjustments successful. Happy KAMPing!")}
	
	{% else %}
	
	{action_respond_info("No objects detected! Check your gcode and make sure that EXCLUDE_OBJECT_DEFINE is happening before BED_MESH_CALIBRATE is called. Defaulting to regular meshing.")}
	G4 P5000
	{% endif %}
	
	{% endif %}
	
	{% if probe_dock_enable == True %}
	{attach_macro}
	{% endif %}
	
	_BED_MESH_CALIBRATE mesh_min={adapted_x_min},{adapted_y_min} mesh_max={adapted_x_max},{adapted_y_max} ALGORITHM={algorithm} PROBE_COUNT={points_x},{points_y}
	
	{% if probe_dock_enable == True %}
	{detach_macro}
	{% endif %}

[gcode_macro _KAMP_Settings]
description = This macro contains all adjustable settings for KAMP
variable_verbose_enable = True
variable_mesh_margin = 0
variable_fuzz_amount = 0
variable_probe_dock_enable = False
variable_attach_macro = 'Attach_Probe'
variable_detach_macro = 'Dock_Probe'
variable_purge_height = 0.8
variable_tip_distance = 0
variable_purge_margin = 10
variable_purge_amount = 30
variable_flow_rate = 12
variable_smart_park_height = 10
gcode = 
	
	{action_respond_info(" Running the KAMP_Settings macro does nothing, it is only used for storing KAMP settings. ")}

[led_effect sb_logo_busy]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (1,0,0)

[led_effect sb_logo_cleaning]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 0.02, 0.5)

[led_effect sb_logo_calibrating_z]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 0.0, 0.35)

[led_effect sb_logo_heating]
leds = 
	neopixel:sb_leds (1,3,7,8,6,2)
autostart = false
frame_rate = 24
layers = 
	comet  0.3  0 add (1, 0.18, 0)

[led_effect sb_logo_cooling]
leds = 
	neopixel:sb_leds (1,3,7,8,6,2)
autostart = false
frame_rate = 24
layers = 
	comet  0.3  0 add (0, 0, 1)

[led_effect sb_logo_homing]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 0.6, 0.2)

[led_effect sb_logo_leveling]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.5, 0.1, 0.4)

[led_effect sb_logo_meshing]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.2, 1.0, 0.0)

[led_effect sb_logo_printing]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	gradient  0.3  1 add (0.3, 0.0, 0.0),(0.3, 0.3, 0.0),(0.3, 0.1, 0.0)

[led_effect sb_logo_standby]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.01, 0.01, 0.01)

[led_effect sb_logo_part_ready]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 1.0, 0.0)

[led_effect sb_nozzle_heating]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (1.0, 0.18, 0.0, 0.0)

[led_effect sb_nozzle_cooling]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (0.0, 0.0, 1.0, 0.1)

[led_effect sb_nozzle_standby]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (0.6, 0.0, 0.0, 0.0)

[led_effect sb_nozzle_part_ready]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (0.6, 1.0, 0.0, 0.1)

[led_effect sb_critical_error]
leds = 
	neopixel:sb_leds
layers = 
	strobe         1  1.5   add        (1.0,  1.0, 1.0)
	breathing      2  0     difference (0.95, 0.0, 0.0)
	static         1  0     top        (1.0,  0.0, 0.0)
autostart = false
frame_rate = 24
run_on_error = true

[led_effect rainbow]
leds = 
	neopixel:chamber_leds
autostart = false
frame_rate = 24
layers = 
	gradient  0.3  1 add (0.3, 0.0, 0.0),(0.0, 0.3, 0.0),(0.0, 0.0, 0.3)

[led_effect set_nozzle_leds]
leds = 
	neopixel:sb_leds (9,10)
autostart = false
frame_rate = 24
layers = 
	static         0  0     top        (0.0,  0.0, 0.0, 1.0)

[led_effect set_logo_leds]
leds = 
	neopixel:sb_leds (1,2,3,4,5,6,7,8)
autostart = false
frame_rate = 24
layers = 
	static         0  0     top        (1.0,  1.0, 1.0)

[led_effect set_chamber_leds]
leds = 
	neopixel:chamber_leds
autostart = false
frame_rate = 24
layers = 
	static         0  0     top        (1.0,  1.0, 1.0)

[gcode_macro set_logo_leds_off]
gcode = 
	SET_LED_EFFECT EFFECT=set_logo_leds STOP=1

[gcode_macro set_logo_leds_on]
gcode = 
	SET_LED_EFFECT EFFECT=set_logo_leds

[gcode_macro set_nozzle_leds_on]
gcode = 
	SET_LED_EFFECT EFFECT=set_nozzle_leds

[gcode_macro set_nozzle_leds_off]
gcode = 
	SET_LED_EFFECT EFFECT=set_nozzle_leds STOP=1

[gcode_macro set_chamber_leds_off]
gcode = 
	SET_LED_EFFECT EFFECT=set_chamber_leds STOP=1

[gcode_macro set_chamber_leds_on]
gcode = 
	SET_LED_EFFECT EFFECT=set_chamber_leds

[gcode_macro status_off]
gcode = 
	STOP_LED_EFFECTS

[gcode_macro status_ready]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=rainbow

[gcode_macro status_part_ready]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_nozzle_part_ready
	SET_LED_EFFECT EFFECT=sb_logo_part_ready

[gcode_macro status_busy]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_busy
	set_nozzle_leds_on

[gcode_macro status_heating]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_heating
	SET_LED_EFFECT EFFECT=sb_nozzle_heating

[gcode_macro status_cooling]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_cooling
	SET_LED_EFFECT EFFECT=sb_nozzle_cooling

[gcode_macro status_leveling]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_leveling
	set_nozzle_leds_on

[gcode_macro status_homing]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_homing
	set_nozzle_leds_on

[gcode_macro status_cleaning]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_cleaning
	set_nozzle_leds_on

[gcode_macro status_meshing]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_meshing
	set_nozzle_leds_on

[gcode_macro status_calibrating_z]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_calibrating_z
	set_nozzle_leds_on

[gcode_macro status_printing]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_printing
	set_nozzle_leds_on

[printer]
kinematics = corexy
max_velocity = 300
max_accel = 5700
max_z_velocity = 5
max_z_accel = 100
square_corner_velocity = 5.0

[mcu]
serial = /dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00

[mcu rpi]
serial = /tmp/klipper_host_mcu

[adxl345]
cs_pin = rpi:None

[resonance_tester]
accel_chip = adxl345
probe_points = 
	189,185,20

[input_shaper]
shaper_freq_x = 61.8
shaper_type_x = mzv
shaper_freq_y = 38.4
shaper_type_y = zv

[stepper_x]
step_pin = P1.4
dir_pin = !P1.8
enable_pin = !P1.0
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 40
endstop_pin = ^P1.29
position_endstop = 383
position_min = -5
position_max = 383
homing_speed = 25
homing_retract_dist = 5.0

[tmc2209 stepper_x]
uart_pin = P1.1
interpolate = False
run_current = 1.00
stealthchop_threshold = 0

[stepper_y]
step_pin = P1.14
dir_pin = !P1.15
enable_pin = !P1.9
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 40
endstop_pin = ^P1.28
position_endstop = 392
position_min = -8
position_max = 392
homing_speed = 25
homing_retract_dist = 5.0

[tmc2209 stepper_y]
uart_pin = P1.10
interpolate = False
run_current = 1.00
stealthchop_threshold = 0

[stepper_z]
step_pin = P4.29
dir_pin = !P4.28
enable_pin = !P1.16
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 4
endstop_pin = probe:z_virtual_endstop
position_min = -5
position_max = 395

[tmc2209 stepper_z]
uart_pin = P1.17
interpolate = False
run_current = 0.580
stealthchop_threshold = 0

[stepper_z1]
step_pin = P2.11
dir_pin = !P2.12
enable_pin = !P0.21
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 4

[tmc2209 stepper_z1]
uart_pin = P0.22
interpolate = False
run_current = 0.580
stealthchop_threshold = 0

[extruder]
step_pin = P2.6
dir_pin = !P2.7
enable_pin = !P0.4
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 35.291
gear_ratio = 7.5:1
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = P2.3
sensor_type = PT1000
sensor_pin = P0.24
control = pid
pid_kp = 14.430
pid_ki = 1.023
pid_kd = 50.866
min_temp = 10
max_temp = 350
max_extrude_only_distance = 500
max_extrude_only_velocity = 120
min_extrude_temp = 180
max_extrude_cross_section = 50.
pressure_advance = 0.000
pressure_advance_smooth_time = 0.03

[tmc2209 extruder]
uart_pin = P0.5
interpolate = false
run_current = 0.79
stealthchop_threshold = 0
driver_tbl = 0
driver_hend = 6
driver_hstrt = 7
driver_toff = 4

[static_digital_output tmc_standby_pins]
pins = !P3.26, !P3.25, !P1.18, !P1.19, !P2.13

[heater_bed]
heater_pin = P2.5
sensor_type = EPCOS 100K B57560G104F
sensor_pin = P0.25
control = pid
pid_kp = 68.561
pid_ki = 0.619
pid_kd = 1897.417
min_temp = 0
max_temp = 130

[idle_timeout]
timeout = 3600

[bltouch]
sensor_pin = ^P1.27
control_pin = P1.23
x_offset = -33
y_offset = -5
z_offset = 2.500
samples = 1
samples_result = average
sample_retract_dist = 2.0
samples_tolerance = 0.05
samples_tolerance_retries = 3
stow_on_each_sample = False

[safe_z_home]
home_xy_position = 221,190
speed = 60
z_hop = 12
z_hop_speed = 5

[screws_tilt_adjust]
screw1 = 69, 319
screw1_name = rear left screw
screw2 = 368, 60
screw2_name = front right screw
screw3 = 368, 319
screw3_name = rear right screw
screw4 = 69, 60
screw4_name = front left screw
horizontal_move_z = 10.
speed = 50.
screw_thread = CW-M4

[z_tilt]
z_positions = -20, 183
	402, 183
points = 56, 183
	383, 183
speed = 50
horizontal_move_z = 10
retries = 20
retry_tolerance = 0.01

[bed_mesh]
speed = 120
horizontal_move_z = 5
mesh_min = 50, 80
mesh_max = 323, 314
probe_count = 7, 7
algorithm = bicubic
bicubic_tension = 0.5
fade_start = 0.6
fade_end = 10
fade_target = 0

[fan]
pin = P2.1

[heater_fan heatbreak_cooling_fan]
pin = P2.2

[display]
lcd_type = st7920
menu_timeout = 600
cs_pin = EXP1_7
sclk_pin = EXP1_6
sid_pin = EXP1_8
encoder_pins = ^EXP1_5, ^EXP1_3
click_pin = ^!EXP1_2

[output_pin beeper]
pin = EXP1_1

[board_pins]
aliases = 
	
	EXP1_1=P2.8,  EXP1_3=P0.19, EXP1_5=P0.20, EXP1_7=P0.17, EXP1_9=<GND>,
	EXP1_2=P0.16, EXP1_4=<RST>, EXP1_6=P0.15, EXP1_8=P0.18, EXP1_10=<5V>

[filament_motion_sensor SmartFilamentSensor_T0]
detection_length = 7.00
extruder = extruder
switch_pin = ^P1.26
pause_on_runout = True
event_delay = 3.0
pause_delay = 0.5
runout_gcode = 
	M117 Runout Detected!

[temperature_sensor raspberry_pi]
sensor_type = temperature_host
min_temp = 10
max_temp = 100

[temperature_sensor Mainboard]
sensor_type = NTC 100K MGB18-104F39050L32
sensor_pin = P1.30
min_temp = 10
max_temp = 100

[neopixel chamber_leds]
pin = P1.22
chain_count = 85
color_order = GRB
initial_red = 0.0
initial_green = 0.0
initial_blue = 0.0
initial_white = 0.0

[neopixel sb_leds]
pin = P1.24
chain_count = 10
color_order = GRB,GRB,GRB,GRB,GRB,GRB,GRB,GRB,GRBW,GRBW
initial_red = 0.0
initial_green = 0.0
initial_blue = 0.0
initial_white = 0.0

[exclude_object]

[gcode_arcs]
resolution = 0.1
=======================
Extruder max_extrude_ratio=20.787584
mcu 'mcu': Starting serial connect
webhooks client 4122689744: New connection
webhooks client 4122689744: Client info {'program': 'Moonraker', 'version': 'v0.8.0-247-g3008a13'}
mcu 'mcu': got {'oid': 19, 'next_clock': 2022173568, 'value': 31695, '#name': 'analog_in_state', '#sent_time': 1511.73675571, '#receive_time': 1511.767454636}
mcu 'mcu': got {'oid': 26, 'next_clock': 2030573568, 'value': 31537, '#name': 'analog_in_state', '#sent_time': 1511.788308821, '#receive_time': 1511.837485487}
mcu 'mcu': got {'oid': 31, 'next_clock': 2036573568, 'value': 6105, '#name': 'analog_in_state', '#sent_time': 1511.83936758, '#receive_time': 1511.887452802}
mcu 'mcu': got {'count': 378, 'sum': 489069, 'sumsq': 4376682, '#name': 'stats', '#sent_time': 1512.042036302, '#receive_time': 1512.042251246}
mcu 'mcu': got {'oid': 19, 'next_clock': 2058173568, 'value': 31695, '#name': 'analog_in_state', '#sent_time': 1512.042036302, '#receive_time': 1512.067465246}
mcu 'mcu': got {'oid': 26, 'next_clock': 2066573568, 'value': 31536, '#name': 'analog_in_state', '#sent_time': 1512.09329895, '#receive_time': 1512.137473432}
Loaded MCU 'mcu' 105 commands (v0.11.0-205-g5f0d252b / gcc: (15:8-2019-q3-1+b1) 8.3.1 20190703 (release) [gcc-8-branch revision 273027] binutils: (2.34-4+rpi1+14) 2.34)
MCU 'mcu' config: ADC_MAX=4095 BUS_PINS_i2c0=P0.28,P0.27 BUS_PINS_i2c1=P0.1,P0.0 BUS_PINS_i2c1a=P0.20,P0.19 BUS_PINS_i2c2=P0.11,P0.10 BUS_PINS_ssp0=P0.17,P0.18,P0.15 BUS_PINS_ssp1=P0.8,P0.9,P0.7 CLOCK_FREQ=120000000 MCU=lpc1769 PWM_MAX=255 RESERVE_PINS_USB=P0.30,P0.29,P2.9 STATS_SUMSQ_BASE=256 STEPPER_BOTH_EDGE=1
mcu 'rpi': Starting connect
mcu 'mcu': got {'oid': 31, 'next_clock': 2072573568, 'value': 6109, '#name': 'analog_in_state', '#sent_time': 1512.146129061, '#receive_time': 1512.187534469}
mcu 'mcu': got {'oid': 19, 'next_clock': 2094173568, 'value': 31695, '#name': 'analog_in_state', '#sent_time': 1512.146129061, '#receive_time': 1512.367501617}
mcu 'mcu': got {'oid': 26, 'next_clock': 2102573568, 'value': 31536, '#name': 'analog_in_state', '#sent_time': 1512.146129061, '#receive_time': 1512.437497191}
mcu 'mcu': got {'oid': 31, 'next_clock': 2108573568, 'value': 6108, '#name': 'analog_in_state', '#sent_time': 1512.146129061, '#receive_time': 1512.487486728}
Loaded MCU 'rpi' 113 commands (v0.11.0-240-g6d48adf9 / gcc: (Raspbian 10.2.1-6+rpi1) 10.2.1 20210110 binutils: (GNU Binutils for Raspbian) 2.35.2)
MCU 'rpi' config: ADC_MAX=4095 CLOCK_FREQ=50000000 MCU=linux PCA9685_MAX=4096 PWM_MAX=32768 STATS_SUMSQ_BASE=256
MCU error during connect
Traceback (most recent call last):
  File "/home/pi/klipper/klippy/klippy.py", line 180, in _connect
    cb()
  File "/home/pi/klipper/klippy/mcu.py", line 750, in _connect
    config_params = self._send_get_config()
  File "/home/pi/klipper/klippy/mcu.py", line 736, in _send_get_config
    raise error("Can not update MCU '%s' config as it is shutdown" % (
mcu.error: Can not update MCU 'mcu' config as it is shutdown
Build file /home/pi/klipper/klippy/../.config(857): Sat Jul  8 00:12:43 2023
========= Last MCU build config =========
CONFIG_LOW_LEVEL_OPTIONS=y
# CONFIG_MACH_AVR is not set
# CONFIG_MACH_ATSAM is not set
# CONFIG_MACH_ATSAMD is not set
# CONFIG_MACH_LPC176X is not set
# CONFIG_MACH_STM32 is not set
# CONFIG_MACH_HC32F460 is not set
# CONFIG_MACH_RP2040 is not set
# CONFIG_MACH_PRU is not set
# CONFIG_MACH_AR100 is not set
CONFIG_MACH_LINUX=y
# CONFIG_MACH_SIMU is not set
CONFIG_BOARD_DIRECTORY="linux"
CONFIG_CLOCK_FREQ=50000000
CONFIG_LINUX_SELECT=y
CONFIG_USB_VENDOR_ID=0x1d50
CONFIG_USB_DEVICE_ID=0x614e
CONFIG_USB_SERIAL_NUMBER="12345"
CONFIG_WANT_GPIO_BITBANGING=y
CONFIG_WANT_DISPLAYS=y
CONFIG_WANT_SENSORS=y
CONFIG_WANT_SOFTWARE_I2C=y
CONFIG_WANT_SOFTWARE_SPI=y
CONFIG_CANBUS_FREQUENCY=1000000
CONFIG_INITIAL_PINS=""
CONFIG_HAVE_GPIO=y
CONFIG_HAVE_GPIO_ADC=y
CONFIG_HAVE_GPIO_SPI=y
CONFIG_HAVE_GPIO_I2C=y
CONFIG_HAVE_GPIO_HARD_PWM=y
CONFIG_INLINE_STEPPER_HACK=y
=======================
Build file /home/pi/klipper/klippy/../out/klipper.dict(9343): Sat Jul  8 01:36:13 2023
Last MCU build version: v0.11.0-240-g6d48adf9
Last MCU build tools: gcc: (Raspbian 10.2.1-6+rpi1) 10.2.1 20210110 binutils: (GNU Binutils for Raspbian) 2.35.2
Last MCU build config: ADC_MAX=4095 CLOCK_FREQ=50000000 MCU=linux PCA9685_MAX=4096 PWM_MAX=32768 STATS_SUMSQ_BASE=256
Build file /home/pi/klipper/klippy/../out/klipper.elf(689552): Sat Jul  8 01:36:21 2023
mcu 'mcu': got {'oid': 19, 'next_clock': 2130173568, 'value': 31690, '#name': 'analog_in_state', '#sent_time': 1512.610739561, '#receive_time': 1512.667517357}
mcu 'mcu': got {'oid': 26, 'next_clock': 2138573568, 'value': 31533, '#name': 'analog_in_state', '#sent_time': 1512.610739561, '#receive_time': 1512.737509968}
mcu 'mcu': got {'oid': 31, 'next_clock': 2144573568, 'value': 6107, '#name': 'analog_in_state', '#sent_time': 1512.610739561, '#receive_time': 1512.787591079}
mcu 'mcu': got {'oid': 19, 'next_clock': 2166173568, 'value': 31692, '#name': 'analog_in_state', '#sent_time': 1512.610739561, '#receive_time': 1512.967550153}
mcu 'mcu': got {'oid': 26, 'next_clock': 2174573568, 'value': 31532, '#name': 'analog_in_state', '#sent_time': 1512.610739561, '#receive_time': 1513.03751382}
mcu 'mcu': got {'oid': 31, 'next_clock': 2180573568, 'value': 6101, '#name': 'analog_in_state', '#sent_time': 1512.610739561, '#receive_time': 1513.087526209}
mcu 'mcu': got {'oid': 19, 'next_clock': 2202173568, 'value': 31691, '#name': 'analog_in_state', '#sent_time': 1513.13034232, '#receive_time': 1513.267517301}
mcu 'mcu': got {'oid': 26, 'next_clock': 2210573568, 'value': 31536, '#name': 'analog_in_state', '#sent_time': 1513.13034232, '#receive_time': 1513.337537746}
mcu 'mcu': got {'oid': 31, 'next_clock': 2216573568, 'value': 6100, '#name': 'analog_in_state', '#sent_time': 1513.13034232, '#receive_time': 1513.38752182}
mcu 'mcu': got {'oid': 19, 'next_clock': 2238173568, 'value': 31698, '#name': 'analog_in_state', '#sent_time': 1513.13034232, '#receive_time': 1513.567553857}
mcu 'mcu': got {'oid': 26, 'next_clock': 2246573568, 'value': 31540, '#name': 'analog_in_state', '#sent_time': 1513.13034232, '#receive_time': 1513.637589597}
mcu 'mcu': got {'oid': 31, 'next_clock': 2252573568, 'value': 6104, '#name': 'analog_in_state', '#sent_time': 1513.13034232, '#receive_time': 1513.687536116}
mcu 'mcu': got {'oid': 19, 'next_clock': 2274173568, 'value': 31687, '#name': 'analog_in_state', '#sent_time': 1513.13034232, '#receive_time': 1513.867577023}
mcu 'mcu': got {'oid': 26, 'next_clock': 2282573568, 'value': 31533, '#name': 'analog_in_state', '#sent_time': 1513.13034232, '#receive_time': 1513.937550856}
mcu 'mcu': got {'oid': 31, 'next_clock': 2288573568, 'value': 6103, '#name': 'analog_in_state', '#sent_time': 1513.13034232, '#receive_time': 1513.987555968}
mcu 'mcu': got {'oid': 19, 'next_clock': 2310173568, 'value': 31689, '#name': 'analog_in_state', '#sent_time': 1514.114842079, '#receive_time': 1514.16755319}
mcu 'mcu': got {'oid': 26, 'next_clock': 2318573568, 'value': 31536, '#name': 'analog_in_state', '#sent_time': 1514.114842079, '#receive_time': 1514.237565986}
mcu 'mcu': got {'oid': 31, 'next_clock': 2324573568, 'value': 6105, '#name': 'analog_in_state', '#sent_time': 1514.114842079, '#receive_time': 1514.287550912}
mcu 'mcu': got {'oid': 19, 'next_clock': 2346173568, 'value': 31694, '#name': 'analog_in_state', '#sent_time': 1514.114842079, '#receive_time': 1514.467578578}
mcu 'mcu': got {'oid': 26, 'next_clock': 2354573568, 'value': 31542, '#name': 'analog_in_state', '#sent_time': 1514.114842079, '#receive_time': 1514.537589023}
mcu 'mcu': got {'oid': 31, 'next_clock': 2360573568, 'value': 6106, '#name': 'analog_in_state', '#sent_time': 1514.114842079, '#receive_time': 1514.58762456}
mcu 'mcu': got {'oid': 19, 'next_clock': 2382173568, 'value': 31690, '#name': 'analog_in_state', '#sent_time': 1514.114842079, '#receive_time': 1514.767796337}
mcu 'mcu': got {'oid': 26, 'next_clock': 2390573568, 'value': 31533, '#name': 'analog_in_state', '#sent_time': 1514.114842079, '#receive_time': 1514.8377048}
mcu 'mcu': got {'oid': 31, 'next_clock': 2396573568, 'value': 6101, '#name': 'analog_in_state', '#sent_time': 1514.114842079, '#receive_time': 1514.887651578}
mcu 'mcu': got {'oid': 19, 'next_clock': 2418173568, 'value': 31695, '#name': 'analog_in_state', '#sent_time': 1514.114842079, '#receive_time': 1515.067694837}
mcu 'mcu': got {'oid': 26, 'next_clock': 2426573568, 'value': 31535, '#name': 'analog_in_state', '#sent_time': 1515.099179504, '#receive_time': 1515.137685319}
mcu 'mcu': got {'oid': 31, 'next_clock': 2432573568, 'value': 6100, '#name': 'analog_in_state', '#sent_time': 1515.099179504, '#receive_time': 1515.187679041}
mcu 'mcu': got {'oid': 19, 'next_clock': 2454173568, 'value': 31693, '#name': 'analog_in_state', '#sent_time': 1515.099179504, '#receive_time': 1515.367700763}
mcu 'mcu': got {'oid': 26, 'next_clock': 2462573568, 'value': 31537, '#name': 'analog_in_state', '#sent_time': 1515.099179504, '#receive_time': 1515.437692485}
mcu 'mcu': got {'oid': 31, 'next_clock': 2468573568, 'value': 6103, '#name': 'analog_in_state', '#sent_time': 1515.099179504, '#receive_time': 1515.487688744}
mcu 'mcu': got {'oid': 19, 'next_clock': 2490173568, 'value': 31689, '#name': 'analog_in_state', '#sent_time': 1515.099179504, '#receive_time': 1515.667841004}
mcu 'mcu': got {'oid': 26, 'next_clock': 2498573568, 'value': 31535, '#name': 'analog_in_state', '#sent_time': 1515.099179504, '#receive_time': 1515.737726041}
mcu 'mcu': got {'oid': 31, 'next_clock': 2504573568, 'value': 6099, '#name': 'analog_in_state', '#sent_time': 1515.099179504, '#receive_time': 1515.787706263}
mcu 'mcu': got {'oid': 19, 'next_clock': 2526173568, 'value': 31690, '#name': 'analog_in_state', '#sent_time': 1515.099179504, '#receive_time': 1515.967747577}
mcu 'mcu': got {'oid': 26, 'next_clock': 2534573568, 'value': 31537, '#name': 'analog_in_state', '#sent_time': 1515.099179504, '#receive_time': 1516.037732818}
mcu 'mcu': got {'oid': 31, 'next_clock': 2540573568, 'value': 6102, '#name': 'analog_in_state', '#sent_time': 1516.083500151, '#receive_time': 1516.087694355}
mcu 'mcu': got {'oid': 19, 'next_clock': 2562173568, 'value': 31697, '#name': 'analog_in_state', '#sent_time': 1516.083500151, '#receive_time': 1516.267739485}
mcu 'mcu': got {'oid': 26, 'next_clock': 2570573568, 'value': 31534, '#name': 'analog_in_state', '#sent_time': 1516.083500151, '#receive_time': 1516.337746985}
mcu 'mcu': got {'oid': 31, 'next_clock': 2576573568, 'value': 6101, '#name': 'analog_in_state', '#sent_time': 1516.083500151, '#receive_time': 1516.38772567}
mcu 'mcu': got {'oid': 19, 'next_clock': 2598173568, 'value': 31689, '#name': 'analog_in_state', '#sent_time': 1516.083500151, '#receive_time': 1516.567778799}
mcu 'mcu': got {'oid': 26, 'next_clock': 2606573568, 'value': 31539, '#name': 'analog_in_state', '#sent_time': 1516.083500151, '#receive_time': 1516.637848818}
mcu 'mcu': got {'oid': 31, 'next_clock': 2612573568, 'value': 6106, '#name': 'analog_in_state', '#sent_time': 1516.083500151, '#receive_time': 1516.687737207}
mcu 'mcu': got {'oid': 19, 'next_clock': 2634173568, 'value': 31692, '#name': 'analog_in_state', '#sent_time': 1516.083500151, '#receive_time': 1516.867783614}
mcu 'mcu': got {'oid': 26, 'next_clock': 2642573568, 'value': 31536, '#name': 'analog_in_state', '#sent_time': 1516.083500151, '#receive_time': 1516.937783669}
mcu 'mcu': got {'oid': 31, 'next_clock': 2648573568, 'value': 6107, '#name': 'analog_in_state', '#sent_time': 1516.083500151, '#receive_time': 1516.987787299}
mcu 'mcu': got {'oid': 19, 'next_clock': 2670173568, 'value': 31694, '#name': 'analog_in_state', '#sent_time': 1517.06834341, '#receive_time': 1517.167805818}
mcu 'mcu': got {'oid': 26, 'next_clock': 2678573568, 'value': 31531, '#name': 'analog_in_state', '#sent_time': 1517.06834341, '#receive_time': 1517.237831706}
mcu 'mcu': got {'oid': 31, 'next_clock': 2684573568, 'value': 6098, '#name': 'analog_in_state', '#sent_time': 1517.06834341, '#receive_time': 1517.287844299}
mcu 'mcu': got {'oid': 19, 'next_clock': 2706173568, 'value': 31696, '#name': 'analog_in_state', '#sent_time': 1517.06834341, '#receive_time': 1517.46779354}
mcu 'mcu': got {'oid': 26, 'next_clock': 2714573568, 'value': 31536, '#name': 'analog_in_state', '#sent_time': 1517.06834341, '#receive_time': 1517.537792965}
mcu 'mcu': got {'oid': 31, 'next_clock': 2720573568, 'value': 6102, '#name': 'analog_in_state', '#sent_time': 1517.06834341, '#receive_time': 1517.587842539}
mcu 'mcu': got {'oid': 19, 'next_clock': 2742173568, 'value': 31695, '#name': 'analog_in_state', '#sent_time': 1517.06834341, '#receive_time': 1517.767809984}
mcu 'mcu': got {'oid': 26, 'next_clock': 2750573568, 'value': 31531, '#name': 'analog_in_state', '#sent_time': 1517.06834341, '#receive_time': 1517.837831613}
mcu 'mcu': got {'oid': 31, 'next_clock': 2756573568, 'value': 6098, '#name': 'analog_in_state', '#sent_time': 1517.06834341, '#receive_time': 1517.887809058}
mcu 'mcu': got {'oid': 19, 'next_clock': 2778173568, 'value': 31692, '#name': 'analog_in_state', '#sent_time': 1518.053474854, '#receive_time': 1518.067798261}
mcu 'mcu': got {'oid': 26, 'next_clock': 2786573568, 'value': 31531, '#name': 'analog_in_state', '#sent_time': 1518.053474854, '#receive_time': 1518.137818521}
mcu 'mcu': got {'oid': 31, 'next_clock': 2792573568, 'value': 6103, '#name': 'analog_in_state', '#sent_time': 1518.053474854, '#receive_time': 1518.187823428}
mcu 'mcu': got {'oid': 19, 'next_clock': 2814173568, 'value': 31696, '#name': 'analog_in_state', '#sent_time': 1518.053474854, '#receive_time': 1518.367835076}
mcu 'mcu': got {'oid': 26, 'next_clock': 2822573568, 'value': 31534, '#name': 'analog_in_state', '#sent_time': 1518.053474854, '#receive_time': 1518.43782602}
mcu 'mcu': got {'oid': 31, 'next_clock': 2828573568, 'value': 6105, '#name': 'analog_in_state', '#sent_time': 1518.053474854, '#receive_time': 1518.487831483}
mcu 'mcu': got {'oid': 19, 'next_clock': 2850173568, 'value': 31687, '#name': 'analog_in_state', '#sent_time': 1518.053474854, '#receive_time': 1518.667956576}
mcu 'mcu': got {'oid': 26, 'next_clock': 2858573568, 'value': 31534, '#name': 'analog_in_state', '#sent_time': 1518.053474854, '#receive_time': 1518.737844687}
mcu 'mcu': got {'oid': 31, 'next_clock': 2864573568, 'value': 6099, '#name': 'analog_in_state', '#sent_time': 1518.053474854, '#receive_time': 1518.787845946}
mcu 'mcu': got {'oid': 19, 'next_clock': 2886173568, 'value': 31689, '#name': 'analog_in_state', '#sent_time': 1518.053474854, '#receive_time': 1518.967824705}
mcu 'mcu': got {'oid': 26, 'next_clock': 2894573568, 'value': 31533, '#name': 'analog_in_state', '#sent_time': 1518.053474854, '#receive_time': 1519.037848724}
mcu 'mcu': got {'oid': 31, 'next_clock': 2900573568, 'value': 6105, '#name': 'analog_in_state', '#sent_time': 1519.039143687, '#receive_time': 1519.087856539}
MCU 'rpi' shutdown: Force shutdown command
clocksync state: mcu_freq=50000000 last_clock=422783438 clock_est=(1512.986 146149943 49996926.723) min_half_rtt=0.000055 min_rtt_time=1512.609 time_avg=1512.986(2.798) clock_avg=146149943.561(139897081.961) pred_variance=1510793342.084 clock_adj=(1518.092 49991172.750)
Dumping serial stats: bytes_write=813 bytes_read=4538 bytes_retransmit=0 bytes_invalid=0 send_seq=112 receive_seq=112 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0
Dumping send queue 96 messages
Sent 0 1512.146254 1512.146254 8: seq: 10, identify offset=0 count=40
Sent 1 1512.146986 1512.146986 8: seq: 11, identify offset=40 count=40
Sent 2 1512.147376 1512.147376 8: seq: 12, identify offset=80 count=40
Sent 3 1512.147740 1512.147740 9: seq: 13, identify offset=120 count=40
Sent 4 1512.148257 1512.148257 9: seq: 14, identify offset=160 count=40
Sent 5 1512.148625 1512.148625 9: seq: 15, identify offset=200 count=40
Sent 6 1512.148986 1512.148986 9: seq: 16, identify offset=240 count=40
Sent 7 1512.149344 1512.149344 9: seq: 17, identify offset=280 count=40
Sent 8 1512.149700 1512.149700 9: seq: 18, identify offset=320 count=40
Sent 9 1512.150050 1512.150050 9: seq: 19, identify offset=360 count=40
Sent 10 1512.150399 1512.150399 9: seq: 1a, identify offset=400 count=40
Sent 11 1512.150745 1512.150745 9: seq: 1b, identify offset=440 count=40
Sent 12 1512.151123 1512.151123 9: seq: 1c, identify offset=480 count=40
Sent 13 1512.151470 1512.151470 9: seq: 1d, identify offset=520 count=40
Sent 14 1512.151814 1512.151814 9: seq: 1e, identify offset=560 count=40
Sent 15 1512.152165 1512.152165 9: seq: 1f, identify offset=600 count=40
Sent 16 1512.152515 1512.152515 9: seq: 10, identify offset=640 count=40
Sent 17 1512.152862 1512.152862 9: seq: 11, identify offset=680 count=40
Sent 18 1512.153206 1512.153206 9: seq: 12, identify offset=720 count=40
Sent 19 1512.153552 1512.153552 9: seq: 13, identify offset=760 count=40
Sent 20 1512.153899 1512.153899 9: seq: 14, identify offset=800 count=40
Sent 21 1512.154270 1512.154270 9: seq: 15, identify offset=840 count=40
Sent 22 1512.154620 1512.154620 9: seq: 16, identify offset=880 count=40
Sent 23 1512.154999 1512.154999 9: seq: 17, identify offset=920 count=40
Sent 24 1512.155355 1512.155355 9: seq: 18, identify offset=960 count=40
Sent 25 1512.155709 1512.155709 9: seq: 19, identify offset=1000 count=40
Sent 26 1512.156056 1512.156056 9: seq: 1a, identify offset=1040 count=40
Sent 27 1512.156403 1512.156403 9: seq: 1b, identify offset=1080 count=40
Sent 28 1512.156747 1512.156747 9: seq: 1c, identify offset=1120 count=40
Sent 29 1512.157099 1512.157099 9: seq: 1d, identify offset=1160 count=40
Sent 30 1512.157448 1512.157448 9: seq: 1e, identify offset=1200 count=40
Sent 31 1512.157791 1512.157791 9: seq: 1f, identify offset=1240 count=40
Sent 32 1512.158130 1512.158130 9: seq: 10, identify offset=1280 count=40
Sent 33 1512.158476 1512.158476 9: seq: 11, identify offset=1320 count=40
Sent 34 1512.158835 1512.158835 9: seq: 12, identify offset=1360 count=40
Sent 35 1512.159190 1512.159190 9: seq: 13, identify offset=1400 count=40
Sent 36 1512.159540 1512.159540 9: seq: 14, identify offset=1440 count=40
Sent 37 1512.159888 1512.159888 9: seq: 15, identify offset=1480 count=40
Sent 38 1512.160231 1512.160231 9: seq: 16, identify offset=1520 count=40
Sent 39 1512.160568 1512.160568 9: seq: 17, identify offset=1560 count=40
Sent 40 1512.160907 1512.160907 9: seq: 18, identify offset=1600 count=40
Sent 41 1512.161248 1512.161248 9: seq: 19, identify offset=1640 count=40
Sent 42 1512.161585 1512.161585 9: seq: 1a, identify offset=1680 count=40
Sent 43 1512.161923 1512.161923 9: seq: 1b, identify offset=1720 count=40
Sent 44 1512.162270 1512.162270 9: seq: 1c, identify offset=1760 count=40
Sent 45 1512.162616 1512.162616 9: seq: 1d, identify offset=1800 count=40
Sent 46 1512.163051 1512.163051 9: seq: 1e, identify offset=1840 count=40
Sent 47 1512.163410 1512.163410 9: seq: 1f, identify offset=1880 count=40
Sent 48 1512.163760 1512.163760 9: seq: 10, identify offset=1920 count=40
Sent 49 1512.164103 1512.164103 9: seq: 11, identify offset=1960 count=40
Sent 50 1512.164450 1512.164450 9: seq: 12, identify offset=2000 count=40
Sent 51 1512.164794 1512.164794 9: seq: 13, identify offset=2040 count=40
Sent 52 1512.165141 1512.165141 9: seq: 14, identify offset=2080 count=40
Sent 53 1512.165488 1512.165488 9: seq: 15, identify offset=2120 count=40
Sent 54 1512.165831 1512.165831 9: seq: 16, identify offset=2160 count=40
Sent 55 1512.166174 1512.166174 9: seq: 17, identify offset=2200 count=40
Sent 56 1512.166558 1512.166558 9: seq: 18, identify offset=2240 count=40
Sent 57 1512.166928 1512.166928 9: seq: 19, identify offset=2280 count=40
Sent 58 1512.167282 1512.167282 9: seq: 1a, identify offset=2320 count=40
Sent 59 1512.167624 1512.167624 9: seq: 1b, identify offset=2360 count=40
Sent 60 1512.167963 1512.167963 9: seq: 1c, identify offset=2400 count=40
Sent 61 1512.168298 1512.168298 9: seq: 1d, identify offset=2440 count=40
Sent 62 1512.168638 1512.168638 9: seq: 1e, identify offset=2480 count=40
Sent 63 1512.168978 1512.168978 9: seq: 1f, identify offset=2520 count=40
Sent 64 1512.169321 1512.169321 9: seq: 10, identify offset=2560 count=40
Sent 65 1512.169661 1512.169661 9: seq: 11, identify offset=2600 count=40
Sent 66 1512.169999 1512.169999 9: seq: 12, identify offset=2640 count=40
Sent 67 1512.170338 1512.170338 9: seq: 13, identify offset=2680 count=40
Sent 68 1512.170690 1512.170690 9: seq: 14, identify offset=2720 count=40
Sent 69 1512.171080 1512.171080 9: seq: 15, identify offset=2760 count=40
Sent 70 1512.171434 1512.171434 9: seq: 16, identify offset=2800 count=40
Sent 71 1512.171779 1512.171779 9: seq: 17, identify offset=2840 count=40
Sent 72 1512.172119 1512.172119 9: seq: 18, identify offset=2880 count=40
Sent 73 1512.172458 1512.172458 9: seq: 19, identify offset=2920 count=40
Sent 74 1512.172804 1512.172804 9: seq: 1a, identify offset=2960 count=40
Sent 75 1512.173148 1512.173148 9: seq: 1b, identify offset=3000 count=40
Sent 76 1512.173486 1512.173486 9: seq: 1c, identify offset=3040 count=40
Sent 77 1512.173827 1512.173827 9: seq: 1d, identify offset=3080 count=40
Sent 78 1512.174164 1512.174164 9: seq: 1e, identify offset=3120 count=40
Sent 79 1512.174502 1512.174502 9: seq: 1f, identify offset=3143 count=40
Sent 80 1512.202707 1512.202707 6: seq: 10, get_uptime
Sent 81 1512.253969 1512.253969 6: seq: 11, get_clock
Sent 82 1512.304871 1512.304871 6: seq: 12, get_clock
Sent 83 1512.355536 1512.355536 6: seq: 13, get_clock
Sent 84 1512.406174 1512.406174 6: seq: 14, get_clock
Sent 85 1512.456804 1512.456804 6: seq: 15, get_clock
Sent 86 1512.507452 1512.507452 6: seq: 16, get_clock
Sent 87 1512.558660 1512.558660 6: seq: 17, get_clock
Sent 88 1512.609341 1512.609341 6: seq: 18, get_clock
Sent 89 1512.610890 1512.610890 6: seq: 19, get_clock
Sent 90 1513.595291 1513.595291 6: seq: 1a, get_clock
Sent 91 1514.579931 1514.579931 6: seq: 1b, get_clock
Sent 92 1515.564524 1515.564524 6: seq: 1c, get_clock
Sent 93 1516.549517 1516.549517 6: seq: 1d, get_clock
Sent 94 1517.534243 1517.534243 6: seq: 1e, get_clock
Sent 95 1518.518714 1518.518714 6: seq: 1f, get_clock
Dumping receive queue 99 messages
Receive: 0 1512.145576 0.000000 6: seq: 10, starting
Receive: 1 1512.146405 1512.146254 48: seq: 11, identify_response offset=0 data=b'x\xda\xa5\x1ako\xdc6\xf2\xaf\xf0\x04\x14m\xee\x1cw\xf5\xdc\x07\x90\x0f\x8e\x9b\x16E\xeb6\xad\x13\xdc\x01\x87B\x90%\xee.\x11\xbd'
Receive: 2 1512.147101 1512.146986 48: seq: 12, identify_response offset=40 data=b'*J~\\\x91\xff~3\x1c\xbe\xa4]\xa7\xb9\xab\xbf\xac\xc8\x99!\x87\xc3y\xd3\x7f\x04w\x93\xa8\xab\xfc\x9e\x0fRt\xad\x0cv\xc1\xa1'
Receive: 3 1512.147478 1512.147376 48: seq: 13, identify_response offset=80 data=b",w\xec\xab_\x0b\xd9\xdf\x89\xa2e\xe1\xea2\xba\x0c_f\xff\x18z\x11\xbe\xd0C\x16\xad\xa2p\x15\x86+v'\xdai\x14\xb5\x04\x92"
Receive: 4 1512.147960 1512.147740 49: seq: 14, identify_response offset=120 data=b'\xef~z\xcf^\xeb!\xdbw\x033k\xbc`\xd1e\x9c^F\xc1EPvMS\xb4\x15\xec\xf3GP\xd4uW\x16#\xcf;QI'
Receive: 5 1512.148366 1512.148257 49: seq: 15, identify_response offset=160 data=b'VvS;\xbe\xfa\xa2\x0cv\x9b\x0b`j\x1c\x81\x9b\xbc(?0\x80\xc2\xb4\x07O\xd6\x1eBU\x19\x84\xbe\x93\xeaG\xb4\xaf\xbe\x98X'
Receive: 6 1512.148726 1512.148625 49: seq: 16, identify_response offset=200 data=b'?\xd5u>\xf5D\xb0u\x04\xbfO|x\xb2k\x02\x03\x1f\x10{\xe0r\xccGQ~\x904\x1a\x87\xa2\x95\x8d\x18s\xb3+\x13-\x88'
Receive: 7 1512.149089 1512.148986 49: seq: 17, identify_response offset=240 data=b'H\xef\x0f\x0c\x965/\x86\\\x1e\xa7\xb1\xea\x1e\xda`\x17\xe1\xd1\xda\xbd8\x00G\x8fu\x9c\xa4f\x0b\xd9\x8b\x9c>\x83\xddz\xe5\xb0\xda'
Receive: 8 1512.149445 1512.149344 49: seq: 18, identify_response offset=280 data=b'\xa2\xee\x0e\xb9h-\xf7\x8a\xed`\x17\xbb\x954\xcb\x06\x83\x86\xb9\x93C\xea\x96S\x93|\x98/6\x93A\xba\xb6\xc8\x958\x88\xb1\xa8\xf3'
Receive: 9 1512.149801 1512.149700 49: seq: 19, identify_response offset=320 data=b"n\x1a\x17\x04\xf7E=q\x1cW|_L\xf5\x98\xdb\x89\xa6x\xcc\xabi(FP\x12\xc5g\xe8\xad'\xc3\xcd]\xb4\xb2'\xe6\x83("
Receive: 10 1512.150153 1512.150050 49: seq: 1a, identify_response offset=360 data=b'\xeaW_\xfc]**>\x0c\xdd\xe0q\xbdq\x07\xe4\xa0\x08c\xd7\xcf\x98(g\\G\x99E>VI\xb2\xde\xd8]\x06\x99k\xa6\xb9'
Receive: 11 1512.150500 1512.150399 49: seq: 1b, identify_response offset=400 data=b'\xf9\xa8\x12\xfb\x95\xda\xaf\xcc~\xad\xed\x17\xaf\x8b\'{\xdb\xc1.\x8b\xed&"*\x99\xb9\xad\xc4M7\xfd\xb4\x8dR\xbb7`\xb9;u'
Receive: 12 1512.150870 1512.150745 49: seq: 1c, identify_response offset=440 data=b'\x1c\xb6\xbc\xeb\xc5#\xaf\x17B\xad\x8a\xb1\xc8\xa5\xf8\x0f\xc8\xf18\x81\xbd\x8c9\x8a\xc5S6\xc9aJ\xb4\x1eGij\x17\xed\xcbb\x9b'
Receive: 13 1512.151226 1512.151123 49: seq: 1d, identify_response offset=480 data=b"mR\xa7\x04J\xc9A\xed\x07\xa5\xc0\xc7\xa2my\xad>\x9f@'\xdd\xb2\xfa\xe6\x8e\xd3\xf2.a\xe6\xe427N\x93\xfa\x87\xe6\x8cb"
Receive: 14 1512.151568 1512.151470 49: seq: 1e, identify_response offset=520 data=b"\xfc\x95\xc5\x13'!uV\x90\x99\xd3\x1d0\x8f\xe5Vh\xf5\xa3\xb8\xe7\xf9Q\x1c\x8eJ\xc6\xf1\xc6\xc7\x07\xdb9\xd4\xfc\xd4\xbe\x98\x85\xe5"
Receive: 15 1512.151914 1512.151814 49: seq: 1f, identify_response offset=560 data=b'\xe3S\xcf\xe9v\xe2\x19\xa5\xb1\xd7s\xc4\x1a\x947\xf2\x80\xba\x0b\xbb\xcei\x1f\xc4x\x04\xc1\xe4\xa5\xb4\x1a\x12{\xe7\x18\xd7[g\x02\xa5'
Receive: 16 1512.152265 1512.152165 49: seq: 10, identify_response offset=600 data=b"UNY\xd6\x1f\xec\xb7\xa8\xec\xe7S[\xe6s=deS\xe5'\xaa\xb9\xf2v\xe0}\xefL\x1c\x87\xb9\xb6\x98J\x0c\xe6\x93\xdc\x94B"
Receive: 17 1512.152614 1512.152515 49: seq: 11, identify_response offset=640 data=b"vXS-\xb9\xb7h\xe4\x0e6\x1e\xf9\xd0t`\x9c\xfdY\x89\xfa`'\xd4\xcc\x1d{l\xca\xa9\x18\xac\xb6\x0c\x8f\xf9\x89\xeba\xa3\x9d"
Receive: 18 1512.152963 1512.152862 49: seq: 12, identify_response offset=680 data=b'D\xdd\x1fE\xc3I\xc7\x9d\x1f\x18\x07\x94\x87\x13+\x1c\xba\xe2w\x13XT\xd7\x07\xbb\xad\x19\xc1*\x07eMt?\xa1E\x1bx\x01Q'
Receive: 19 1512.153306 1512.153206 49: seq: 13, identify_response offset=720 data=b'`\xa8\xf8\xe0l\x03]Td\x10\x1e\x061\xf2\x13\x0cTcB\x0c/\x02\xde\xf0\xe1\xc0\xdb\xf2)G\x97\x04L\xc0\x14\xb9\xa7\xfc\xd85'
Receive: 20 1512.153651 1512.153552 49: seq: 14, identify_response offset=760 data=b'\xfc$b\xc8\xa2\xe9}\x93\xd0c\x1b/\xe6\x11\x05Xw\xbe\x94\x8eke<\x88\xc3\x81\x0fx\x08\x89\x16\x83^/u\x9b\xabx\x05<'
Receive: 21 1512.154015 1512.153899 49: seq: 15, identify_response offset=800 data=b'\x15#\xb7\x02\x8a\x92\x8b`/ \x82\x80S\xc9I\x86\xac\x1cJ\xd2\x98\x8b\xe0\x00\xfeD\xf1\tB\xd6#\x85\x03\xe6@\xc3\xa9\xc7[\x00'
Receive: 22 1512.154370 1512.154270 49: seq: 16, identify_response offset=840 data=b'\xcb\xbc\x08\xb4W\xcd%\xec\x97\x83\x06\xdah\x83\xdf$\xe7,Z\xa0\xe1\x15\x184w\x1d\x19\x08\x11\x1dc\xd3Ub\xff\x94\xc3]\xdb\xb5'
Receive: 23 1512.154720 1512.154620 49: seq: 17, identify_response offset=880 data=b'\x06\xaeL\x8a\xe9\xa0\t\x1c T[\xd9\x96\xc8\xe8\x0e\xe7\xf88\x97\xd7\\\xbb\x91\x15!*\xf2I\xfa\xbeX9E\xf0\xa4 #\xfc\xc5'
Receive: 24 1512.155101 1512.154999 49: seq: 18, identify_response offset=920 data=b'\xeb\xe5\x92t=\x89\x1c\x95\xec\xf6\xe3C1p\x9f\x1c\xec\xd3\xdadU\x98\xcfs+e)\xad\xa4uiy\xfc\x04\x8f_\xf1v\x84\xc3'
Receive: 25 1512.155456 1512.155355 49: seq: 19, identify_response offset=960 data=b'\xb3n\xbf\x87\r\x95Q\xdb\xb8\x07p\x13 \x94\x18\xedm\xa6\xb1\x07\x99\xfa\xca\xdd4\xa54\xc7\xc9\xdb&\x85;#\x95X\xe4\x19\xe7S'
Receive: 26 1512.155809 1512.155709 49: seq: 1a, identify_response offset=1000 data=b"\x19`{\xbb P\xba49'\x96m,\xc22'\xf9?\x95\xbdq\xca\xae\xe3\x81\x1bA^u\x00\xc2#/?x9A\x1c\x1a\x1e"
Receive: 27 1512.156155 1512.156056 49: seq: 1b, identify_response offset=1040 data=b'\x16\x89\x8c\xe5\xa0\xef\xc0\x9f,\xf7\xf7\x02ff\x16X$#\xcfdx\x1e\x8b\xc2\xe7P@,\xb4\xbc,\xa2\xfes\x12^\xa7\x0b\x82\xa5'
Receive: 28 1512.156502 1512.156403 49: seq: 1c, identify_response offset=1080 data=b'\x84\xd7\xf6\xceN\xa2\xd73\xec\xa1yB\xb0\x12{\x12\xcf:2\x0b\x9c\xf3\xd7\x7f~\xc4\xd9%\xd0\x00\xe2\x04\xb8\x8f\xca\xbb\x83\x8cD8'
Receive: 29 1512.156847 1512.156747 49: seq: 1d, identify_response offset=1120 data=b'\xf1s\xf9\xa1\xdd\xa3\xf3\xd3\x9405$:K9Kb/\x1f\x0e\xb2\xb5\x04\xf34\xe3\x1crbW\xc7(f\xed\x1d\xd5\x83\x1c\xb71'
Receive: 30 1512.157199 1512.157099 49: seq: 1e, identify_response offset=1160 data=b'\xae\xa32T\xf8\x85\xdb\x8b@T\x94Q\xa9\xd0\xa7\xd6]n\x02X\xe0K\x10\xc7?\xe9"\x05\x86\xd3\xc5\'H\x8am\x95\x0b\xd95g'
Receive: 31 1512.157547 1512.157448 49: seq: 1f, identify_response offset=1200 data=b'\x89\x11\x10eD\xd4\xf2G\xcd\x02\x04g\xeb-\xc4@\xfe;$$_j\xff{b\x07\xe2\xdc\xe8u\xb40\xff$Y\x03\x91\x82&z'
Receive: 32 1512.157889 1512.157791 49: seq: 10, identify_response offset=1240 data=b'Y\x12\x169{gl\xce\xcb\xacC\xc2\xf3\xfc\x94\x07\x8d\x13\x03\x9dyb\x9c\xd2\x9e\x18b\x00\xf7\xfc(\x90d\x8e\xe4\x9c\x1bn\x84\xec'
Receive: 33 1512.158229 1512.158130 49: seq: 11, identify_response offset=1280 data=b"\x8c\xf3m:)\xce\xa5O'\x8bf\x9a\x8f\xe7\xcf\x11\x83\nQf\xf6\xa9\x00\x97n\xe7X\xe7\xe3[\x8a\xc2\xa6\x1c,\xc7 \n\xbeY"
Receive: 34 1512.158575 1512.158476 49: seq: 12, identify_response offset=1320 data=b'`\x8ek\xcd<\xdc:\x04\x15\xba\xd1V(\xb83\x1b\xeb\xbd\xc8\x0f\x14\xb0\xa4\xce\xa0f\xa2V!\xc6F@\n\x12p#\x9a\x1ae\x88'
Receive: 35 1512.158937 1512.158835 49: seq: 13, identify_response offset=1360 data=b'\x0e\xe2\x8c\xf9\x80jm\x1c\xde\xe8gf\xbc\xef\x06\x9d\x16\x90\xafPc\xab$\xfc\xb1\x17p%~\x12\xb2\xb5+-N\xe1#AFA'
Receive: 36 1512.159290 1512.159190 49: seq: 14, identify_response offset=1400 data=b'!\xeb\x9c\xd7\xf0l)\xf9h\xb2=\xac\xfc\xaf\xbe\xb9\xceo\xae\xfe\x85A}\x0bWt\xfd\xe3\xcf\xd7?\xe4\xdf\xfe\xfa\xe6\x17,j\xe9'
Receive: 37 1512.159641 1512.159540 49: seq: 15, identify_response offset=1440 data=b'\xef"\xb8\xb9~\x1f\xec\x82Z\xb4\xd3cp\x11\xbc\xbd\xbeR\xb6b\xc8@\xa1\xde\xfe\xf3\x86\x86q\xb4\xc6(v\xfb\xee\xea\xddm~\xfb'
Receive: 38 1512.159987 1512.159888 49: seq: 16, identify_response offset=1480 data=b'\xfe\xe6\xf6\x97\xfc\xf5\xd5\xed\x1bL\xa4\xb2\x8f\x98JM\x90\xdc\xa9\x82D\xf5\x1dt\xca\xa0?/W\xc1\xee\xdf\xab\x8b\xf5o\x80\t\x9a\xa6'
Receive: 39 1512.160329 1512.160231 49: seq: 17, identify_response offset=1520 data=b'\x1a\x13*\x10\xe2\xbc\xdah\xf3\x1b\xa4M\xbd\xe8\x081\xda\x98qy\x14\xfd\xea\xeb\xe7 \xa1\x85\xc0\xfc\x02\x16YX\n\xf5\xe3\x1c\x16['
Receive: 40 1512.160667 1512.160568 49: seq: 18, identify_response offset=1560 data=b'\xd8\x06\x14|\x0eK,,\x0c!\x7f\x9e\x03S\x07L\x92%7\x99\x03\xae\xa3%;k\xc7\xea*\\\xf2\xb3q\xc0xe\x18\x02\x8fC'
Receive: 41 1512.161006 1512.160907 49: seq: 19, identify_response offset=1600 data=b'\xa7\x87\x0f\x04ei\n&\x1ef\x0e\x14z `\xd5\x07E\x1e\x08\xee\xcd\x07\xc5\x1eh\x93\xcc@\x89\x03e\xa0\x1e>(\xf5@\xe1\x9c'
Receive: 42 1512.161346 1512.161248 49: seq: 1a, identify_response offset=1640 data=b'\x8d\xcc\x03\xc5s6\xd6\x1e(Ql|\x9cyG(w\x942\x84q\x1c\x07;P\xc8B\xa6\xabd]\xa9Tn\xacy\xba\n\xa3;'
Receive: 43 1512.161685 1512.161585 49: seq: 1b, identify_response offset=1680 data=b'\xd01M\xa55\n>+~\xbf\xd2Z\xa5\xf6\xa3\xa9PM\x81F\xfa\x93\x91\x9aL\xc3\xc8\x9f\x8c\xd5\xe4\xda\x88\x86&\x135\x19\xae\xa2'
Receive: 44 1512.162022 1512.161923 49: seq: 1c, identify_response offset=1720 data=b'\xc4\x9fMi6\xda\xcc\xb6\xcah\xd6^\t\xcd\xaei\x16\xfc\x9c9+\xa4)\x02\xfd\xc4\x00\x85U.*m\x99LY\xf0\x9eR5j'
Receive: 45 1512.162370 1512.162270 49: seq: 1d, identify_response offset=1760 data=b'\xc1\\\xd55\xd3\x06h"\x93d\xcd$Gv,\xee9\x96\x89\x98\x92q?\xf2P{\xea\xaaF\x0f\xf6\xc4L\xb5RQX\xbd.Z'
Receive: 46 1512.162715 1512.162616 49: seq: 1e, identify_response offset=1800 data=b'\xd6v#\x03W\xc60\x1c0\xb8\t"f\x8a\x98=\x1c\x05|\x93g\x91\xac\x07\xdf\x08,R\xdc\x06\xda/G\x8c\x93PO\x1f`U'
Receive: 47 1512.163154 1512.163051 49: seq: 1f, identify_response offset=1840 data=b'\xd8\xbd\x18\x99\x90\xac\xd0{Q\xf7\x80\xaa(\x8d,\x11\x15\xbd\x12\xd5z4\xab\xd2\x04\x95j\xc1v\xbce\xa6\xc0\xb6\xf4\x90J\\S\xbb'
Receive: 48 1512.163511 1512.163410 49: seq: 10, identify_response offset=1880 data=b'\x92\xf5\xc5 \x01\xa4zY\xaa\x8c2\x80\x81C\x8a"G\xd5\xb4\xbc\xee\xa6\xba\xa2s)\xd7\xfb\xcdm\xb8y\r\xa9(\xb2\x05\xc4\xe3\x11'
Receive: 49 1512.163858 1512.163760 49: seq: 11, identify_response offset=1920 data=b"?\xa8'\xf1Y\xa8\xec+\xf0\x98\x15d<b|AY\xe4g\x925\xd3\xc8\x1f-\x1d\x88\xc1\xe0\xcdo\x16\xdb\x91\x06\x02\xe1Gv\x03"
Receive: 50 1512.164202 1512.164103 49: seq: 12, identify_response offset=1960 data=b'd(\x95\x16MO[3\xaa\x14\xb1\x8ax\x83\x87g\x10\xfaF\xac\xc3\x9b\x0e\xd8\xe8Z\xa1\x83\x8f\xc6\xc3L\x95\xf0 0\x92\x1bet'
Receive: 51 1512.164549 1512.164450 49: seq: 13, identify_response offset=2000 data=b'\xea\xd4\xae\x80c\\a\xbe5%\x1d\xdfvC\xc9m/\x86\xe9n1\xf5\xe2\xbe{\xfb\xfd\xcf\x0c\r\x97\x812\x0b@C9\xec!\x05'
Receive: 52 1512.164894 1512.164794 49: seq: 14, identify_response offset=2040 data=b'\xac\xa8\x88\xf9\x9eRZo]\xecC2Q]`\xa2\xa8\xe5\xd6\x81.\xa9\xde\xb4\xe6\x82\x1ax\x9f UZ\x8e\x94p\x17c\x01\x02\xf9'
Receive: 53 1512.165241 1512.165141 49: seq: 15, identify_response offset=2080 data=b'\xf2\xeb/\xa9\x83e\x88L\x9b\xd6u\x8d)1\xa5\xb2\xc6`\xd9\xa3\xa4\xfe\x1c\xa0\xa1n\x81\xed@VK\x9d\x19\x03l:\xb0,\xad^'
Receive: 54 1512.165587 1512.165488 49: seq: 16, identify_response offset=2120 data=b'\x0c\xdb\x87\x18E\x1d\xd86\x1bm{\x91\xb2\xac\x13\xb8\xae(\xed\xfe\xb1\xc7\x00X\x04#?\x87\xbd\x123kZ\x8e\xda\xd2\x19HKE'
Receive: 55 1512.165931 1512.165831 49: seq: 17, identify_response offset=2160 data=b'r\xca\x1f\x97X\x06\xe4\xed\x8dM=\x13\xec\xa3\xf5l^\x97?\xea\x1ai\xe7\xc4\x13\xd2\xac\xbc\xf1p\xb0IpS<\xa2\xeen\x8c\xbc'
Receive: 56 1512.166300 1512.166174 49: seq: 18, identify_response offset=2200 data=b'\xa9Aw\x03\xe5yq\xe0\x8c\xb7%\xa4\x87\xc6@\x81\x97\x1b!%\x87-\xa1\xd4\xac\xa6\x1a\xf5\r\x881+g:QQ\xc6\xc0\xef9'
Receive: 57 1512.166657 1512.166558 49: seq: 19, identify_response offset=2240 data=b'^\x14&\xe4\xcf\x13\x1c\x8b\xa1R\x1eJcc\x7f\xeayl#\x17\x8d\x8c\x8f\x157x\x95\xaa\x94a\xf05\xec\xeb\xee\x81\x8a\xa7_\xb9'
Receive: 58 1512.167032 1512.166928 49: seq: 1a, identify_response offset=2280 data=b"^\x00\x96B\x03\x1a\x94\xc5\x817\xed\x0b\xf4)\xd8\xbc\xb8\xb5\x08'|\xb3\x07\x01~\x99?\x96\x1c\xa0~\xdb\x95rQG9c\xe9\x13"
Receive: 59 1512.167383 1512.167282 49: seq: 1b, identify_response offset=2320 data=b'TXqyT\xe6\xc4\x9f\xa0\xc0$\xf1\x96\x8f\xfaN\x14\xdb\x88!\x9a\xa91s\xc6\x16\xf0,\xd6\xae\xb1\x11\x04\x8b)\xbf\xab\xdc\x99\xff'
Receive: 60 1512.167723 1512.167624 49: seq: 1c, identify_response offset=2360 data=b'\x90r\xab\x1d\xf1\xd8ul_(\x99\x90<\xb0\xef\xf5\xceW\x11\xed\xf7T\x0b\x9a\xda\xc4\xef\x94\x14\x91\x12\xdc\x92\xe4\xaa\x8f\xf7\x0eF\xa0'
Receive: 61 1512.168061 1512.167963 49: seq: 1d, identify_response offset=2400 data=b'\xfbO\xd8+\xd2\xbeC\xd2\xa3\x90\x85\xa0\xc6Z\x08f\xfa\xef\xdb\xe2\x0e\xa3Q\xa7\x15YI\x830\xa8\xd5\xe5\x10@\x13\xe0bq\x05H'
Receive: 62 1512.168396 1512.168298 49: seq: 1e, identify_response offset=2440 data=b'\x98\xc6\x9a\x1a:\x0e\xac<\xce\xd2wQ\x13u\x81TT\xa5\x03\xafN\xc1:\x16\xd8Hlp\x93\xcd\t\xae;)\x95IK\xb0\xcf\x11'
Receive: 63 1512.168737 1512.168638 49: seq: 1f, identify_response offset=2480 data=b'h/\xa7\xf6\xd6\x02\x0b\x15\xed\x04-;As\xb2\xa3W&\x07V\xd1h\xc6J\xe4\x831\xfc\xde\xbe\xfd^\x15v\xd4\xd9:\x85\xc9\x9e'
Receive: 64 1512.169078 1512.168978 49: seq: 10, identify_response offset=2520 data=b'c\xd2\x90\xa6K`\xdb\xb5/\xef0\xf2(\xdb[p1cR;@#5\xed\xaf\xd2\xd9\x1dRS\x0f\x97\xee\x05\xb5\xa65\x8c\x00\xb3'
Receive: 65 1512.169420 1512.169321 49: seq: 11, identify_response offset=2560 data=b'3\xc0\xed\xaa\x97\xcb\xbc<N\xed\x07P>HU*z\x10\xf3\xe6\xa5\x03\x007\xe4\xf5t\x90E\xa7\x0e\xc5\x96d\xa5d\xaa\xe2HV'
Receive: 66 1512.169760 1512.169661 49: seq: 12, identify_response offset=2600 data=b'\xf3\x17\x128O\ry\xcc=,@L\xa8\xf4\xc4\x9a\xc8\xf6\xa4\xd1\xbac?C>\x04e\xce\x1dVi{l\xb4\xcb\xbfQ1\xa8\xde'
Receive: 67 1512.170099 1512.169999 49: seq: 13, identify_response offset=2640 data=b"Vmj\xa4_\\+\xea\x9eKlW\xa2\x87'\xdfS\x02\x18AXVCR\xa6\x1e\xc3~\xba\xba\xfe\x81\x1e:L\xab_U\xc7h"
Receive: 68 1512.170437 1512.170338 49: seq: 14, identify_response offset=2680 data=b'`u1`\x16\x81\xdd\x803% Z59u|8\xd1I\x159A,|!\xfd<y\\\xc0\xfc\x13\xea\xb98\xdc\xa4\xa9J\xb8'
Receive: 69 1512.170802 1512.170690 49: seq: 15, identify_response offset=2720 data=b'\xf5 S\x197\r\xb2T\xb9\x08\x18d\xd9\x1a\xbe\xe3\x8f\x1fU\xc3\x07\xd2\x15\xc9\xe9UY\xb79\xfd*^b\x18mK\xbeh\xa6\xbe'
Receive: 70 1512.171183 1512.171080 49: seq: 16, identify_response offset=2760 data=b'D\x87r\xb6-\xea\x1aR\xba\xeff\xead\xea\xeb\xf8\xcb\xddM\xfb=\x07g\x86T{\xb1\xef\xf0\xb7\x16\xde\xdb16^^b2j'
Receive: 71 1512.171533 1512.171434 49: seq: 17, identify_response offset=2800 data=b'\xfb\xab\xb3v>-y\xae\x01\x86\xa5\xb1y\xb6\x9eQ\x14^\xf3\x94)\x88>\x0fF&J\xc7\\G`c\x1f\xcf\xc0S\xe9\x97\x00u'
Receive: 72 1512.171877 1512.171779 49: seq: 18, identify_response offset=2840 data=b"B\xf5`\x80sF\xb3T#\x06\x02\x94\xcf\xf8f\x8b\xd4\xaa'\xfb)\xae5\x85\xfe\xc8\xdd\xee/1\xfe\x9bW\x1a\tn\xda>\xbal"
Receive: 73 1512.172219 1512.172119 49: seq: 19, identify_response offset=2880 data=b'\xe1Nu\xb3\xd6\x80>%\x10A^\x9e\x16\xc5\xc6\x89y \x99qu\xec\x1a\xf0\x07\xa7\x8b\xf8\xef/\xb0u\xec\xde\x1cr\xa3<\xae\xbb'
Receive: 74 1512.172557 1512.172458 49: seq: 1a, identify_response offset=2920 data=b'Ac#R\xaf\xaf\xef\xe1\xda\x06?i\xd3%\xe2\xe2\x03\x85\x93&[\x96WZ\xa0\xa0r\xa6O\xfc9*\x8a\x91\xfcl_\xf9/\xa9'
Receive: 75 1512.172903 1512.172804 49: seq: 1b, identify_response offset=2960 data=b'\xe8tNEW\xde;\xc4\xfcF\xe4T\x96\xea\x1d\xa4D<\x10>H\xc1\x7f\x8a\xdb\xa23q\xc1\xdd\xbc\x1a\x9c\x17@\xeaW\xd9\x9fe'
Receive: 76 1512.173247 1512.173148 49: seq: 1c, identify_response offset=3000 data=b'\xa5\xa1O\xe1\xf5\xc9|\x02\xc4\x8b\xceu7O.\xd8\xef\x97\xfb7\x8d\xc9\xb7\xdfN\xfcS\xcd\x88T\t=\x8c\xaa\x8c\xd8\xc4TPK'
Receive: 77 1512.173585 1512.173486 49: seq: 1d, identify_response offset=3040 data=b'g\x0brj\xf4\x8f\xfc\x9dL1s\x1d\xc2E\xfb\x90\x9ez \xf6@u>\xf7\x8c\x9fa\x1b\x93\xb1\ru=\x99k*\x9e\x9e\x00\xdb'
Receive: 78 1512.173925 1512.173827 49: seq: 1e, identify_response offset=3080 data=b'\x89t\xda\xad\xdf(t\x16T\x16\xb6ky\xf6u\xd2\xf3,[\xe5\xf9U\x01MO\xf5\x93\xefv\xd6\xe0\x98\xf5\x7f\x15\x05\xbb\xe0~u'
Receive: 79 1512.174263 1512.174164 32: seq: 1f, identify_response offset=3120 data=b'\x19\x86\x97+\xf0\xb8\xab\x97\x87\xacJ6E\xb5\xdf\x06\x1f\xff\x0b\xde\x9c",'
Receive: 80 1512.174600 1512.174502 9: seq: 10, identify_response offset=3143 data=b''
Receive: 81 1512.202906 1512.202707 11: seq: 11, uptime high=0 clock=107003350
Receive: 82 1512.254110 1512.253969 10: seq: 12, clock clock=109563461
Receive: 83 1512.305021 1512.304871 10: seq: 13, clock clock=112108875
Receive: 84 1512.355661 1512.355536 10: seq: 14, clock clock=114640860
Receive: 85 1512.406294 1512.406174 10: seq: 15, clock clock=117172335
Receive: 86 1512.456938 1512.456804 10: seq: 16, clock clock=119704304
Receive: 87 1512.507579 1512.507452 10: seq: 17, clock clock=122236214
Receive: 88 1512.558807 1512.558660 10: seq: 18, clock clock=124797370
Receive: 89 1512.609452 1512.609341 10: seq: 19, clock clock=127329606
Receive: 90 1512.611009 1512.610890 10: seq: 1a, clock clock=127407354
Receive: 91 1513.595412 1513.595291 10: seq: 1b, clock clock=176624202
Receive: 92 1514.580123 1514.579931 11: seq: 1c, clock clock=225854916
Receive: 93 1515.063253 1514.579931 14: seq: 1c, stats count=143 sum=161200 sumsq=922602
Receive: 94 1515.564797 1515.564524 11: seq: 1d, clock clock=275083584
Receive: 95 1516.549802 1516.549517 11: seq: 1e, clock clock=324330469
Receive: 96 1517.534534 1517.534243 11: seq: 1f, clock clock=373563821
Receive: 97 1518.518992 1518.518714 11: seq: 10, clock clock=422783438
Receive: 98 1519.101552 1518.518714 12: seq: 10, shutdown clock=451905147 static_string_id=Force shutdown command
Transition to shutdown state: MCU 'rpi' shutdown: Force shutdown command
Dumping 13 requests for client 4122689744
Received 1511.508112: b'{"id": 3908705704, "method": "info", "params": {"client_info": {"program": "Moonraker", "version": "v0.8.0-247-g3008a13"}}}'
Received 1511.528294: b'{"id": 3909150104, "method": "list_endpoints", "params": {}}'
Received 1511.780566: b'{"id": 3908703112, "method": "info", "params": {}}'
Received 1512.032363: b'{"id": 3908702296, "method": "info", "params": {}}'
Received 1512.284185: b'{"id": 3908705128, "method": "info", "params": {}}'
Received 1512.535992: b'{"id": 3908705272, "method": "info", "params": {}}'
Received 1512.788074: b'{"id": 3909150104, "method": "info", "params": {}}'
Received 1512.789527: b'{"id": 3909150368, "method": "objects/subscribe", "params": {"objects": {"webhooks": null}, "response_template": {"method": "process_status_update"}}}'
Received 1512.790892: b'{"id": 3910072832, "method": "gcode/subscribe_output", "params": {"response_template": {"method": "process_gcode_response"}}}'
Received 1512.792309: b'{"id": 3908704600, "method": "list_endpoints", "params": {}}'
Received 1513.802761: b'{"id": 3908705704, "method": "info", "params": {}}'
Received 1515.811861: b'{"id": 3908703712, "method": "info", "params": {}}'
Received 1517.815962: b'{"id": 3908705080, "method": "info", "params": {}}'
Reactor garbage collection: (1512.20297308, 0.0, 0.0)
MCU 'mcu' shutdown: Command request
clocksync state: mcu_freq=120000000 last_clock=183248264096 clock_est=(1512.737 182492070839 119995413.485) min_half_rtt=0.000074 min_rtt_time=1511.941 time_avg=1512.737(4.075) clock_avg=182492070839.735(488934974.038) pred_variance=8381021712.086
Dumping serial stats: bytes_write=740 bytes_read=5084 bytes_retransmit=9 bytes_invalid=0 send_seq=94 receive_seq=94 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0
Dumping send queue 89 messages
Sent 0 1511.665629 1511.665629 8: seq: 11, identify offset=0 count=40
Sent 1 1511.701570 1511.701570 8: seq: 16, identify offset=0 count=40
Sent 2 1511.702093 1511.702093 8: seq: 17, identify offset=40 count=40
Sent 3 1511.702532 1511.702532 8: seq: 18, identify offset=80 count=40
Sent 4 1511.702990 1511.702990 9: seq: 19, identify offset=120 count=40
Sent 5 1511.703413 1511.703413 9: seq: 1a, identify offset=160 count=40
Sent 6 1511.703837 1511.703837 9: seq: 1b, identify offset=200 count=40
Sent 7 1511.704251 1511.704251 9: seq: 1c, identify offset=240 count=40
Sent 8 1511.704664 1511.704664 9: seq: 1d, identify offset=280 count=40
Sent 9 1511.705077 1511.705077 9: seq: 1e, identify offset=320 count=40
Sent 10 1511.705491 1511.705491 9: seq: 1f, identify offset=360 count=40
Sent 11 1511.705919 1511.705919 9: seq: 10, identify offset=400 count=40
Sent 12 1511.706341 1511.706341 9: seq: 11, identify offset=440 count=40
Sent 13 1511.706755 1511.706755 9: seq: 12, identify offset=480 count=40
Sent 14 1511.707222 1511.707222 9: seq: 13, identify offset=520 count=40
Sent 15 1511.707642 1511.707642 9: seq: 14, identify offset=560 count=40
Sent 16 1511.708061 1511.708061 9: seq: 15, identify offset=600 count=40
Sent 17 1511.708481 1511.708481 9: seq: 16, identify offset=640 count=40
Sent 18 1511.708903 1511.708903 9: seq: 17, identify offset=680 count=40
Sent 19 1511.709320 1511.709320 9: seq: 18, identify offset=720 count=40
Sent 20 1511.709730 1511.709730 9: seq: 19, identify offset=760 count=40
Sent 21 1511.710199 1511.710199 9: seq: 1a, identify offset=800 count=40
Sent 22 1511.710610 1511.710610 9: seq: 1b, identify offset=840 count=40
Sent 23 1511.711052 1511.711052 9: seq: 1c, identify offset=880 count=40
Sent 24 1511.711486 1511.711486 9: seq: 1d, identify offset=920 count=40
Sent 25 1511.711902 1511.711902 9: seq: 1e, identify offset=960 count=40
Sent 26 1511.712320 1511.712320 9: seq: 1f, identify offset=1000 count=40
Sent 27 1511.712735 1511.712735 9: seq: 10, identify offset=1040 count=40
Sent 28 1511.713199 1511.713199 9: seq: 11, identify offset=1080 count=40
Sent 29 1511.713609 1511.713609 9: seq: 12, identify offset=1120 count=40
Sent 30 1511.714092 1511.714092 9: seq: 13, identify offset=1160 count=40
Sent 31 1511.714513 1511.714513 9: seq: 14, identify offset=1200 count=40
Sent 32 1511.714968 1511.714968 9: seq: 15, identify offset=1240 count=40
Sent 33 1511.715381 1511.715381 9: seq: 16, identify offset=1280 count=40
Sent 34 1511.715813 1511.715813 9: seq: 17, identify offset=1320 count=40
Sent 35 1511.716233 1511.716233 9: seq: 18, identify offset=1360 count=40
Sent 36 1511.716649 1511.716649 9: seq: 19, identify offset=1400 count=40
Sent 37 1511.717060 1511.717060 9: seq: 1a, identify offset=1440 count=40
Sent 38 1511.717480 1511.717480 9: seq: 1b, identify offset=1480 count=40
Sent 39 1511.717888 1511.717888 9: seq: 1c, identify offset=1520 count=40
Sent 40 1511.718296 1511.718296 9: seq: 1d, identify offset=1560 count=40
Sent 41 1511.718704 1511.718704 9: seq: 1e, identify offset=1600 count=40
Sent 42 1511.719155 1511.719155 9: seq: 1f, identify offset=1640 count=40
Sent 43 1511.719571 1511.719571 9: seq: 10, identify offset=1680 count=40
Sent 44 1511.719982 1511.719982 9: seq: 11, identify offset=1720 count=40
Sent 45 1511.720401 1511.720401 9: seq: 12, identify offset=1760 count=40
Sent 46 1511.720807 1511.720807 9: seq: 13, identify offset=1800 count=40
Sent 47 1511.721213 1511.721213 9: seq: 14, identify offset=1840 count=40
Sent 48 1511.721619 1511.721619 9: seq: 15, identify offset=1880 count=40
Sent 49 1511.722035 1511.722035 9: seq: 16, identify offset=1920 count=40
Sent 50 1511.722445 1511.722445 9: seq: 17, identify offset=1960 count=40
Sent 51 1511.722881 1511.722881 9: seq: 18, identify offset=2000 count=40
Sent 52 1511.723296 1511.723296 9: seq: 19, identify offset=2040 count=40
Sent 53 1511.723706 1511.723706 9: seq: 1a, identify offset=2080 count=40
Sent 54 1511.724151 1511.724151 9: seq: 1b, identify offset=2120 count=40
Sent 55 1511.724559 1511.724559 9: seq: 1c, identify offset=2160 count=40
Sent 56 1511.724964 1511.724964 9: seq: 1d, identify offset=2200 count=40
Sent 57 1511.725391 1511.725391 9: seq: 1e, identify offset=2240 count=40
Sent 58 1511.725867 1511.725867 9: seq: 1f, identify offset=2280 count=40
Sent 59 1511.726295 1511.726295 9: seq: 10, identify offset=2320 count=40
Sent 60 1511.726706 1511.726706 9: seq: 11, identify offset=2360 count=40
Sent 61 1511.727160 1511.727160 9: seq: 12, identify offset=2400 count=40
Sent 62 1511.727573 1511.727573 9: seq: 13, identify offset=2440 count=40
Sent 63 1511.727983 1511.727983 9: seq: 14, identify offset=2480 count=40
Sent 64 1511.728402 1511.728402 9: seq: 15, identify offset=2520 count=40
Sent 65 1511.728813 1511.728813 9: seq: 16, identify offset=2560 count=40
Sent 66 1511.729232 1511.729232 9: seq: 17, identify offset=2600 count=40
Sent 67 1511.729648 1511.729648 9: seq: 18, identify offset=2640 count=40
Sent 68 1511.730052 1511.730052 9: seq: 19, identify offset=2680 count=40
Sent 69 1511.730432 1511.730432 9: seq: 1a, identify offset=2682 count=40
Sent 70 1511.736756 1511.736756 6: seq: 1b, get_uptime
Sent 71 1511.788309 1511.788309 6: seq: 1c, get_clock
Sent 72 1511.839368 1511.839368 6: seq: 1d, get_clock
Sent 73 1511.890064 1511.890064 6: seq: 1e, get_clock
Sent 74 1511.940694 1511.940694 6: seq: 1f, get_clock
Sent 75 1511.991313 1511.991313 6: seq: 10, get_clock
Sent 76 1512.042036 1512.042036 6: seq: 11, get_clock
Sent 77 1512.093299 1512.093299 6: seq: 12, get_clock
Sent 78 1512.143959 1512.143959 6: seq: 13, get_clock
Sent 79 1512.146129 1512.146129 6: seq: 14, get_clock
Sent 80 1512.610740 1512.610740 6: seq: 15, get_config
Sent 81 1513.130342 1513.130342 6: seq: 16, get_clock
Sent 82 1514.114842 1514.114842 6: seq: 17, get_clock
Sent 83 1515.099180 1515.099180 6: seq: 18, get_clock
Sent 84 1516.083500 1516.083500 6: seq: 19, get_clock
Sent 85 1517.068343 1517.068343 6: seq: 1a, get_clock
Sent 86 1518.053475 1518.053475 6: seq: 1b, get_clock
Sent 87 1519.039144 1519.039144 6: seq: 1c, get_clock
Sent 88 1519.122979 1519.122979 6: seq: 1d, emergency_stop
Dumping receive queue 100 messages
Receive: 0 1511.729410 1511.729232 49: seq: 18, identify_response offset=2600 data=b'\x04\xec\x9a\xcepm\xaa\x86\xb3\xce>R\xacQ\xba\xd9\x06\xaeR=\xbd?\xd6\xa8\xe4\xe9\x93\xea\xd39O\x91\xdbR\xf8l\xe7\xd6\x07\x06'
Receive: 1 1511.729813 1511.729648 49: seq: 19, identify_response offset=2640 data=b'UQ\xaa\xc4\x98\xfe\x1bc\xf4\x17\x03@U\xfd_\x9dP3=`9w\x19,\xa3 ]\x1e\xd2}PF)\xd4\x10_\xfe\x0b\x985'
Receive: 2 1511.730196 1511.730052 11: seq: 1a, identify_response offset=2680 data=b'\xaf\xb0'
Receive: 3 1511.730571 1511.730432 9: seq: 1b, identify_response offset=2682 data=b''
Receive: 4 1511.736952 1511.736756 12: seq: 1c, uptime high=42 clock=1983386791
Receive: 5 1511.767455 1511.736756 15: seq: 1c, analog_in_state oid=19 next_clock=2022173568 value=31695
Receive: 6 1511.788480 1511.788309 11: seq: 1d, clock clock=1989571314
Receive: 7 1511.837485 1511.788309 15: seq: 1d, analog_in_state oid=26 next_clock=2030573568 value=31537
Receive: 8 1511.839542 1511.839368 11: seq: 1e, clock clock=1995697834
Receive: 9 1511.887453 1511.839368 14: seq: 1e, analog_in_state oid=31 next_clock=2036573568 value=6105
Receive: 10 1511.890224 1511.890064 11: seq: 1f, clock clock=2001779794
Receive: 11 1511.940842 1511.940694 11: seq: 10, clock clock=2007854759
Receive: 12 1511.991469 1511.991313 11: seq: 11, clock clock=2013929534
Receive: 13 1512.042237 1512.042036 11: seq: 12, clock clock=2020017294
Receive: 14 1512.042251 1512.042036 15: seq: 12, stats count=378 sum=489069 sumsq=4376682
Receive: 15 1512.067465 1512.042036 15: seq: 12, analog_in_state oid=19 next_clock=2058173568 value=31695
Receive: 16 1512.093465 1512.093299 11: seq: 13, clock clock=2026167584
Receive: 17 1512.137473 1512.093299 15: seq: 13, analog_in_state oid=26 next_clock=2066573568 value=31536
Receive: 18 1512.144116 1512.143959 11: seq: 14, clock clock=2032246599
Receive: 19 1512.146318 1512.146129 11: seq: 15, clock clock=2032507264
Receive: 20 1512.187534 1512.146129 14: seq: 15, analog_in_state oid=31 next_clock=2072573568 value=6109
Receive: 21 1512.367502 1512.146129 15: seq: 15, analog_in_state oid=19 next_clock=2094173568 value=31695
Receive: 22 1512.437497 1512.146129 15: seq: 15, analog_in_state oid=26 next_clock=2102573568 value=31536
Receive: 23 1512.487487 1512.146129 14: seq: 15, analog_in_state oid=31 next_clock=2108573568 value=6108
Receive: 24 1512.610946 1512.610740 15: seq: 16, config is_config=1 crc=4005148866 is_shutdown=1 move_count=1024
Receive: 25 1512.667517 1512.610740 15: seq: 16, analog_in_state oid=19 next_clock=2130173568 value=31690
Receive: 26 1512.737510 1512.610740 15: seq: 16, analog_in_state oid=26 next_clock=2138573568 value=31533
Receive: 27 1512.787591 1512.610740 14: seq: 16, analog_in_state oid=31 next_clock=2144573568 value=6107
Receive: 28 1512.967550 1512.610740 15: seq: 16, analog_in_state oid=19 next_clock=2166173568 value=31692
Receive: 29 1513.037514 1512.610740 15: seq: 16, analog_in_state oid=26 next_clock=2174573568 value=31532
Receive: 30 1513.087526 1512.610740 14: seq: 16, analog_in_state oid=31 next_clock=2180573568 value=6101
Receive: 31 1513.130534 1513.130342 11: seq: 17, clock clock=2150611549
Receive: 32 1513.267517 1513.130342 15: seq: 17, analog_in_state oid=19 next_clock=2202173568 value=31691
Receive: 33 1513.337538 1513.130342 15: seq: 17, analog_in_state oid=26 next_clock=2210573568 value=31536
Receive: 34 1513.387522 1513.130342 14: seq: 17, analog_in_state oid=31 next_clock=2216573568 value=6100
Receive: 35 1513.567554 1513.130342 15: seq: 17, analog_in_state oid=19 next_clock=2238173568 value=31698
Receive: 36 1513.637590 1513.130342 15: seq: 17, analog_in_state oid=26 next_clock=2246573568 value=31540
Receive: 37 1513.687536 1513.130342 14: seq: 17, analog_in_state oid=31 next_clock=2252573568 value=6104
Receive: 38 1513.867577 1513.130342 15: seq: 17, analog_in_state oid=19 next_clock=2274173568 value=31687
Receive: 39 1513.937551 1513.130342 15: seq: 17, analog_in_state oid=26 next_clock=2282573568 value=31533
Receive: 40 1513.987556 1513.130342 14: seq: 17, analog_in_state oid=31 next_clock=2288573568 value=6103
Receive: 41 1514.115027 1514.114842 11: seq: 18, clock clock=2268742964
Receive: 42 1514.167553 1514.114842 15: seq: 18, analog_in_state oid=19 next_clock=2310173568 value=31689
Receive: 43 1514.237566 1514.114842 15: seq: 18, analog_in_state oid=26 next_clock=2318573568 value=31536
Receive: 44 1514.287551 1514.114842 14: seq: 18, analog_in_state oid=31 next_clock=2324573568 value=6105
Receive: 45 1514.467579 1514.114842 15: seq: 18, analog_in_state oid=19 next_clock=2346173568 value=31694
Receive: 46 1514.537589 1514.114842 15: seq: 18, analog_in_state oid=26 next_clock=2354573568 value=31542
Receive: 47 1514.587625 1514.114842 14: seq: 18, analog_in_state oid=31 next_clock=2360573568 value=6106
Receive: 48 1514.767796 1514.114842 15: seq: 18, analog_in_state oid=19 next_clock=2382173568 value=31690
Receive: 49 1514.837705 1514.114842 15: seq: 18, analog_in_state oid=26 next_clock=2390573568 value=31533
Receive: 50 1514.887652 1514.114842 14: seq: 18, analog_in_state oid=31 next_clock=2396573568 value=6101
Receive: 51 1515.067695 1514.114842 15: seq: 18, analog_in_state oid=19 next_clock=2418173568 value=31695
Receive: 52 1515.099536 1515.099180 11: seq: 19, clock clock=2386870199
Receive: 53 1515.137685 1515.099180 15: seq: 19, analog_in_state oid=26 next_clock=2426573568 value=31535
Receive: 54 1515.187679 1515.099180 14: seq: 19, analog_in_state oid=31 next_clock=2432573568 value=6100
Receive: 55 1515.367701 1515.099180 15: seq: 19, analog_in_state oid=19 next_clock=2454173568 value=31693
Receive: 56 1515.437692 1515.099180 15: seq: 19, analog_in_state oid=26 next_clock=2462573568 value=31537
Receive: 57 1515.487689 1515.099180 14: seq: 19, analog_in_state oid=31 next_clock=2468573568 value=6103
Receive: 58 1515.667841 1515.099180 15: seq: 19, analog_in_state oid=19 next_clock=2490173568 value=31689
Receive: 59 1515.737726 1515.099180 15: seq: 19, analog_in_state oid=26 next_clock=2498573568 value=31535
Receive: 60 1515.787706 1515.099180 14: seq: 19, analog_in_state oid=31 next_clock=2504573568 value=6099
Receive: 61 1515.967748 1515.099180 15: seq: 19, analog_in_state oid=19 next_clock=2526173568 value=31690
Receive: 62 1516.037733 1515.099180 15: seq: 19, analog_in_state oid=26 next_clock=2534573568 value=31537
Receive: 63 1516.083814 1516.083500 11: seq: 1a, clock clock=2504975844
Receive: 64 1516.087694 1516.083500 14: seq: 1a, analog_in_state oid=31 next_clock=2540573568 value=6102
Receive: 65 1516.267739 1516.083500 15: seq: 1a, analog_in_state oid=19 next_clock=2562173568 value=31697
Receive: 66 1516.337747 1516.083500 15: seq: 1a, analog_in_state oid=26 next_clock=2570573568 value=31534
Receive: 67 1516.387726 1516.083500 14: seq: 1a, analog_in_state oid=31 next_clock=2576573568 value=6101
Receive: 68 1516.567779 1516.083500 15: seq: 1a, analog_in_state oid=19 next_clock=2598173568 value=31689
Receive: 69 1516.637849 1516.083500 15: seq: 1a, analog_in_state oid=26 next_clock=2606573568 value=31539
Receive: 70 1516.687737 1516.083500 14: seq: 1a, analog_in_state oid=31 next_clock=2612573568 value=6106
Receive: 71 1516.867784 1516.083500 15: seq: 1a, analog_in_state oid=19 next_clock=2634173568 value=31692
Receive: 72 1516.937784 1516.083500 15: seq: 1a, analog_in_state oid=26 next_clock=2642573568 value=31536
Receive: 73 1516.987787 1516.083500 14: seq: 1a, analog_in_state oid=31 next_clock=2648573568 value=6107
Receive: 74 1517.068694 1517.068343 11: seq: 1b, clock clock=2623151944
Receive: 75 1517.068723 1517.068343 14: seq: 1b, stats count=231 sum=211208 sumsq=1287161
Receive: 76 1517.167806 1517.068343 15: seq: 1b, analog_in_state oid=19 next_clock=2670173568 value=31694
Receive: 77 1517.237832 1517.068343 15: seq: 1b, analog_in_state oid=26 next_clock=2678573568 value=31531
Receive: 78 1517.287844 1517.068343 14: seq: 1b, analog_in_state oid=31 next_clock=2684573568 value=6098
Receive: 79 1517.467794 1517.068343 15: seq: 1b, analog_in_state oid=19 next_clock=2706173568 value=31696
Receive: 80 1517.537793 1517.068343 15: seq: 1b, analog_in_state oid=26 next_clock=2714573568 value=31536
Receive: 81 1517.587843 1517.068343 14: seq: 1b, analog_in_state oid=31 next_clock=2720573568 value=6102
Receive: 82 1517.767810 1517.068343 15: seq: 1b, analog_in_state oid=19 next_clock=2742173568 value=31695
Receive: 83 1517.837832 1517.068343 15: seq: 1b, analog_in_state oid=26 next_clock=2750573568 value=31531
Receive: 84 1517.887809 1517.068343 14: seq: 1b, analog_in_state oid=31 next_clock=2756573568 value=6098
Receive: 85 1518.053809 1518.053475 11: seq: 1c, clock clock=2741362924
Receive: 86 1518.067798 1518.053475 15: seq: 1c, analog_in_state oid=19 next_clock=2778173568 value=31692
Receive: 87 1518.137819 1518.053475 15: seq: 1c, analog_in_state oid=26 next_clock=2786573568 value=31531
Receive: 88 1518.187823 1518.053475 14: seq: 1c, analog_in_state oid=31 next_clock=2792573568 value=6103
Receive: 89 1518.367835 1518.053475 15: seq: 1c, analog_in_state oid=19 next_clock=2814173568 value=31696
Receive: 90 1518.437826 1518.053475 15: seq: 1c, analog_in_state oid=26 next_clock=2822573568 value=31534
Receive: 91 1518.487831 1518.053475 14: seq: 1c, analog_in_state oid=31 next_clock=2828573568 value=6105
Receive: 92 1518.667957 1518.053475 15: seq: 1c, analog_in_state oid=19 next_clock=2850173568 value=31687
Receive: 93 1518.737845 1518.053475 15: seq: 1c, analog_in_state oid=26 next_clock=2858573568 value=31534
Receive: 94 1518.787846 1518.053475 14: seq: 1c, analog_in_state oid=31 next_clock=2864573568 value=6099
Receive: 95 1518.967825 1518.053475 15: seq: 1c, analog_in_state oid=19 next_clock=2886173568 value=31689
Receive: 96 1519.037849 1518.053475 15: seq: 1c, analog_in_state oid=26 next_clock=2894573568 value=31533
Receive: 97 1519.039467 1519.039144 11: seq: 1d, clock clock=2859637664
Receive: 98 1519.087857 1519.039144 14: seq: 1d, analog_in_state oid=31 next_clock=2900573568 value=6105
Receive: 99 1519.123435 1519.122979 12: seq: 1e, shutdown clock=2869698413 static_string_id=Command request
mcu 'mcu': got {'oid': 19, 'next_clock': 2958173568, 'value': 31697, '#name': 'analog_in_state', '#sent_time': 1519.122979242, '#receive_time': 1519.567878742}
mcu 'mcu': got {'oid': 26, 'next_clock': 2966573568, 'value': 31534, '#name': 'analog_in_state', '#sent_time': 1519.122979242, '#receive_time': 1519.637931705}
mcu 'mcu': got {'oid': 31, 'next_clock': 2972573568, 'value': 6102, '#name': 'analog_in_state', '#sent_time': 1519.122979242, '#receive_time': 1519.68786326}
mcu 'mcu': got {'oid': 19, 'next_clock': 2994173568, 'value': 31692, '#name': 'analog_in_state', '#sent_time': 1519.122979242, '#receive_time': 1519.867894538}
mcu 'mcu': got {'oid': 26, 'next_clock': 3002573568, 'value': 31535, '#name': 'analog_in_state', '#sent_time': 1519.122979242, '#receive_time': 1519.937856612}
mcu 'mcu': got {'oid': 31, 'next_clock': 3008573568, 'value': 6105, '#name': 'analog_in_state', '#sent_time': 1519.122979242, '#receive_time': 1519.987885723}
b'Got EOF when reading from device'
mcu 'mcu': got {'oid': 19, 'next_clock': 3030173568, 'value': 31688, '#name': 'analog_in_state', '#sent_time': 1520.024226334, '#receive_time': 1520.167958816}
mcu 'mcu': got {'oid': 26, 'next_clock': 3038573568, 'value': 31530, '#name': 'analog_in_state', '#sent_time': 1520.024226334, '#receive_time': 1520.237831149}
mcu 'mcu': got {'oid': 31, 'next_clock': 3044573568, 'value': 6105, '#name': 'analog_in_state', '#sent_time': 1520.024226334, '#receive_time': 1520.287816205}
mcu 'mcu': got {'oid': 19, 'next_clock': 3066173568, 'value': 31690, '#name': 'analog_in_state', '#sent_time': 1520.024226334, '#receive_time': 1520.467829464}
mcu 'mcu': got {'oid': 26, 'next_clock': 3074573568, 'value': 31541, '#name': 'analog_in_state', '#sent_time': 1520.024226334, '#receive_time': 1520.53787876}
mcu 'mcu': got {'oid': 31, 'next_clock': 3080573568, 'value': 6100, '#name': 'analog_in_state', '#sent_time': 1520.024226334, '#receive_time': 1520.587830575}
mcu 'mcu': got {'oid': 19, 'next_clock': 3102173568, 'value': 31686, '#name': 'analog_in_state', '#sent_time': 1520.024226334, '#receive_time': 1520.76782726}
mcu 'mcu': got {'oid': 26, 'next_clock': 3110573568, 'value': 31537, '#name': 'analog_in_state', '#sent_time': 1520.024226334, '#receive_time': 1520.837870926}
mcu 'mcu': got {'oid': 31, 'next_clock': 3116573568, 'value': 6104, '#name': 'analog_in_state', '#sent_time': 1520.024226334, '#receive_time': 1520.887839019}
mcu 'mcu': got {'oid': 19, 'next_clock': 3138173568, 'value': 31690, '#name': 'analog_in_state', '#sent_time': 1521.009183945, '#receive_time': 1521.067838371}
mcu 'mcu': got {'oid': 26, 'next_clock': 3146573568, 'value': 31536, '#name': 'analog_in_state', '#sent_time': 1521.009183945, '#receive_time': 1521.137847574}
mcu 'mcu': got {'oid': 31, 'next_clock': 3152573568, 'value': 6103, '#name': 'analog_in_state', '#sent_time': 1521.009183945, '#receive_time': 1521.187852834}
mcu 'mcu': got {'oid': 19, 'next_clock': 3174173568, 'value': 31691, '#name': 'analog_in_state', '#sent_time': 1521.009183945, '#receive_time': 1521.367893056}
mcu 'mcu': got {'oid': 26, 'next_clock': 3182573568, 'value': 31532, '#name': 'analog_in_state', '#sent_time': 1521.009183945, '#receive_time': 1521.437866796}
mcu 'mcu': got {'oid': 31, 'next_clock': 3188573568, 'value': 6102, '#name': 'analog_in_state', '#sent_time': 1521.009183945, '#receive_time': 1521.487865519}
mcu 'mcu': got {'oid': 19, 'next_clock': 3210173568, 'value': 31699, '#name': 'analog_in_state', '#sent_time': 1521.009183945, '#receive_time': 1521.667918278}
mcu 'mcu': got {'oid': 26, 'next_clock': 3218573568, 'value': 31536, '#name': 'analog_in_state', '#sent_time': 1521.009183945, '#receive_time': 1521.737880852}
mcu 'mcu': got {'oid': 31, 'next_clock': 3224573568, 'value': 6101, '#name': 'analog_in_state', '#sent_time': 1521.009183945, '#receive_time': 1521.787869889}
mcu 'mcu': got {'oid': 19, 'next_clock': 3246173568, 'value': 31688, '#name': 'analog_in_state', '#sent_time': 1521.009183945, '#receive_time': 1521.967906111}
mcu 'mcu': got {'oid': 26, 'next_clock': 3254573568, 'value': 31532, '#name': 'analog_in_state', '#sent_time': 1521.994051833, '#receive_time': 1522.037872518}
mcu 'mcu': got {'oid': 31, 'next_clock': 3260573568, 'value': 6102, '#name': 'analog_in_state', '#sent_time': 1521.994051833, '#receive_time': 1522.087874907}
mcu 'mcu': got {'oid': 19, 'next_clock': 3282173568, 'value': 31693, '#name': 'analog_in_state', '#sent_time': 1521.994051833, '#receive_time': 1522.267899592}
mcu 'mcu': got {'oid': 26, 'next_clock': 3290573568, 'value': 31537, '#name': 'analog_in_state', '#sent_time': 1521.994051833, '#receive_time': 1522.337904759}
mcu 'mcu': got {'oid': 31, 'next_clock': 3296573568, 'value': 6103, '#name': 'analog_in_state', '#sent_time': 1521.994051833, '#receive_time': 1522.387900018}
mcu 'mcu': got {'oid': 19, 'next_clock': 3318173568, 'value': 31686, '#name': 'analog_in_state', '#sent_time': 1521.994051833, '#receive_time': 1522.567972296}
mcu 'mcu': got {'oid': 26, 'next_clock': 3326573568, 'value': 31534, '#name': 'analog_in_state', '#sent_time': 1521.994051833, '#receive_time': 1522.637913407}
mcu 'mcu': got {'oid': 31, 'next_clock': 3332573568, 'value': 6106, '#name': 'analog_in_state', '#sent_time': 1521.994051833, '#receive_time': 1522.687915314}
mcu 'mcu': got {'oid': 19, 'next_clock': 3354173568, 'value': 31690, '#name': 'analog_in_state', '#sent_time': 1521.994051833, '#receive_time': 1522.867947036}
mcu 'mcu': got {'oid': 26, 'next_clock': 3362573568, 'value': 31536, '#name': 'analog_in_state', '#sent_time': 1521.994051833, '#receive_time': 1522.937924925}
mcu 'mcu': got {'oid': 31, 'next_clock': 3368573568, 'value': 6104, '#name': 'analog_in_state', '#sent_time': 1522.978913962, '#receive_time': 1522.987910407}
mcu 'mcu': got {'oid': 19, 'next_clock': 3390173568, 'value': 31694, '#name': 'analog_in_state', '#sent_time': 1522.978913962, '#receive_time': 1523.167942166}
mcu 'mcu': got {'oid': 26, 'next_clock': 3398573568, 'value': 31534, '#name': 'analog_in_state', '#sent_time': 1522.978913962, '#receive_time': 1523.237927277}
mcu 'mcu': got {'oid': 31, 'next_clock': 3404573568, 'value': 6106, '#name': 'analog_in_state', '#sent_time': 1522.978913962, '#receive_time': 1523.287933629}
mcu 'mcu': got {'oid': 19, 'next_clock': 3426173568, 'value': 31692, '#name': 'analog_in_state', '#sent_time': 1522.978913962, '#receive_time': 1523.46796224}
mcu 'mcu': got {'oid': 26, 'next_clock': 3434573568, 'value': 31541, '#name': 'analog_in_state', '#sent_time': 1522.978913962, '#receive_time': 1523.538004369}
mcu 'mcu': got {'oid': 31, 'next_clock': 3440573568, 'value': 6106, '#name': 'analog_in_state', '#sent_time': 1522.978913962, '#receive_time': 1523.587967054}
mcu 'mcu': got {'oid': 19, 'next_clock': 3462173568, 'value': 31689, '#name': 'analog_in_state', '#sent_time': 1522.978913962, '#receive_time': 1523.76796111}
mcu 'mcu': got {'oid': 26, 'next_clock': 3470573568, 'value': 31539, '#name': 'analog_in_state', '#sent_time': 1522.978913962, '#receive_time': 1523.83799598}
mcu 'mcu': got {'oid': 31, 'next_clock': 3476573568, 'value': 6103, '#name': 'analog_in_state', '#sent_time': 1522.978913962, '#receive_time': 1523.887971388}
mcu 'mcu': got {'oid': 19, 'next_clock': 3498173568, 'value': 31690, '#name': 'analog_in_state', '#sent_time': 1523.96312898, '#receive_time': 1524.067965258}
mcu 'mcu': got {'oid': 26, 'next_clock': 3506573568, 'value': 31529, '#name': 'analog_in_state', '#sent_time': 1523.96312898, '#receive_time': 1524.137968202}
mcu 'mcu': got {'oid': 31, 'next_clock': 3512573568, 'value': 6106, '#name': 'analog_in_state', '#sent_time': 1523.96312898, '#receive_time': 1524.187971832}
mcu 'mcu': got {'oid': 19, 'next_clock': 3534173568, 'value': 31689, '#name': 'analog_in_state', '#sent_time': 1523.96312898, '#receive_time': 1524.367984869}
mcu 'mcu': got {'oid': 26, 'next_clock': 3542573568, 'value': 31541, '#name': 'analog_in_state', '#sent_time': 1523.96312898, '#receive_time': 1524.437976147}
mcu 'mcu': got {'oid': 31, 'next_clock': 3548573568, 'value': 6099, '#name': 'analog_in_state', '#sent_time': 1523.96312898, '#receive_time': 1524.488051072}
mcu 'mcu': got {'oid': 19, 'next_clock': 3570173568, 'value': 31695, '#name': 'analog_in_state', '#sent_time': 1523.96312898, '#receive_time': 1524.668004054}
mcu 'mcu': got {'oid': 26, 'next_clock': 3578573568, 'value': 31536, '#name': 'analog_in_state', '#sent_time': 1523.96312898, '#receive_time': 1524.738011535}
mcu 'mcu': got {'oid': 31, 'next_clock': 3584573568, 'value': 6104, '#name': 'analog_in_state', '#sent_time': 1523.96312898, '#receive_time': 1524.788006331}
mcu 'mcu': got {'oid': 19, 'next_clock': 3606173568, 'value': 31690, '#name': 'analog_in_state', '#sent_time': 1524.947993331, '#receive_time': 1524.967995683}
mcu 'mcu': got {'oid': 26, 'next_clock': 3614573568, 'value': 31529, '#name': 'analog_in_state', '#sent_time': 1524.947993331, '#receive_time': 1525.038015442}
mcu 'mcu': got {'oid': 31, 'next_clock': 3620573568, 'value': 6104, '#name': 'analog_in_state', '#sent_time': 1524.947993331, '#receive_time': 1525.088017794}
mcu 'mcu': got {'oid': 19, 'next_clock': 3642173568, 'value': 31691, '#name': 'analog_in_state', '#sent_time': 1524.947993331, '#receive_time': 1525.268122665}
mcu 'mcu': got {'oid': 26, 'next_clock': 3650573568, 'value': 31533, '#name': 'analog_in_state', '#sent_time': 1524.947993331, '#receive_time': 1525.33814259}
mcu 'mcu': got {'oid': 31, 'next_clock': 3656573568, 'value': 6102, '#name': 'analog_in_state', '#sent_time': 1524.947993331, '#receive_time': 1525.388127794}
mcu 'mcu': got {'oid': 19, 'next_clock': 3678173568, 'value': 31691, '#name': 'analog_in_state', '#sent_time': 1524.947993331, '#receive_time': 1525.568257461}
mcu 'mcu': got {'oid': 26, 'next_clock': 3686573568, 'value': 31533, '#name': 'analog_in_state', '#sent_time': 1524.947993331, '#receive_time': 1525.638112498}
mcu 'mcu': got {'oid': 31, 'next_clock': 3692573568, 'value': 6103, '#name': 'analog_in_state', '#sent_time': 1524.947993331, '#receive_time': 1525.688131868}
mcu 'mcu': got {'oid': 19, 'next_clock': 3714173568, 'value': 31689, '#name': 'analog_in_state', '#sent_time': 1524.947993331, '#receive_time': 1525.868172553}
mcu 'mcu': got {'oid': 26, 'next_clock': 3722573568, 'value': 31531, '#name': 'analog_in_state', '#sent_time': 1525.932882609, '#receive_time': 1525.938098905}
mcu 'mcu': got {'oid': 31, 'next_clock': 3728573568, 'value': 6101, '#name': 'analog_in_state', '#sent_time': 1525.932882609, '#receive_time': 1525.988159997}
mcu 'mcu': got {'oid': 19, 'next_clock': 3750173568, 'value': 31688, '#name': 'analog_in_state', '#sent_time': 1525.932882609, '#receive_time': 1526.168191257}
mcu 'mcu': got {'oid': 26, 'next_clock': 3758573568, 'value': 31529, '#name': 'analog_in_state', '#sent_time': 1525.932882609, '#receive_time': 1526.238188701}
mcu 'mcu': got {'oid': 31, 'next_clock': 3764573568, 'value': 6100, '#name': 'analog_in_state', '#sent_time': 1525.932882609, '#receive_time': 1526.288195016}
mcu 'mcu': got {'oid': 19, 'next_clock': 3786173568, 'value': 31693, '#name': 'analog_in_state', '#sent_time': 1525.932882609, '#receive_time': 1526.468355664}
mcu 'mcu': got {'oid': 26, 'next_clock': 3794573568, 'value': 31530, '#name': 'analog_in_state', '#sent_time': 1525.932882609, '#receive_time': 1526.538153738}
mcu 'mcu': got {'oid': 31, 'next_clock': 3800573568, 'value': 6104, '#name': 'analog_in_state', '#sent_time': 1525.932882609, '#receive_time': 1526.588167293}
mcu 'mcu': got {'oid': 19, 'next_clock': 3822173568, 'value': 31690, '#name': 'analog_in_state', '#sent_time': 1525.932882609, '#receive_time': 1526.768166108}
mcu 'mcu': got {'oid': 26, 'next_clock': 3830573568, 'value': 31526, '#name': 'analog_in_state', '#sent_time': 1525.932882609, '#receive_time': 1526.838204534}
mcu 'mcu': got {'oid': 31, 'next_clock': 3836573568, 'value': 6102, '#name': 'analog_in_state', '#sent_time': 1525.932882609, '#receive_time': 1526.888207367}
mcu 'mcu': got {'oid': 19, 'next_clock': 3858173568, 'value': 31692, '#name': 'analog_in_state', '#sent_time': 1526.917575164, '#receive_time': 1527.068183904}
mcu 'mcu': got {'oid': 26, 'next_clock': 3866573568, 'value': 31531, '#name': 'analog_in_state', '#sent_time': 1526.917575164, '#receive_time': 1527.138164015}
mcu 'mcu': got {'oid': 31, 'next_clock': 3872573568, 'value': 6105, '#name': 'analog_in_state', '#sent_time': 1526.917575164, '#receive_time': 1527.188210626}
Attempting MCU 'mcu' reset command
Unable to issue reset command on MCU 'rpi'
webhooks client 4122689744: Disconnected
Restarting printer
Start printer at Fri Jan 12 19:12:44 2024 (1705086764.4 1528.3)
===== Config file =====
[virtual_sdcard]
path = ~/printer_data/gcodes
on_error_gcode = CANCEL_PRINT

[pause_resume]

[display_status]

[respond]

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = CANCEL_PRINT_BASE
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set allow_park = client.park_at_cancel|default(false)|lower == 'true' %}
	{% set retract = client.cancel_retract|default(5.0)|abs %}
	
	{% set park_x = "" if (client.park_at_cancel_x|default(none) is none)
	else "X=" ~ client.park_at_cancel_x %}
	{% set park_y = "" if (client.park_at_cancel_y|default(none) is none)
	else "Y=" ~ client.park_at_cancel_y %}
	{% set custom_park = park_x|length > 0 or park_y|length > 0 %}
	
	
	{% if printer['gcode_macro RESUME'].restore_idle_timeout > 0 %}
	SET_IDLE_TIMEOUT TIMEOUT={printer['gcode_macro RESUME'].restore_idle_timeout}
	{% endif %}
	{% if (custom_park or not printer.pause_resume.is_paused) and allow_park %} _TOOLHEAD_PARK_PAUSE_CANCEL {park_x} {park_y} {% endif %}
	_CLIENT_RETRACT LENGTH={retract}
	TURN_OFF_HEATERS
	M106 S0
	{client.user_cancel_macro|default("")}
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=idle_state VALUE=False
	
	SET_PAUSE_NEXT_LAYER ENABLE=0
	SET_PAUSE_AT_LAYER ENABLE=0 LAYER=0
	CANCEL_PRINT_BASE

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = PAUSE_BASE
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set idle_timeout = client.idle_timeout|default(0) %}
	{% set temp = printer[printer.toolhead.extruder].target if printer.toolhead.extruder != '' else 0 %}
	{% set restore = False if printer.toolhead.extruder == ''
	else True  if params.RESTORE|default(1)|int == 1 else False %}
	
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=last_extruder_temp VALUE="{{'restore': restore, 'temp': temp}}"
	
	{% if idle_timeout > 0 %}
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=restore_idle_timeout VALUE={printer.configfile.settings.idle_timeout.timeout}
	SET_IDLE_TIMEOUT TIMEOUT={idle_timeout}
	{% endif %}
	PAUSE_BASE
	{client.user_pause_macro|default("")}
	_TOOLHEAD_PARK_PAUSE_CANCEL {rawparams}

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = RESUME_BASE
variable_last_extruder_temp = {'restore': False, 'temp': 0}
variable_restore_idle_timeout = 0
variable_idle_state = False
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set sp_move = client.speed_move|default(velocity) %}
	{% set runout_resume = True if client.runout_sensor|default("") == ""
	else True if not printer[client.runout_sensor].enabled
	else printer[client.runout_sensor].filament_detected %}
	{% set can_extrude = True if printer.toolhead.extruder == ''
	else printer[printer.toolhead.extruder].can_extrude %}
	{% set do_resume = False %}
	{% set prompt_txt = [] %}
	
	
	{% if printer.idle_timeout.state|upper == "IDLE" or idle_state %}
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=idle_state VALUE=False
	{% if last_extruder_temp.restore %}
	
	RESPOND TYPE=echo MSG='{"Restoring \"%s\" temperature to %3.1f\u00B0C, this may take some time" % (printer.toolhead.extruder, last_extruder_temp.temp) }'
	M109 S{last_extruder_temp.temp}
	{% set do_resume = True %}
	{% elif can_extrude %}
	{% set do_resume = True %}
	{% else %}
	RESPOND TYPE=error MSG='{"Resume aborted !!! \"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder}'
	{% set _d = prompt_txt.append("\"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder) %}
	{% endif %}
	
	{% elif can_extrude %}
	{% set do_resume = True %}
	{% else %}
	RESPOND TYPE=error MSG='{"Resume aborted !!! \"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder}'
	{% set _d = prompt_txt.append("\"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder) %}
	{% endif %}
	{% if runout_resume %}
	{% if do_resume %}
	{% if restore_idle_timeout > 0 %} SET_IDLE_TIMEOUT TIMEOUT={restore_idle_timeout} {% endif %}
	{client.user_resume_macro|default("")}
	_CLIENT_EXTRUDE
	RESUME_BASE VELOCITY={params.VELOCITY|default(sp_move)}
	{% endif %}
	{% else %}
	RESPOND TYPE=error MSG='{"Resume aborted !!! \"%s\" detects no filament, please load filament and press RESUME" % (client.runout_sensor.split(" "))[1]}'
	{% set _d = prompt_txt.append("\"%s\" detects no filament, please load filament and press RESUME" % (client.runout_sensor.split(" "))[1]) %}
	{% endif %}
	
	{% if not (runout_resume and do_resume) %}
	RESPOND TYPE=command MSG="action:prompt_begin RESUME aborted !!!"
	{% for element in prompt_txt %}
	RESPOND TYPE=command MSG='{"action:prompt_text %s" % element}'
	{% endfor %}
	RESPOND TYPE=command MSG="action:prompt_footer_button Ok|RESPOND TYPE=command MSG=action:prompt_end|info"
	RESPOND TYPE=command MSG="action:prompt_show"
	{% endif %}

[gcode_macro SET_PAUSE_NEXT_LAYER]
description = Enable a pause if the next layer is reached
gcode = 
	{% set pause_next_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_next_layer %}
	{% set ENABLE = params.ENABLE|default(1)|int != 0 %}
	{% set MACRO = params.MACRO|default(pause_next_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_next_layer VALUE="{{ 'enable': ENABLE, 'call': MACRO }}"

[gcode_macro SET_PAUSE_AT_LAYER]
description = Enable/disable a pause if a given layer number is reached
gcode = 
	{% set pause_at_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_at_layer %}
	{% set ENABLE = params.ENABLE|int != 0 if params.ENABLE is defined
	else params.LAYER is defined %}
	{% set LAYER = params.LAYER|default(pause_at_layer.layer)|int %}
	{% set MACRO = params.MACRO|default(pause_at_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_at_layer VALUE="{{ 'enable': ENABLE, 'layer': LAYER, 'call': MACRO }}"

[gcode_macro SET_PRINT_STATS_INFO]
rename_existing = SET_PRINT_STATS_INFO_BASE
description = Overwrite, to get pause_next_layer and pause_at_layer feature
variable_pause_next_layer = { 'enable': False, 'call': "PAUSE" }
variable_pause_at_layer = { 'enable': False, 'layer': 0, 'call': "PAUSE" }
gcode = 
	{% if pause_next_layer.enable %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_next_layer" % pause_next_layer.call}'
	{pause_next_layer.call}
	SET_PAUSE_NEXT_LAYER ENABLE=0
	{% elif pause_at_layer.enable and params.CURRENT_LAYER is defined and params.CURRENT_LAYER|int == pause_at_layer.layer %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_at_layer [%d]" % (pause_at_layer.call, pause_at_layer.layer)}'
	{pause_at_layer.call}
	SET_PAUSE_AT_LAYER ENABLE=0
	{% endif %}
	SET_PRINT_STATS_INFO_BASE {rawparams}

[gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL]
description = Helper: park toolhead used in PAUSE and CANCEL_PRINT
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set use_custom     = client.use_custom_pos|default(false)|lower == 'true' %}
	{% set custom_park_x  = client.custom_park_x|default(0.0) %}
	{% set custom_park_y  = client.custom_park_y|default(0.0) %}
	{% set park_dz        = client.custom_park_dz|default(2.0)|abs %}
	{% set sp_hop         = client.speed_hop|default(15) * 60 %}
	{% set sp_move        = client.speed_move|default(velocity) * 60 %}
	
	{% set origin    = printer.gcode_move.homing_origin %}
	{% set act       = printer.gcode_move.gcode_position %}
	{% set max       = printer.toolhead.axis_maximum %}
	{% set cone      = printer.toolhead.cone_start_z|default(max.z) %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	
	{% set z_min = params.Z_MIN|default(0)|float %}
	{% set z_park = [[(act.z + park_dz), z_min]|max, (max.z - origin.z)]|min %}
	{% set x_park = params.X       if params.X is defined
	else custom_park_x  if use_custom
	else 0.0            if round_bed
	else (max.x - 5.0) %}
	{% set y_park = params.Y       if params.Y is defined
	else custom_park_y  if use_custom
	else (max.y - 5.0)  if round_bed and z_park < cone
	else 0.0            if round_bed
	else (max.y - 5.0) %}
	
	_CLIENT_RETRACT
	{% if "xyz" in printer.toolhead.homed_axes %}
	G90
	G1 Z{z_park} F{sp_hop}
	G1 X{x_park} Y{y_park} F{sp_move}
	{% if not printer.gcode_move.absolute_coordinates %} G91 {% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='Printer not homed'
	{% endif %}

[gcode_macro _CLIENT_EXTRUDE]
description = Extrudes, if the extruder is hot enough
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set use_fw_retract = (client.use_fw_retract|default(false)|lower == 'true') and (printer.firmware_retraction is defined) %}
	{% set length = params.LENGTH|default(client.unretract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_unretract)|default(35) %}
	{% set absolute_extrude = printer.gcode_move.absolute_extrude %}
	
	{% if printer.toolhead.extruder != '' %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if use_fw_retract %}
	{% if length < 0 %}
	G10
	{% else %}
	G11
	{% endif %}
	{% else %}
	M83
	G1 E{length} F{(speed|float|abs) * 60}
	{% if absolute_extrude %}
	M82
	{% endif %}
	{% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='{"\"%s\" not hot enough" % printer.toolhead.extruder}'
	{% endif %}
	{% endif %}

[gcode_macro _CLIENT_RETRACT]
description = Retracts, if the extruder is hot enough
gcode = 
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set length = params.LENGTH|default(client.retract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_retract)|default(35) %}
	
	_CLIENT_EXTRUDE LENGTH=-{length|float|abs} SPEED={speed|float|abs}

[gcode_macro START_PRINT]
gcode = 
	{% set BED_TEMP = params.BED_TEMP|default(55)|float %}
	{% set EXTRUDER_TEMP = params.EXTRUDER_TEMP|default(200)|float %}
	M117 Print Starting...
	G28 X Y
	G90
	M220 S100
	M221 S100
	G92 E0
	
	
	
	
	
	
	M140 S{BED_TEMP}
	
	M190 S{BED_TEMP}
	
	M117 Waiting for temperature
	
	
	M117 Homing All...
	
	G90
	
	G28
	
	M117 Z-Tilt Adjust
	Z_TILT_ADJUST
	
	M117 Generating mesh
	
	BED_MESH_CLEAR
	
	BED_MESH_CALIBRATE
	
	BED_MESH_PROFILE LOAD=default
	
	G1 X100 Y392 F10000
	
	M117 Heaters Recovering...
	
	
	M109 S{EXTRUDER_TEMP} T0; start warming extruder to preheat temp
	
	
	M117 Purging extruder...
	
	
	CLEAN_AND_PURGE_NOZZLE
	
	M117 Printing.....
	UPDATE_DELAYED_GCODE ID=clear_display DURATION=10

[gcode_macro END_PRINT]
gcode = 
	
	{% set th = printer.toolhead %}
	{% set x_safe = th.position.x + 20 * (1 if th.axis_maximum.x - th.position.x > 20 else -1) %}
	{% set y_safe = th.position.y + 20 * (1 if th.axis_maximum.y - th.position.y > 20 else -1) %}
	{% set z_safe = [th.position.z + 2, th.axis_maximum.z]|min %}
	
	SAVE_GCODE_STATE NAME=STATE_PRINT_END
	
	
	
	M400
	G92 E0
	
	G91
	G1 E-0.7 Z+5 F3000
	G90
	
	TURN_OFF_HEATERS
	
	G0 X{x_safe} Y{y_safe} Z{z_safe} F20000
	G0 X{th.axis_maximum.x//2} Y{th.axis_maximum.y - 2} F3600
	
	AFTER_PRINT_CLEAN_NOZZLE
	
	G0 X{th.axis_maximum.x/2} Y{th.axis_maximum.y - 2} F3600
	
	TURN_OFF_HEATERS
	
	M84 X Y E
	
	
	SET_PRESSURE_ADVANCE ADVANCE=0.0
	M117 Pressure Advance Set 0.0
	
	
	
	
	BED_MESH_CLEAR
	
	
	
	
	
	M117 Print Finished
	UPDATE_DELAYED_GCODE ID=clear_display DURATION=10
	
	RESTORE_GCODE_STATE NAME=STATE_PRINT_END

[gcode_macro PRIME_LINE]
gcode = 
	M117 Prime Line
	G92 E0
	
	G1 Z2.0 F3000
	
	G1 X40 Y2 Z0.3 F5000.0
	G1 X120 Y2 Z0.3 F500.0 E15
	G1 X120 Y2.3 Z0.3 F5000.0
	G1 X40 Y2.3 Z0.3 F500.0 E30
	G92 E0
	G1 Z2.0 F3000

[gcode_macro CLEAN_NOZZLE]
variable_start_x = 63
variable_start_y = 387
variable_wipe_dist_y = -3
variable_wipe_qty = 5
variable_wipe_spd = 50
variable_end_loc_x = 189
variable_end_loc_y = 185
gcode = 
	SAVE_GCODE_STATE NAME=STATE_PRINT_CURRENT
	
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	G90
	M220 S100
	M204 S100
	M221 S100
	
	
	G1 X{start_x} Y{start_y} F6000
	
	
	{% for wipes in range(1, (wipe_qty + 1)) %}
	
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	
	{% endfor %}
	
	G1 X{end_loc_x} F10000
	
	RESTORE_GCODE_STATE NAME=STATE_PRINT_CURRENT

[gcode_macro CLEAN_AND_PURGE_NOZZLE]
variable_start_x = 63
variable_start_y = 387
variable_start_z = 10
variable_wipe_dist_y = -3
variable_wipe_qty = 5
variable_wipe_spd = 50
variable_purge_loc_x = 100
variable_purge_loc_y = 392
variable_post_purge_y = 386
variable_end_loc_x = 189
variable_end_loc_y = 185
gcode = 
	SAVE_GCODE_STATE NAME=STATE_PRINT_CURRENT
	
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	G90
	
	
	
	
	
	G1 X{start_x} Y{start_y} F6000
	
	
	{% for wipes in range(1, (wipe_qty + 1)) %}
	
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	
	{% endfor %}
	
	G1 X{purge_loc_x}
	G1 Y{purge_loc_y}
	G92 E0
	G1 E30.0 F100
	G92 E0
	G1 E-0.5 F300
	
	G1 Y{post_purge_y} F10000
	G1 X{start_x}
	G1 X{end_loc_x} F10000
	
	RESTORE_GCODE_STATE NAME=STATE_PRINT_CURRENT

[gcode_macro AFTER_PRINT_CLEAN_NOZZLE]
variable_start_x = 63
variable_start_y = 387
variable_wipe_dist_y = -3
variable_wipe_qty = 5
variable_wipe_spd = 50
gcode = 
	SAVE_GCODE_STATE NAME=STATE_PRINT_CURRENT
	
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	G90
	
	
	
	
	G1 X{start_x} Y{start_y} F6000
	
	
	{% for wipes in range(1, (wipe_qty + 1)) %}
	
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	
	{% endfor %}
	
	RESTORE_GCODE_STATE NAME=STATE_PRINT_CURRENT

[delayed_gcode clear_display]
gcode = 
	M117

[gcode_macro Probe_Z_Height]
gcode = 
	G28
	
	PROBE_CALIBRATE

[gcode_macro automatic_bed_screw_adjust]
gcode = 
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	SCREWS_TILT_CALCULATE

[gcode_macro z_motor_alignment]
gcode = 
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	Z_TILT_ADJUST

[gcode_macro Accelerometer_Connection_Test]
gcode = 
	ACCELEROMETER_QUERY

[gcode_macro X_Axis_Resonance_Test]
gcode = 
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	TEST_RESONANCES AXIS=X

[gcode_macro Y_Axis_Resonance_Test]
gcode = 
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	TEST_RESONANCES AXIS=Y

[gcode_macro BED_MESH_CALIBRATE]
rename_existing = _BED_MESH_CALIBRATE
gcode = 
	
	{% set all_points = printer.exclude_object.objects | map(attribute='polygon') | sum(start=[]) %}
	{% set bed_mesh_min = printer.configfile.settings.bed_mesh.mesh_min %}
	{% set bed_mesh_max = printer.configfile.settings.bed_mesh.mesh_max %}
	{% set probe_count = printer.configfile.settings.bed_mesh.probe_count %}
	{% set kamp_settings = printer["gcode_macro _KAMP_Settings"] %}
	{% set verbose_enable = kamp_settings.verbose_enable | abs %}
	{% set probe_dock_enable = kamp_settings.probe_dock_enable | abs %}
	{% set attach_macro = kamp_settings.attach_macro | string %}
	{% set detach_macro = kamp_settings.detach_macro | string %}
	{% set mesh_margin = kamp_settings.mesh_margin | float %}
	{% set fuzz_amount = kamp_settings.fuzz_amount | float %}
	{% set probe_count = probe_count if probe_count|length > 1 else probe_count * 2  %}
	{% set max_probe_point_distance_x = ( bed_mesh_max[0] - bed_mesh_min[0] ) / (probe_count[0] - 1)  %}
	{% set max_probe_point_distance_y = ( bed_mesh_max[1] - bed_mesh_min[1] ) / (probe_count[1] - 1)  %}
	{% set x_min = all_points | map(attribute=0) | min | default(bed_mesh_min[0]) %}
	{% set y_min = all_points | map(attribute=1) | min | default(bed_mesh_min[1]) %}
	{% set x_max = all_points | map(attribute=0) | max | default(bed_mesh_max[0]) %}
	{% set y_max = all_points | map(attribute=1) | max | default(bed_mesh_max[1]) %}
	
	{% set fuzz_range = range((0) | int, (fuzz_amount * 100) | int + 1) %}
	{% set adapted_x_min = x_min - mesh_margin - (fuzz_range | random / 100.0) %}
	{% set adapted_y_min = y_min - mesh_margin - (fuzz_range | random / 100.0) %}
	{% set adapted_x_max = x_max + mesh_margin + (fuzz_range | random / 100.0) %}
	{% set adapted_y_max = y_max + mesh_margin + (fuzz_range | random / 100.0) %}
	
	{% set adapted_x_min = [adapted_x_min , bed_mesh_min[0]] | max %}
	{% set adapted_y_min = [adapted_y_min , bed_mesh_min[1]] | max %}
	{% set adapted_x_max = [adapted_x_max , bed_mesh_max[0]] | min %}
	{% set adapted_y_max = [adapted_y_max , bed_mesh_max[1]] | min %}
	
	{% set points_x = (((adapted_x_max - adapted_x_min) / max_probe_point_distance_x) | round(method='ceil') | int) + 1 %}
	{% set points_y = (((adapted_y_max - adapted_y_min) / max_probe_point_distance_y) | round(method='ceil') | int) + 1 %}
	
	{% if (([points_x, points_y]|max) > 6) %}
	{% set algorithm = "bicubic" %}
	{% set min_points = 4 %}
	{% else %}
	{% set algorithm = "lagrange" %}
	{% set min_points = 3 %}
	{% endif %}
	
	{% set points_x = [points_x , min_points]|max %}
	{% set points_y = [points_y , min_points]|max %}
	{% set points_x = [points_x , probe_count[0]]|min %}
	{% set points_y = [points_y , probe_count[1]]|min %}
	
	{% if verbose_enable == True %}
	{% if printer.exclude_object.objects != [] %}
	
	{ action_respond_info( "Algorithm: {}.".format(
	(algorithm),
	)) }
	
	{ action_respond_info("Default probe count: {},{}.".format(
	(probe_count[0]),
	(probe_count[1]),
	)) }
	
	{ action_respond_info("Adapted probe count: {},{}.".format(
	(points_x),
	(points_y),
	)) }
	
	{action_respond_info("Default mesh bounds: {}, {}.".format(
	(bed_mesh_min[0],bed_mesh_min[1]),
	(bed_mesh_max[0],bed_mesh_max[1]),
	)) }
	
	{% if mesh_margin > 0 %}
	{action_respond_info("Mesh margin is {}, mesh bounds extended by {}mm.".format(
	(mesh_margin),
	(mesh_margin),
	)) }
	{% else %}
	{action_respond_info("Mesh margin is 0, margin not increased.")}
	{% endif %}
	
	{% if fuzz_amount > 0 %}
	{action_respond_info("Mesh point fuzzing enabled, points fuzzed up to {}mm.".format(
	(fuzz_amount),
	)) }
	{% else %}
	{action_respond_info("Fuzz amount is 0, mesh points not fuzzed.")}
	{% endif %}
	
	{ action_respond_info("Adapted mesh bounds: {}, {}.".format(
	(adapted_x_min, adapted_y_min),
	(adapted_x_max, adapted_y_max),
	)) }
	
	{action_respond_info("KAMP adjustments successful. Happy KAMPing!")}
	
	{% else %}
	
	{action_respond_info("No objects detected! Check your gcode and make sure that EXCLUDE_OBJECT_DEFINE is happening before BED_MESH_CALIBRATE is called. Defaulting to regular meshing.")}
	G4 P5000
	{% endif %}
	
	{% endif %}
	
	{% if probe_dock_enable == True %}
	{attach_macro}
	{% endif %}
	
	_BED_MESH_CALIBRATE mesh_min={adapted_x_min},{adapted_y_min} mesh_max={adapted_x_max},{adapted_y_max} ALGORITHM={algorithm} PROBE_COUNT={points_x},{points_y}
	
	{% if probe_dock_enable == True %}
	{detach_macro}
	{% endif %}

[gcode_macro _KAMP_Settings]
description = This macro contains all adjustable settings for KAMP
variable_verbose_enable = True
variable_mesh_margin = 0
variable_fuzz_amount = 0
variable_probe_dock_enable = False
variable_attach_macro = 'Attach_Probe'
variable_detach_macro = 'Dock_Probe'
variable_purge_height = 0.8
variable_tip_distance = 0
variable_purge_margin = 10
variable_purge_amount = 30
variable_flow_rate = 12
variable_smart_park_height = 10
gcode = 
	
	{action_respond_info(" Running the KAMP_Settings macro does nothing, it is only used for storing KAMP settings. ")}

[led_effect sb_logo_busy]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (1,0,0)

[led_effect sb_logo_cleaning]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 0.02, 0.5)

[led_effect sb_logo_calibrating_z]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 0.0, 0.35)

[led_effect sb_logo_heating]
leds = 
	neopixel:sb_leds (1,3,7,8,6,2)
autostart = false
frame_rate = 24
layers = 
	comet  0.3  0 add (1, 0.18, 0)

[led_effect sb_logo_cooling]
leds = 
	neopixel:sb_leds (1,3,7,8,6,2)
autostart = false
frame_rate = 24
layers = 
	comet  0.3  0 add (0, 0, 1)

[led_effect sb_logo_homing]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 0.6, 0.2)

[led_effect sb_logo_leveling]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.5, 0.1, 0.4)

[led_effect sb_logo_meshing]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.2, 1.0, 0.0)

[led_effect sb_logo_printing]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	gradient  0.3  1 add (0.3, 0.0, 0.0),(0.3, 0.3, 0.0),(0.3, 0.1, 0.0)

[led_effect sb_logo_standby]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.01, 0.01, 0.01)

[led_effect sb_logo_part_ready]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 1.0, 0.0)

[led_effect sb_nozzle_heating]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (1.0, 0.18, 0.0, 0.0)

[led_effect sb_nozzle_cooling]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (0.0, 0.0, 1.0, 0.1)

[led_effect sb_nozzle_standby]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (0.6, 0.0, 0.0, 0.0)

[led_effect sb_nozzle_part_ready]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (0.6, 1.0, 0.0, 0.1)

[led_effect sb_critical_error]
leds = 
	neopixel:sb_leds
layers = 
	strobe         1  1.5   add        (1.0,  1.0, 1.0)
	breathing      2  0     difference (0.95, 0.0, 0.0)
	static         1  0     top        (1.0,  0.0, 0.0)
autostart = false
frame_rate = 24
run_on_error = true

[led_effect rainbow]
leds = 
	neopixel:chamber_leds
autostart = false
frame_rate = 24
layers = 
	gradient  0.3  1 add (0.3, 0.0, 0.0),(0.0, 0.3, 0.0),(0.0, 0.0, 0.3)

[led_effect set_nozzle_leds]
leds = 
	neopixel:sb_leds (9,10)
autostart = false
frame_rate = 24
layers = 
	static         0  0     top        (0.0,  0.0, 0.0, 1.0)

[led_effect set_logo_leds]
leds = 
	neopixel:sb_leds (1,2,3,4,5,6,7,8)
autostart = false
frame_rate = 24
layers = 
	static         0  0     top        (1.0,  1.0, 1.0)

[led_effect set_chamber_leds]
leds = 
	neopixel:chamber_leds
autostart = false
frame_rate = 24
layers = 
	static         0  0     top        (1.0,  1.0, 1.0)

[gcode_macro set_logo_leds_off]
gcode = 
	SET_LED_EFFECT EFFECT=set_logo_leds STOP=1

[gcode_macro set_logo_leds_on]
gcode = 
	SET_LED_EFFECT EFFECT=set_logo_leds

[gcode_macro set_nozzle_leds_on]
gcode = 
	SET_LED_EFFECT EFFECT=set_nozzle_leds

[gcode_macro set_nozzle_leds_off]
gcode = 
	SET_LED_EFFECT EFFECT=set_nozzle_leds STOP=1

[gcode_macro set_chamber_leds_off]
gcode = 
	SET_LED_EFFECT EFFECT=set_chamber_leds STOP=1

[gcode_macro set_chamber_leds_on]
gcode = 
	SET_LED_EFFECT EFFECT=set_chamber_leds

[gcode_macro status_off]
gcode = 
	STOP_LED_EFFECTS

[gcode_macro status_ready]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=rainbow

[gcode_macro status_part_ready]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_nozzle_part_ready
	SET_LED_EFFECT EFFECT=sb_logo_part_ready

[gcode_macro status_busy]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_busy
	set_nozzle_leds_on

[gcode_macro status_heating]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_heating
	SET_LED_EFFECT EFFECT=sb_nozzle_heating

[gcode_macro status_cooling]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_cooling
	SET_LED_EFFECT EFFECT=sb_nozzle_cooling

[gcode_macro status_leveling]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_leveling
	set_nozzle_leds_on

[gcode_macro status_homing]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_homing
	set_nozzle_leds_on

[gcode_macro status_cleaning]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_cleaning
	set_nozzle_leds_on

[gcode_macro status_meshing]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_meshing
	set_nozzle_leds_on

[gcode_macro status_calibrating_z]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_calibrating_z
	set_nozzle_leds_on

[gcode_macro status_printing]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_printing
	set_nozzle_leds_on

[printer]
kinematics = corexy
max_velocity = 300
max_accel = 5700
max_z_velocity = 5
max_z_accel = 100
square_corner_velocity = 5.0

[mcu]
serial = /dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00

[mcu rpi]
serial = /tmp/klipper_host_mcu

[adxl345]
cs_pin = rpi:None

[resonance_tester]
accel_chip = adxl345
probe_points = 
	189,185,20

[input_shaper]
shaper_freq_x = 61.8
shaper_type_x = mzv
shaper_freq_y = 38.4
shaper_type_y = zv

[stepper_x]
step_pin = P1.4
dir_pin = !P1.8
enable_pin = !P1.0
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 40
endstop_pin = ^P1.29
position_endstop = 383
position_min = -5
position_max = 383
homing_speed = 25
homing_retract_dist = 5.0

[tmc2209 stepper_x]
uart_pin = P1.1
interpolate = False
run_current = 1.00
stealthchop_threshold = 0

[stepper_y]
step_pin = P1.14
dir_pin = !P1.15
enable_pin = !P1.9
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 40
endstop_pin = ^P1.28
position_endstop = 392
position_min = -8
position_max = 392
homing_speed = 25
homing_retract_dist = 5.0

[tmc2209 stepper_y]
uart_pin = P1.10
interpolate = False
run_current = 1.00
stealthchop_threshold = 0

[stepper_z]
step_pin = P4.29
dir_pin = !P4.28
enable_pin = !P1.16
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 4
endstop_pin = probe:z_virtual_endstop
position_min = -5
position_max = 395

[tmc2209 stepper_z]
uart_pin = P1.17
interpolate = False
run_current = 0.580
stealthchop_threshold = 0

[stepper_z1]
step_pin = P2.11
dir_pin = !P2.12
enable_pin = !P0.21
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 4

[tmc2209 stepper_z1]
uart_pin = P0.22
interpolate = False
run_current = 0.580
stealthchop_threshold = 0

[extruder]
step_pin = P2.6
dir_pin = !P2.7
enable_pin = !P0.4
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 35.291
gear_ratio = 7.5:1
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = P2.3
sensor_type = PT1000
sensor_pin = P0.24
control = pid
pid_kp = 14.430
pid_ki = 1.023
pid_kd = 50.866
min_temp = 10
max_temp = 350
max_extrude_only_distance = 500
max_extrude_only_velocity = 120
min_extrude_temp = 180
max_extrude_cross_section = 50.
pressure_advance = 0.000
pressure_advance_smooth_time = 0.03

[tmc2209 extruder]
uart_pin = P0.5
interpolate = false
run_current = 0.79
stealthchop_threshold = 0
driver_tbl = 0
driver_hend = 6
driver_hstrt = 7
driver_toff = 4

[static_digital_output tmc_standby_pins]
pins = !P3.26, !P3.25, !P1.18, !P1.19, !P2.13

[heater_bed]
heater_pin = P2.5
sensor_type = EPCOS 100K B57560G104F
sensor_pin = P0.25
control = pid
pid_kp = 68.561
pid_ki = 0.619
pid_kd = 1897.417
min_temp = 0
max_temp = 130

[idle_timeout]
timeout = 3600

[bltouch]
sensor_pin = ^P1.27
control_pin = P1.23
x_offset = -33
y_offset = -5
z_offset = 2.500
samples = 1
samples_result = average
sample_retract_dist = 2.0
samples_tolerance = 0.05
samples_tolerance_retries = 3
stow_on_each_sample = False

[safe_z_home]
home_xy_position = 221,190
speed = 60
z_hop = 12
z_hop_speed = 5

[screws_tilt_adjust]
screw1 = 69, 319
screw1_name = rear left screw
screw2 = 368, 60
screw2_name = front right screw
screw3 = 368, 319
screw3_name = rear right screw
screw4 = 69, 60
screw4_name = front left screw
horizontal_move_z = 10.
speed = 50.
screw_thread = CW-M4

[z_tilt]
z_positions = -20, 183
	402, 183
points = 56, 183
	383, 183
speed = 50
horizontal_move_z = 10
retries = 20
retry_tolerance = 0.01

[bed_mesh]
speed = 120
horizontal_move_z = 5
mesh_min = 50, 80
mesh_max = 323, 314
probe_count = 7, 7
algorithm = bicubic
bicubic_tension = 0.5
fade_start = 0.6
fade_end = 10
fade_target = 0

[fan]
pin = P2.1

[heater_fan heatbreak_cooling_fan]
pin = P2.2

[display]
lcd_type = st7920
menu_timeout = 600
cs_pin = EXP1_7
sclk_pin = EXP1_6
sid_pin = EXP1_8
encoder_pins = ^EXP1_5, ^EXP1_3
click_pin = ^!EXP1_2

[output_pin beeper]
pin = EXP1_1

[board_pins]
aliases = 
	
	EXP1_1=P2.8,  EXP1_3=P0.19, EXP1_5=P0.20, EXP1_7=P0.17, EXP1_9=<GND>,
	EXP1_2=P0.16, EXP1_4=<RST>, EXP1_6=P0.15, EXP1_8=P0.18, EXP1_10=<5V>

[filament_motion_sensor SmartFilamentSensor_T0]
detection_length = 7.00
extruder = extruder
switch_pin = ^P1.26
pause_on_runout = True
event_delay = 3.0
pause_delay = 0.5
runout_gcode = 
	M117 Runout Detected!

[temperature_sensor raspberry_pi]
sensor_type = temperature_host
min_temp = 10
max_temp = 100

[temperature_sensor Mainboard]
sensor_type = NTC 100K MGB18-104F39050L32
sensor_pin = P1.30
min_temp = 10
max_temp = 100

[neopixel chamber_leds]
pin = P1.22
chain_count = 85
color_order = GRB
initial_red = 0.0
initial_green = 0.0
initial_blue = 0.0
initial_white = 0.0

[neopixel sb_leds]
pin = P1.24
chain_count = 10
color_order = GRB,GRB,GRB,GRB,GRB,GRB,GRB,GRB,GRBW,GRBW
initial_red = 0.0
initial_green = 0.0
initial_blue = 0.0
initial_white = 0.0

[exclude_object]

[gcode_arcs]
resolution = 0.1
=======================
Extruder max_extrude_ratio=20.787584
mcu 'mcu': Starting serial connect
webhooks client 4123021520: New connection
webhooks client 4123021520: Client info {'program': 'Moonraker', 'version': 'v0.8.0-247-g3008a13'}
Loaded MCU 'mcu' 105 commands (v0.11.0-205-g5f0d252b / gcc: (15:8-2019-q3-1+b1) 8.3.1 20190703 (release) [gcc-8-branch revision 273027] binutils: (2.34-4+rpi1+14) 2.34)
MCU 'mcu' config: ADC_MAX=4095 BUS_PINS_i2c0=P0.28,P0.27 BUS_PINS_i2c1=P0.1,P0.0 BUS_PINS_i2c1a=P0.20,P0.19 BUS_PINS_i2c2=P0.11,P0.10 BUS_PINS_ssp0=P0.17,P0.18,P0.15 BUS_PINS_ssp1=P0.8,P0.9,P0.7 CLOCK_FREQ=120000000 MCU=lpc1769 PWM_MAX=255 RESERVE_PINS_USB=P0.30,P0.29,P2.9 STATS_SUMSQ_BASE=256 STEPPER_BOTH_EDGE=1
mcu 'rpi': Starting connect
Loaded MCU 'rpi' 113 commands (v0.11.0-240-g6d48adf9 / gcc: (Raspbian 10.2.1-6+rpi1) 10.2.1 20210110 binutils: (GNU Binutils for Raspbian) 2.35.2)
MCU 'rpi' config: ADC_MAX=4095 CLOCK_FREQ=50000000 MCU=linux PCA9685_MAX=4096 PWM_MAX=32768 STATS_SUMSQ_BASE=256
Sending MCU 'mcu' printer configuration...
Configured MCU 'mcu' (1024 moves)
Sending MCU 'rpi' printer configuration...
Configured MCU 'rpi' (1024 moves)
Starting heater checks for heater_bed
bed_mesh: generated points
Index |  Tool Adjusted  |   Probe
  0   | (83.0, 85.0)    | (50.0, 80.0)
  1   | (128.5, 85.0)   | (95.5, 80.0)
  2   | (174.0, 85.0)   | (141.0, 80.0)
  3   | (219.5, 85.0)   | (186.5, 80.0)
  4   | (265.0, 85.0)   | (232.0, 80.0)
  5   | (310.5, 85.0)   | (277.5, 80.0)
  6   | (356.0, 85.0)   | (323.0, 80.0)
  7   | (356.0, 124.0)  | (323.0, 119.0)
  8   | (310.5, 124.0)  | (277.5, 119.0)
  9   | (265.0, 124.0)  | (232.0, 119.0)
  10  | (219.5, 124.0)  | (186.5, 119.0)
  11  | (174.0, 124.0)  | (141.0, 119.0)
  12  | (128.5, 124.0)  | (95.5, 119.0)
  13  | (83.0, 124.0)   | (50.0, 119.0)
  14  | (83.0, 163.0)   | (50.0, 158.0)
  15  | (128.5, 163.0)  | (95.5, 158.0)
  16  | (174.0, 163.0)  | (141.0, 158.0)
  17  | (219.5, 163.0)  | (186.5, 158.0)
  18  | (265.0, 163.0)  | (232.0, 158.0)
  19  | (310.5, 163.0)  | (277.5, 158.0)
  20  | (356.0, 163.0)  | (323.0, 158.0)
  21  | (356.0, 202.0)  | (323.0, 197.0)
  22  | (310.5, 202.0)  | (277.5, 197.0)
  23  | (265.0, 202.0)  | (232.0, 197.0)
  24  | (219.5, 202.0)  | (186.5, 197.0)
  25  | (174.0, 202.0)  | (141.0, 197.0)
  26  | (128.5, 202.0)  | (95.5, 197.0)
  27  | (83.0, 202.0)   | (50.0, 197.0)
  28  | (83.0, 241.0)   | (50.0, 236.0)
  29  | (128.5, 241.0)  | (95.5, 236.0)
  30  | (174.0, 241.0)  | (141.0, 236.0)
  31  | (219.5, 241.0)  | (186.5, 236.0)
  32  | (265.0, 241.0)  | (232.0, 236.0)
  33  | (310.5, 241.0)  | (277.5, 236.0)
  34  | (356.0, 241.0)  | (323.0, 236.0)
  35  | (356.0, 280.0)  | (323.0, 275.0)
  36  | (310.5, 280.0)  | (277.5, 275.0)
  37  | (265.0, 280.0)  | (232.0, 275.0)
  38  | (219.5, 280.0)  | (186.5, 275.0)
  39  | (174.0, 280.0)  | (141.0, 275.0)
  40  | (128.5, 280.0)  | (95.5, 275.0)
  41  | (83.0, 280.0)   | (50.0, 275.0)
  42  | (83.0, 319.0)   | (50.0, 314.0)
  43  | (128.5, 319.0)  | (95.5, 314.0)
  44  | (174.0, 319.0)  | (141.0, 314.0)
  45  | (219.5, 319.0)  | (186.5, 314.0)
  46  | (265.0, 319.0)  | (232.0, 314.0)
  47  | (310.5, 319.0)  | (277.5, 314.0)
  48  | (356.0, 319.0)  | (323.0, 314.0)
Starting heater checks for extruder
Stats 1532.1: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=5015 bytes_read=6276 bytes_retransmit=9 bytes_invalid=0 send_seq=304 receive_seq=292 retransmit_seq=2 srtt=0.001 rttvar=0.002 rto=0.025 ready_bytes=995 upcoming_bytes=172 freq=119995088 rpi: mcu_awake=0.003 mcu_task_avg=0.000023 mcu_task_stddev=0.000014 bytes_write=841 bytes_read=4530 bytes_retransmit=0 bytes_invalid=0 send_seq=114 receive_seq=114 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49995399 adj=49995077  heater_bed: target=0 temp=17.7 pwm=0.000 raspberry_pi: temp=37.5 Mainboard: temp=21.1 sysload=0.14 cputime=3.765 memavail=3467220 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.5 pwm=0.000
webhooks: registering remote method 'shutdown_machine' for connection id: 4123021520
webhooks: registering remote method 'reboot_machine' for connection id: 4123021520
webhooks: registering remote method 'pause_job_queue' for connection id: 4123021520
webhooks: registering remote method 'start_job_queue' for connection id: 4123021520
Stats 1533.1: gcodein=0  mcu: mcu_awake=0.060 mcu_task_avg=0.000050 mcu_task_stddev=0.000187 bytes_write=6303 bytes_read=6646 bytes_retransmit=9 bytes_invalid=0 send_seq=328 receive_seq=328 retransmit_seq=2 srtt=0.004 rttvar=0.005 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995335 rpi: mcu_awake=0.003 mcu_task_avg=0.000023 mcu_task_stddev=0.000014 bytes_write=847 bytes_read=4546 bytes_retransmit=0 bytes_invalid=0 send_seq=115 receive_seq=115 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49995957 adj=49998491  heater_bed: target=0 temp=17.7 pwm=0.000 raspberry_pi: temp=37.0 Mainboard: temp=21.0 sysload=0.14 cputime=3.813 memavail=3466500 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.8 pwm=0.000
Stats 1534.1: gcodein=0  mcu: mcu_awake=0.060 mcu_task_avg=0.000050 mcu_task_stddev=0.000187 bytes_write=6309 bytes_read=6808 bytes_retransmit=9 bytes_invalid=0 send_seq=329 receive_seq=329 retransmit_seq=2 srtt=0.003 rttvar=0.005 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995774 rpi: mcu_awake=0.003 mcu_task_avg=0.000023 mcu_task_stddev=0.000014 bytes_write=853 bytes_read=4562 bytes_retransmit=0 bytes_invalid=0 send_seq=116 receive_seq=116 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49997135 adj=49998989  heater_bed: target=0 temp=17.8 pwm=0.000 raspberry_pi: temp=36.5 Mainboard: temp=21.0 sysload=0.14 cputime=3.860 memavail=3466276 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.4 pwm=0.000
Stats 1535.1: gcodein=0  mcu: mcu_awake=0.060 mcu_task_avg=0.000050 mcu_task_stddev=0.000187 bytes_write=6315 bytes_read=6956 bytes_retransmit=9 bytes_invalid=0 send_seq=330 receive_seq=330 retransmit_seq=2 srtt=0.003 rttvar=0.004 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995917 rpi: mcu_awake=0.003 mcu_task_avg=0.000023 mcu_task_stddev=0.000014 bytes_write=859 bytes_read=4578 bytes_retransmit=0 bytes_invalid=0 send_seq=117 receive_seq=117 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49997212 adj=50000624  heater_bed: target=0 temp=17.7 pwm=0.000 raspberry_pi: temp=36.5 Mainboard: temp=21.0 sysload=0.14 cputime=3.891 memavail=3465672 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.5 pwm=0.000
Stats 1536.1: gcodein=0  mcu: mcu_awake=0.060 mcu_task_avg=0.000050 mcu_task_stddev=0.000187 bytes_write=6327 bytes_read=7150 bytes_retransmit=9 bytes_invalid=0 send_seq=332 receive_seq=332 retransmit_seq=2 srtt=0.002 rttvar=0.003 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995480 rpi: mcu_awake=0.003 mcu_task_avg=0.000023 mcu_task_stddev=0.000014 bytes_write=865 bytes_read=4594 bytes_retransmit=0 bytes_invalid=0 send_seq=118 receive_seq=118 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996931 adj=50000222  heater_bed: target=0 temp=17.7 pwm=0.000 raspberry_pi: temp=37.5 Mainboard: temp=21.1 sysload=0.14 cputime=3.911 memavail=3459040 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=20.0 pwm=0.000
Stats 1537.1: gcodein=0  mcu: mcu_awake=0.060 mcu_task_avg=0.000050 mcu_task_stddev=0.000187 bytes_write=6333 bytes_read=7312 bytes_retransmit=9 bytes_invalid=0 send_seq=333 receive_seq=333 retransmit_seq=2 srtt=0.002 rttvar=0.003 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995400 rpi: mcu_awake=0.001 mcu_task_avg=0.000013 mcu_task_stddev=0.000016 bytes_write=871 bytes_read=4623 bytes_retransmit=0 bytes_invalid=0 send_seq=119 receive_seq=119 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996931 adj=49999677  heater_bed: target=0 temp=17.7 pwm=0.000 raspberry_pi: temp=39.4 Mainboard: temp=21.0 sysload=0.29 cputime=3.932 memavail=3458232 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.9 pwm=0.000
Stats 1538.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6339 bytes_read=7474 bytes_retransmit=9 bytes_invalid=0 send_seq=334 receive_seq=334 retransmit_seq=2 srtt=0.002 rttvar=0.003 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995362 rpi: mcu_awake=0.001 mcu_task_avg=0.000013 mcu_task_stddev=0.000016 bytes_write=877 bytes_read=4639 bytes_retransmit=0 bytes_invalid=0 send_seq=120 receive_seq=120 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996852 adj=49999552  heater_bed: target=0 temp=17.8 pwm=0.000 raspberry_pi: temp=38.9 Mainboard: temp=20.9 sysload=0.29 cputime=3.952 memavail=3446388 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.6 pwm=0.000
Stats 1539.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6345 bytes_read=7652 bytes_retransmit=9 bytes_invalid=0 send_seq=335 receive_seq=335 retransmit_seq=2 srtt=0.002 rttvar=0.002 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995337 rpi: mcu_awake=0.001 mcu_task_avg=0.000013 mcu_task_stddev=0.000016 bytes_write=883 bytes_read=4655 bytes_retransmit=0 bytes_invalid=0 send_seq=121 receive_seq=121 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996801 adj=49999196  heater_bed: target=0 temp=17.7 pwm=0.000 raspberry_pi: temp=38.9 Mainboard: temp=21.1 sysload=0.29 cputime=3.973 memavail=3435328 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=20.1 pwm=0.000
Stats 1540.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6351 bytes_read=7814 bytes_retransmit=9 bytes_invalid=0 send_seq=336 receive_seq=336 retransmit_seq=2 srtt=0.001 rttvar=0.002 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995315 rpi: mcu_awake=0.001 mcu_task_avg=0.000013 mcu_task_stddev=0.000016 bytes_write=889 bytes_read=4671 bytes_retransmit=0 bytes_invalid=0 send_seq=122 receive_seq=122 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996760 adj=49998966  heater_bed: target=0 temp=17.6 pwm=0.000 raspberry_pi: temp=38.5 Mainboard: temp=21.0 sysload=0.29 cputime=3.994 memavail=3429332 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=20.1 pwm=0.000
Stats 1541.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6357 bytes_read=7962 bytes_retransmit=9 bytes_invalid=0 send_seq=337 receive_seq=337 retransmit_seq=2 srtt=0.001 rttvar=0.002 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995286 rpi: mcu_awake=0.001 mcu_task_avg=0.000013 mcu_task_stddev=0.000016 bytes_write=895 bytes_read=4687 bytes_retransmit=0 bytes_invalid=0 send_seq=123 receive_seq=123 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996693 adj=49998808  heater_bed: target=0 temp=17.7 pwm=0.000 raspberry_pi: temp=38.5 Mainboard: temp=21.0 sysload=0.29 cputime=4.017 memavail=3467956 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.8 pwm=0.000
Stats 1542.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6363 bytes_read=8140 bytes_retransmit=9 bytes_invalid=0 send_seq=338 receive_seq=338 retransmit_seq=2 srtt=0.001 rttvar=0.002 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995261 rpi: mcu_awake=0.001 mcu_task_avg=0.000011 mcu_task_stddev=0.000012 bytes_write=901 bytes_read=4716 bytes_retransmit=0 bytes_invalid=0 send_seq=124 receive_seq=124 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996628 adj=49998590  heater_bed: target=0 temp=17.8 pwm=0.000 raspberry_pi: temp=38.9 Mainboard: temp=21.0 sysload=0.42 cputime=4.038 memavail=3462664 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=20.0 pwm=0.000
Stats 1543.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6369 bytes_read=8316 bytes_retransmit=9 bytes_invalid=0 send_seq=339 receive_seq=339 retransmit_seq=2 srtt=0.001 rttvar=0.002 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995235 rpi: mcu_awake=0.001 mcu_task_avg=0.000011 mcu_task_stddev=0.000012 bytes_write=907 bytes_read=4732 bytes_retransmit=0 bytes_invalid=0 send_seq=125 receive_seq=125 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996588 adj=49998403  heater_bed: target=0 temp=17.7 pwm=0.000 raspberry_pi: temp=39.4 Mainboard: temp=21.1 sysload=0.42 cputime=4.057 memavail=3462856 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.9 pwm=0.000
Stats 1544.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6375 bytes_read=8479 bytes_retransmit=9 bytes_invalid=0 send_seq=340 receive_seq=340 retransmit_seq=2 srtt=0.001 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995198 rpi: mcu_awake=0.001 mcu_task_avg=0.000011 mcu_task_stddev=0.000012 bytes_write=913 bytes_read=4748 bytes_retransmit=0 bytes_invalid=0 send_seq=126 receive_seq=126 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996575 adj=49998337  heater_bed: target=0 temp=17.7 pwm=0.000 raspberry_pi: temp=38.0 Mainboard: temp=21.0 sysload=0.42 cputime=4.076 memavail=3463356 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.5 pwm=0.000
Stats 1545.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6381 bytes_read=8642 bytes_retransmit=9 bytes_invalid=0 send_seq=341 receive_seq=341 retransmit_seq=2 srtt=0.001 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995194 rpi: mcu_awake=0.001 mcu_task_avg=0.000011 mcu_task_stddev=0.000012 bytes_write=919 bytes_read=4764 bytes_retransmit=0 bytes_invalid=0 send_seq=127 receive_seq=127 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996570 adj=49998406  heater_bed: target=0 temp=17.7 pwm=0.000 raspberry_pi: temp=38.9 Mainboard: temp=21.1 sysload=0.42 cputime=4.096 memavail=3466320 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.6 pwm=0.000
Stats 1546.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6387 bytes_read=8804 bytes_retransmit=9 bytes_invalid=0 send_seq=342 receive_seq=342 retransmit_seq=2 srtt=0.001 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995183 rpi: mcu_awake=0.001 mcu_task_avg=0.000011 mcu_task_stddev=0.000012 bytes_write=925 bytes_read=4780 bytes_retransmit=0 bytes_invalid=0 send_seq=128 receive_seq=128 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996564 adj=49998434  heater_bed: target=0 temp=17.6 pwm=0.000 raspberry_pi: temp=38.9 Mainboard: temp=21.0 sysload=0.42 cputime=4.117 memavail=3460676 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=20.0 pwm=0.000
Stats 1547.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6393 bytes_read=8967 bytes_retransmit=9 bytes_invalid=0 send_seq=343 receive_seq=343 retransmit_seq=2 srtt=0.001 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995173 rpi: mcu_awake=0.001 mcu_task_avg=0.000010 mcu_task_stddev=0.000010 bytes_write=931 bytes_read=4809 bytes_retransmit=0 bytes_invalid=0 send_seq=129 receive_seq=129 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996539 adj=49998461  heater_bed: target=0 temp=17.7 pwm=0.000 raspberry_pi: temp=38.9 Mainboard: temp=21.1 sysload=0.39 cputime=4.137 memavail=3463476 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.7 pwm=0.000
Stats 1548.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6399 bytes_read=9144 bytes_retransmit=9 bytes_invalid=0 send_seq=344 receive_seq=344 retransmit_seq=2 srtt=0.001 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995165 rpi: mcu_awake=0.001 mcu_task_avg=0.000010 mcu_task_stddev=0.000010 bytes_write=937 bytes_read=4825 bytes_retransmit=0 bytes_invalid=0 send_seq=130 receive_seq=130 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996535 adj=49998391  heater_bed: target=0 temp=17.7 pwm=0.000 raspberry_pi: temp=38.9 Mainboard: temp=21.1 sysload=0.39 cputime=4.154 memavail=3467524 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.6 pwm=0.000
Stats 1549.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6405 bytes_read=9306 bytes_retransmit=9 bytes_invalid=0 send_seq=345 receive_seq=345 retransmit_seq=2 srtt=0.001 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995161 rpi: mcu_awake=0.001 mcu_task_avg=0.000010 mcu_task_stddev=0.000010 bytes_write=943 bytes_read=4841 bytes_retransmit=0 bytes_invalid=0 send_seq=131 receive_seq=131 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996519 adj=49998426  heater_bed: target=0 temp=17.7 pwm=0.000 raspberry_pi: temp=38.0 Mainboard: temp=21.0 sysload=0.39 cputime=4.170 memavail=3466768 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.7 pwm=0.000
Stats 1550.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6411 bytes_read=9469 bytes_retransmit=9 bytes_invalid=0 send_seq=346 receive_seq=346 retransmit_seq=2 srtt=0.000 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995155 rpi: mcu_awake=0.001 mcu_task_avg=0.000010 mcu_task_stddev=0.000010 bytes_write=949 bytes_read=4857 bytes_retransmit=0 bytes_invalid=0 send_seq=132 receive_seq=132 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996512 adj=49998381  heater_bed: target=0 temp=17.7 pwm=0.000 raspberry_pi: temp=38.0 Mainboard: temp=21.0 sysload=0.39 cputime=4.188 memavail=3466768 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.6 pwm=0.000
Stats 1551.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6417 bytes_read=9632 bytes_retransmit=9 bytes_invalid=0 send_seq=347 receive_seq=347 retransmit_seq=2 srtt=0.000 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995171 rpi: mcu_awake=0.001 mcu_task_avg=0.000010 mcu_task_stddev=0.000010 bytes_write=955 bytes_read=4873 bytes_retransmit=0 bytes_invalid=0 send_seq=133 receive_seq=133 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996535 adj=49998399  heater_bed: target=0 temp=17.8 pwm=0.000 raspberry_pi: temp=38.0 Mainboard: temp=21.1 sysload=0.39 cputime=4.217 memavail=3466768 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.6 pwm=0.000
Stats 1552.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6423 bytes_read=9794 bytes_retransmit=9 bytes_invalid=0 send_seq=348 receive_seq=348 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995192 rpi: mcu_awake=0.001 mcu_task_avg=0.000012 mcu_task_stddev=0.000012 bytes_write=961 bytes_read=4902 bytes_retransmit=0 bytes_invalid=0 send_seq=134 receive_seq=134 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996559 adj=49998519  heater_bed: target=0 temp=17.7 pwm=0.000 raspberry_pi: temp=37.5 Mainboard: temp=21.0 sysload=0.36 cputime=4.252 memavail=3466768 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.5 pwm=0.000
Stats 1553.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6429 bytes_read=9971 bytes_retransmit=9 bytes_invalid=0 send_seq=349 receive_seq=349 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995192 rpi: mcu_awake=0.001 mcu_task_avg=0.000012 mcu_task_stddev=0.000012 bytes_write=967 bytes_read=4918 bytes_retransmit=0 bytes_invalid=0 send_seq=135 receive_seq=135 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996577 adj=49998615  heater_bed: target=0 temp=17.8 pwm=0.000 raspberry_pi: temp=38.5 Mainboard: temp=21.0 sysload=0.36 cputime=4.285 memavail=3466768 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.7 pwm=0.000
Stats 1554.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6435 bytes_read=10134 bytes_retransmit=9 bytes_invalid=0 send_seq=350 receive_seq=350 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995193 rpi: mcu_awake=0.001 mcu_task_avg=0.000012 mcu_task_stddev=0.000012 bytes_write=973 bytes_read=4934 bytes_retransmit=0 bytes_invalid=0 send_seq=136 receive_seq=136 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996593 adj=49998714  heater_bed: target=0 temp=17.7 pwm=0.000 raspberry_pi: temp=37.5 Mainboard: temp=21.0 sysload=0.36 cputime=4.318 memavail=3466768 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.7 pwm=0.000
Stats 1555.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6441 bytes_read=10296 bytes_retransmit=9 bytes_invalid=0 send_seq=351 receive_seq=351 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995180 rpi: mcu_awake=0.001 mcu_task_avg=0.000012 mcu_task_stddev=0.000012 bytes_write=979 bytes_read=4950 bytes_retransmit=0 bytes_invalid=0 send_seq=137 receive_seq=137 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996606 adj=49998774  heater_bed: target=0 temp=17.7 pwm=0.000 raspberry_pi: temp=38.0 Mainboard: temp=21.0 sysload=0.36 cputime=4.343 memavail=3466768 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.8 pwm=0.000
Stats 1556.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6447 bytes_read=10459 bytes_retransmit=9 bytes_invalid=0 send_seq=352 receive_seq=352 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995169 rpi: mcu_awake=0.001 mcu_task_avg=0.000012 mcu_task_stddev=0.000012 bytes_write=985 bytes_read=4966 bytes_retransmit=0 bytes_invalid=0 send_seq=138 receive_seq=138 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996592 adj=49998850  heater_bed: target=0 temp=17.6 pwm=0.000 raspberry_pi: temp=37.5 Mainboard: temp=21.0 sysload=0.36 cputime=4.362 memavail=3466772 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.9 pwm=0.000
Stats 1557.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6453 bytes_read=10622 bytes_retransmit=9 bytes_invalid=0 send_seq=353 receive_seq=353 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995159 rpi: mcu_awake=0.001 mcu_task_avg=0.000017 mcu_task_stddev=0.000022 bytes_write=991 bytes_read=4995 bytes_retransmit=0 bytes_invalid=0 send_seq=139 receive_seq=139 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996575 adj=49998725  heater_bed: target=0 temp=17.7 pwm=0.000 raspberry_pi: temp=37.5 Mainboard: temp=21.0 sysload=0.33 cputime=4.378 memavail=3466772 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=20.0 pwm=0.000
Stats 1558.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6459 bytes_read=10798 bytes_retransmit=9 bytes_invalid=0 send_seq=354 receive_seq=354 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995149 rpi: mcu_awake=0.001 mcu_task_avg=0.000017 mcu_task_stddev=0.000022 bytes_write=997 bytes_read=5011 bytes_retransmit=0 bytes_invalid=0 send_seq=140 receive_seq=140 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996562 adj=49998609  heater_bed: target=0 temp=17.7 pwm=0.000 raspberry_pi: temp=38.5 Mainboard: temp=21.0 sysload=0.33 cputime=4.395 memavail=3466772 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.5 pwm=0.000
Stats 1559.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6465 bytes_read=10961 bytes_retransmit=9 bytes_invalid=0 send_seq=355 receive_seq=355 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995141 rpi: mcu_awake=0.001 mcu_task_avg=0.000017 mcu_task_stddev=0.000022 bytes_write=1003 bytes_read=5027 bytes_retransmit=0 bytes_invalid=0 send_seq=141 receive_seq=141 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996546 adj=49998545  heater_bed: target=0 temp=17.8 pwm=0.000 raspberry_pi: temp=38.0 Mainboard: temp=21.1 sysload=0.33 cputime=4.411 memavail=3466544 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.7 pwm=0.000
Stats 1560.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6471 bytes_read=11124 bytes_retransmit=9 bytes_invalid=0 send_seq=356 receive_seq=356 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995149 rpi: mcu_awake=0.001 mcu_task_avg=0.000017 mcu_task_stddev=0.000022 bytes_write=1009 bytes_read=5043 bytes_retransmit=0 bytes_invalid=0 send_seq=142 receive_seq=142 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996538 adj=49998470  heater_bed: target=0 temp=17.7 pwm=0.000 raspberry_pi: temp=37.5 Mainboard: temp=21.0 sysload=0.33 cputime=4.436 memavail=3466544 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.7 pwm=0.000
Stats 1561.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6477 bytes_read=11286 bytes_retransmit=9 bytes_invalid=0 send_seq=357 receive_seq=357 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995160 rpi: mcu_awake=0.001 mcu_task_avg=0.000017 mcu_task_stddev=0.000022 bytes_write=1015 bytes_read=5059 bytes_retransmit=0 bytes_invalid=0 send_seq=143 receive_seq=143 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996542 adj=49998405  heater_bed: target=0 temp=17.7 pwm=0.000 raspberry_pi: temp=38.0 Mainboard: temp=21.0 sysload=0.33 cputime=4.469 memavail=3466544 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.6 pwm=0.000
Stats 1562.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6483 bytes_read=11449 bytes_retransmit=9 bytes_invalid=0 send_seq=358 receive_seq=358 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995176 rpi: mcu_awake=0.001 mcu_task_avg=0.000013 mcu_task_stddev=0.000014 bytes_write=1021 bytes_read=5088 bytes_retransmit=0 bytes_invalid=0 send_seq=144 receive_seq=144 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996544 adj=49998442  heater_bed: target=0 temp=17.7 pwm=0.000 raspberry_pi: temp=37.0 Mainboard: temp=21.1 sysload=0.30 cputime=4.502 memavail=3466544 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.8 pwm=0.000
Stats 1563.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6489 bytes_read=11621 bytes_retransmit=9 bytes_invalid=0 send_seq=359 receive_seq=359 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995179 rpi: mcu_awake=0.001 mcu_task_avg=0.000013 mcu_task_stddev=0.000014 bytes_write=1027 bytes_read=5104 bytes_retransmit=0 bytes_invalid=0 send_seq=145 receive_seq=145 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996557 adj=49998438  heater_bed: target=0 temp=17.7 pwm=0.000 raspberry_pi: temp=37.5 Mainboard: temp=21.0 sysload=0.30 cputime=4.536 memavail=3466544 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.5 pwm=0.000
Stats 1564.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6495 bytes_read=11772 bytes_retransmit=9 bytes_invalid=0 send_seq=360 receive_seq=360 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995182 rpi: mcu_awake=0.001 mcu_task_avg=0.000013 mcu_task_stddev=0.000014 bytes_write=1033 bytes_read=5120 bytes_retransmit=0 bytes_invalid=0 send_seq=146 receive_seq=146 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996564 adj=49998559  heater_bed: target=0 temp=17.8 pwm=0.000 raspberry_pi: temp=38.0 Mainboard: temp=21.0 sysload=0.30 cputime=4.569 memavail=3466544 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.7 pwm=0.000
Stats 1565.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6501 bytes_read=11928 bytes_retransmit=9 bytes_invalid=0 send_seq=361 receive_seq=361 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995181 rpi: mcu_awake=0.001 mcu_task_avg=0.000013 mcu_task_stddev=0.000014 bytes_write=1045 bytes_read=5152 bytes_retransmit=0 bytes_invalid=0 send_seq=148 receive_seq=148 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996569 adj=49998603  heater_bed: target=0 temp=17.7 pwm=0.000 raspberry_pi: temp=38.0 Mainboard: temp=21.1 sysload=0.30 cputime=4.603 memavail=3466544 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.7 pwm=0.000
Stats 1566.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6507 bytes_read=12091 bytes_retransmit=9 bytes_invalid=0 send_seq=362 receive_seq=362 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995184 rpi: mcu_awake=0.001 mcu_task_avg=0.000013 mcu_task_stddev=0.000014 bytes_write=1051 bytes_read=5168 bytes_retransmit=0 bytes_invalid=0 send_seq=149 receive_seq=149 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996567 adj=49998644  heater_bed: target=0 temp=17.8 pwm=0.000 raspberry_pi: temp=38.0 Mainboard: temp=21.0 sysload=0.30 cputime=4.635 memavail=3466544 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.6 pwm=0.000
Stats 1567.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6513 bytes_read=12253 bytes_retransmit=9 bytes_invalid=0 send_seq=363 receive_seq=363 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995181 rpi: mcu_awake=0.001 mcu_task_avg=0.000021 mcu_task_stddev=0.000024 bytes_write=1057 bytes_read=5197 bytes_retransmit=0 bytes_invalid=0 send_seq=150 receive_seq=150 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996565 adj=49998602  heater_bed: target=0 temp=17.7 pwm=0.000 raspberry_pi: temp=37.0 Mainboard: temp=20.9 sysload=0.28 cputime=4.668 memavail=3466544 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.8 pwm=0.000
Stats 1568.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6519 bytes_read=12430 bytes_retransmit=9 bytes_invalid=0 send_seq=364 receive_seq=364 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995176 rpi: mcu_awake=0.001 mcu_task_avg=0.000021 mcu_task_stddev=0.000024 bytes_write=1063 bytes_read=5213 bytes_retransmit=0 bytes_invalid=0 send_seq=151 receive_seq=151 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996566 adj=49998584  heater_bed: target=0 temp=17.7 pwm=0.000 raspberry_pi: temp=37.5 Mainboard: temp=21.0 sysload=0.28 cputime=4.702 memavail=3466544 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.7 pwm=0.000
Stats 1569.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6525 bytes_read=12593 bytes_retransmit=9 bytes_invalid=0 send_seq=365 receive_seq=365 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995176 rpi: mcu_awake=0.001 mcu_task_avg=0.000021 mcu_task_stddev=0.000024 bytes_write=1069 bytes_read=5229 bytes_retransmit=0 bytes_invalid=0 send_seq=152 receive_seq=152 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996565 adj=49998608  heater_bed: target=0 temp=17.7 pwm=0.000 raspberry_pi: temp=38.0 Mainboard: temp=21.0 sysload=0.28 cputime=4.734 memavail=3465796 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.5 pwm=0.000
Stats 1570.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6564 bytes_read=12765 bytes_retransmit=9 bytes_invalid=0 send_seq=368 receive_seq=368 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995176 rpi: mcu_awake=0.001 mcu_task_avg=0.000021 mcu_task_stddev=0.000024 bytes_write=1075 bytes_read=5245 bytes_retransmit=0 bytes_invalid=0 send_seq=153 receive_seq=153 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996559 adj=49998592  heater_bed: target=0 temp=17.7 pwm=0.000 raspberry_pi: temp=37.0 Mainboard: temp=21.1 sysload=0.28 cputime=4.768 memavail=3465796 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.6 pwm=0.000
Stats 1571.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6570 bytes_read=12928 bytes_retransmit=9 bytes_invalid=0 send_seq=369 receive_seq=369 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995175 rpi: mcu_awake=0.001 mcu_task_avg=0.000021 mcu_task_stddev=0.000024 bytes_write=1081 bytes_read=5261 bytes_retransmit=0 bytes_invalid=0 send_seq=154 receive_seq=154 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996554 adj=49998535  heater_bed: target=0 temp=17.8 pwm=0.000 raspberry_pi: temp=37.0 Mainboard: temp=21.0 sysload=0.28 cputime=4.802 memavail=3465796 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.5 pwm=0.000
Stats 1572.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6576 bytes_read=13091 bytes_retransmit=9 bytes_invalid=0 send_seq=370 receive_seq=370 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995173 rpi: mcu_awake=0.001 mcu_task_avg=0.000019 mcu_task_stddev=0.000020 bytes_write=1087 bytes_read=5290 bytes_retransmit=0 bytes_invalid=0 send_seq=155 receive_seq=155 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996554 adj=49998504  heater_bed: target=0 temp=17.7 pwm=0.000 raspberry_pi: temp=36.0 Mainboard: temp=20.9 sysload=0.26 cputime=4.835 memavail=3465796 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.6 pwm=0.000
Stats 1573.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000009 mcu_task_stddev=0.000016 bytes_write=6582 bytes_read=13268 bytes_retransmit=9 bytes_invalid=0 send_seq=371 receive_seq=371 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995174 rpi: mcu_awake=0.001 mcu_task_avg=0.000019 mcu_task_stddev=0.000020 bytes_write=1093 bytes_read=5306 bytes_retransmit=0 bytes_invalid=0 send_seq=156 receive_seq=156 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996549 adj=49998530  heater_bed: target=0 temp=17.7 pwm=0.000 raspberry_pi: temp=36.5 Mainboard: temp=21.0 sysload=0.26 cputime=4.869 memavail=3465796 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.5 pwm=0.000
Stats 1574.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000009 mcu_task_stddev=0.000016 bytes_write=6588 bytes_read=13431 bytes_retransmit=9 bytes_invalid=0 send_seq=372 receive_seq=372 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995176 rpi: mcu_awake=0.001 mcu_task_avg=0.000019 mcu_task_stddev=0.000020 bytes_write=1099 bytes_read=5322 bytes_retransmit=0 bytes_invalid=0 send_seq=157 receive_seq=157 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996545 adj=49998487  heater_bed: target=0 temp=17.7 pwm=0.000 raspberry_pi: temp=36.5 Mainboard: temp=21.0 sysload=0.26 cputime=4.902 memavail=3465796 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.6 pwm=0.000
Stats 1575.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000009 mcu_task_stddev=0.000016 bytes_write=6594 bytes_read=13594 bytes_retransmit=9 bytes_invalid=0 send_seq=373 receive_seq=373 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995173 rpi: mcu_awake=0.001 mcu_task_avg=0.000019 mcu_task_stddev=0.000020 bytes_write=1105 bytes_read=5338 bytes_retransmit=0 bytes_invalid=0 send_seq=158 receive_seq=158 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996539 adj=49998455  heater_bed: target=0 temp=17.8 pwm=0.000 raspberry_pi: temp=37.0 Mainboard: temp=21.0 sysload=0.26 cputime=4.934 memavail=3465796 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.7 pwm=0.000
Stats 1576.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000009 mcu_task_stddev=0.000016 bytes_write=6616 bytes_read=13761 bytes_retransmit=9 bytes_invalid=0 send_seq=375 receive_seq=375 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995169 rpi: mcu_awake=0.001 mcu_task_avg=0.000019 mcu_task_stddev=0.000020 bytes_write=1111 bytes_read=5354 bytes_retransmit=0 bytes_invalid=0 send_seq=159 receive_seq=159 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996534 adj=49998442  heater_bed: target=0 temp=17.7 pwm=0.000 raspberry_pi: temp=37.5 Mainboard: temp=20.9 sysload=0.26 cputime=4.968 memavail=3465796 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.7 pwm=0.000
Stats 1577.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000009 mcu_task_stddev=0.000016 bytes_write=6638 bytes_read=13929 bytes_retransmit=9 bytes_invalid=0 send_seq=377 receive_seq=377 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995166 rpi: mcu_awake=0.001 mcu_task_avg=0.000020 mcu_task_stddev=0.000020 bytes_write=1117 bytes_read=5383 bytes_retransmit=0 bytes_invalid=0 send_seq=160 receive_seq=160 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996529 adj=49998437  heater_bed: target=0 temp=17.8 pwm=0.000 raspberry_pi: temp=37.0 Mainboard: temp=20.9 sysload=0.24 cputime=5.002 memavail=3465796 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.5 pwm=0.000
Stats 1578.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000009 mcu_task_stddev=0.000015 bytes_write=6644 bytes_read=14121 bytes_retransmit=9 bytes_invalid=0 send_seq=378 receive_seq=378 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995165 rpi: mcu_awake=0.001 mcu_task_avg=0.000020 mcu_task_stddev=0.000020 bytes_write=1123 bytes_read=5399 bytes_retransmit=0 bytes_invalid=0 send_seq=161 receive_seq=161 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996536 adj=49998425  heater_bed: target=0 temp=17.7 pwm=0.000 raspberry_pi: temp=37.5 Mainboard: temp=21.0 sysload=0.24 cputime=5.036 memavail=3465332 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.3 pwm=0.000
Stats 1579.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000009 mcu_task_stddev=0.000015 bytes_write=6650 bytes_read=14269 bytes_retransmit=9 bytes_invalid=0 send_seq=379 receive_seq=379 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995153 rpi: mcu_awake=0.001 mcu_task_avg=0.000020 mcu_task_stddev=0.000020 bytes_write=1129 bytes_read=5415 bytes_retransmit=0 bytes_invalid=0 send_seq=162 receive_seq=162 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996524 adj=49998532  heater_bed: target=0 temp=17.8 pwm=0.000 raspberry_pi: temp=37.5 Mainboard: temp=21.0 sysload=0.24 cputime=5.054 memavail=3466844 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.8 pwm=0.000
Stats 1580.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000009 mcu_task_stddev=0.000015 bytes_write=6656 bytes_read=14432 bytes_retransmit=9 bytes_invalid=0 send_seq=380 receive_seq=380 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995144 rpi: mcu_awake=0.001 mcu_task_avg=0.000020 mcu_task_stddev=0.000020 bytes_write=1135 bytes_read=5431 bytes_retransmit=0 bytes_invalid=0 send_seq=163 receive_seq=163 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996515 adj=49998462  heater_bed: target=0 temp=17.7 pwm=0.000 raspberry_pi: temp=37.0 Mainboard: temp=21.0 sysload=0.24 cputime=5.071 memavail=3466844 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.5 pwm=0.000
Stats 1581.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000009 mcu_task_stddev=0.000015 bytes_write=6662 bytes_read=14609 bytes_retransmit=9 bytes_invalid=0 send_seq=381 receive_seq=381 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995137 rpi: mcu_awake=0.001 mcu_task_avg=0.000020 mcu_task_stddev=0.000020 bytes_write=1141 bytes_read=5447 bytes_retransmit=0 bytes_invalid=0 send_seq=164 receive_seq=164 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996499 adj=49998430  heater_bed: target=0 temp=17.5 pwm=0.000 raspberry_pi: temp=38.0 Mainboard: temp=20.9 sysload=0.24 cputime=5.087 memavail=3466844 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.6 pwm=0.000
Stats 1582.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000009 mcu_task_stddev=0.000015 bytes_write=6668 bytes_read=14757 bytes_retransmit=9 bytes_invalid=0 send_seq=382 receive_seq=382 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995129 rpi: mcu_awake=0.001 mcu_task_avg=0.000013 mcu_task_stddev=0.000017 bytes_write=1147 bytes_read=5476 bytes_retransmit=0 bytes_invalid=0 send_seq=165 receive_seq=165 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996485 adj=49998323  heater_bed: target=0 temp=17.7 pwm=0.000 raspberry_pi: temp=37.5 Mainboard: temp=21.0 sysload=0.22 cputime=5.103 memavail=3467096 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.5 pwm=0.000
Stats 1583.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6674 bytes_read=14934 bytes_retransmit=9 bytes_invalid=0 send_seq=383 receive_seq=383 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995125 rpi: mcu_awake=0.001 mcu_task_avg=0.000013 mcu_task_stddev=0.000017 bytes_write=1153 bytes_read=5492 bytes_retransmit=0 bytes_invalid=0 send_seq=166 receive_seq=166 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996473 adj=49998262  heater_bed: target=0 temp=17.8 pwm=0.000 raspberry_pi: temp=38.0 Mainboard: temp=21.1 sysload=0.22 cputime=5.120 memavail=3467096 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.6 pwm=0.000
Stats 1584.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6680 bytes_read=15111 bytes_retransmit=9 bytes_invalid=0 send_seq=384 receive_seq=384 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995130 rpi: mcu_awake=0.001 mcu_task_avg=0.000013 mcu_task_stddev=0.000017 bytes_write=1159 bytes_read=5508 bytes_retransmit=0 bytes_invalid=0 send_seq=167 receive_seq=167 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996476 adj=49998225  heater_bed: target=0 temp=17.7 pwm=0.000 raspberry_pi: temp=36.0 Mainboard: temp=21.0 sysload=0.22 cputime=5.149 memavail=3467096 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.6 pwm=0.000
Stats 1585.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6686 bytes_read=15259 bytes_retransmit=9 bytes_invalid=0 send_seq=385 receive_seq=385 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995131 rpi: mcu_awake=0.001 mcu_task_avg=0.000013 mcu_task_stddev=0.000017 bytes_write=1165 bytes_read=5524 bytes_retransmit=0 bytes_invalid=0 send_seq=168 receive_seq=168 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996479 adj=49998297  heater_bed: target=0 temp=17.7 pwm=0.000 raspberry_pi: temp=37.0 Mainboard: temp=21.0 sysload=0.22 cputime=5.183 memavail=3467096 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.5 pwm=0.000
Stats 1586.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6692 bytes_read=15422 bytes_retransmit=9 bytes_invalid=0 send_seq=386 receive_seq=386 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995130 rpi: mcu_awake=0.001 mcu_task_avg=0.000013 mcu_task_stddev=0.000017 bytes_write=1171 bytes_read=5540 bytes_retransmit=0 bytes_invalid=0 send_seq=169 receive_seq=169 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996477 adj=49998379  heater_bed: target=0 temp=17.7 pwm=0.000 raspberry_pi: temp=37.0 Mainboard: temp=21.1 sysload=0.22 cputime=5.216 memavail=3467096 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.4 pwm=0.000
Stats 1587.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000007 mcu_task_stddev=0.000006 bytes_write=6698 bytes_read=15599 bytes_retransmit=9 bytes_invalid=0 send_seq=387 receive_seq=387 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995131 rpi: mcu_awake=0.001 mcu_task_avg=0.000016 mcu_task_stddev=0.000018 bytes_write=1177 bytes_read=5569 bytes_retransmit=0 bytes_invalid=0 send_seq=170 receive_seq=170 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49996473 adj=49998402  heater_bed: target=0 temp=17.8 pwm=0.000 raspberry_pi: temp=37.0 Mainboard: temp=21.0 sysload=0.20 cputime=5.250 memavail=3467096 print_time=0.000 buffer_time=0.000 print_stall=0 extruder: target=0 temp=19.6 pwm=0.000
Stats 1642.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000009 mcu_task_stddev=0.000012 bytes_write=7308 bytes_read=24775 bytes_retransmit=9 bytes_invalid=0 send_seq=467 receive_seq=467 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=119995127 rpi: mcu_awake=0.001 mcu_task_avg=0.000020 mcu_task_stddev=0.000022 bytes_write=1513 bytes_read=6590 bytes_retransmit=0 bytes_invalid=0 send_seq=226 receive_seq=226 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49998721 adj=50005214  heater_bed: target=0 temp=17.7 pwm=0.000 raspberry_pi: temp=36.5 Mainboard: temp=21.0 sysload=0.15 cputime=6.979 memavail=3466384 print_time=115.430 buffer_time=0.871 print_stall=0 extruder: target=0 temp=19.3 pwm=0.000
Attempting MCU 'mcu' reset command
Attempting MCU 'rpi' config_reset command
b'Got EOF when reading from device'
webhooks client 4123021520: Disconnected
Restarting printer
Start printer at Fri Jan 12 19:14:40 2024 (1705086880.3 1644.2)
===== Config file =====
[virtual_sdcard]
path = ~/printer_data/gcodes
on_error_gcode = CANCEL_PRINT

[pause_resume]

[display_status]

[respond]

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = CANCEL_PRINT_BASE
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set allow_park = client.park_at_cancel|default(false)|lower == 'true' %}
	{% set retract = client.cancel_retract|default(5.0)|abs %}
	
	{% set park_x = "" if (client.park_at_cancel_x|default(none) is none)
	else "X=" ~ client.park_at_cancel_x %}
	{% set park_y = "" if (client.park_at_cancel_y|default(none) is none)
	else "Y=" ~ client.park_at_cancel_y %}
	{% set custom_park = park_x|length > 0 or park_y|length > 0 %}
	
	
	{% if printer['gcode_macro RESUME'].restore_idle_timeout > 0 %}
	SET_IDLE_TIMEOUT TIMEOUT={printer['gcode_macro RESUME'].restore_idle_timeout}
	{% endif %}
	{% if (custom_park or not printer.pause_resume.is_paused) and allow_park %} _TOOLHEAD_PARK_PAUSE_CANCEL {park_x} {park_y} {% endif %}
	_CLIENT_RETRACT LENGTH={retract}
	TURN_OFF_HEATERS
	M106 S0
	{client.user_cancel_macro|default("")}
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=idle_state VALUE=False
	
	SET_PAUSE_NEXT_LAYER ENABLE=0
	SET_PAUSE_AT_LAYER ENABLE=0 LAYER=0
	CANCEL_PRINT_BASE

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = PAUSE_BASE
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set idle_timeout = client.idle_timeout|default(0) %}
	{% set temp = printer[printer.toolhead.extruder].target if printer.toolhead.extruder != '' else 0 %}
	{% set restore = False if printer.toolhead.extruder == ''
	else True  if params.RESTORE|default(1)|int == 1 else False %}
	
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=last_extruder_temp VALUE="{{'restore': restore, 'temp': temp}}"
	
	{% if idle_timeout > 0 %}
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=restore_idle_timeout VALUE={printer.configfile.settings.idle_timeout.timeout}
	SET_IDLE_TIMEOUT TIMEOUT={idle_timeout}
	{% endif %}
	PAUSE_BASE
	{client.user_pause_macro|default("")}
	_TOOLHEAD_PARK_PAUSE_CANCEL {rawparams}

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = RESUME_BASE
variable_last_extruder_temp = {'restore': False, 'temp': 0}
variable_restore_idle_timeout = 0
variable_idle_state = False
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set sp_move = client.speed_move|default(velocity) %}
	{% set runout_resume = True if client.runout_sensor|default("") == ""
	else True if not printer[client.runout_sensor].enabled
	else printer[client.runout_sensor].filament_detected %}
	{% set can_extrude = True if printer.toolhead.extruder == ''
	else printer[printer.toolhead.extruder].can_extrude %}
	{% set do_resume = False %}
	{% set prompt_txt = [] %}
	
	
	{% if printer.idle_timeout.state|upper == "IDLE" or idle_state %}
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=idle_state VALUE=False
	{% if last_extruder_temp.restore %}
	
	RESPOND TYPE=echo MSG='{"Restoring \"%s\" temperature to %3.1f\u00B0C, this may take some time" % (printer.toolhead.extruder, last_extruder_temp.temp) }'
	M109 S{last_extruder_temp.temp}
	{% set do_resume = True %}
	{% elif can_extrude %}
	{% set do_resume = True %}
	{% else %}
	RESPOND TYPE=error MSG='{"Resume aborted !!! \"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder}'
	{% set _d = prompt_txt.append("\"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder) %}
	{% endif %}
	
	{% elif can_extrude %}
	{% set do_resume = True %}
	{% else %}
	RESPOND TYPE=error MSG='{"Resume aborted !!! \"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder}'
	{% set _d = prompt_txt.append("\"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder) %}
	{% endif %}
	{% if runout_resume %}
	{% if do_resume %}
	{% if restore_idle_timeout > 0 %} SET_IDLE_TIMEOUT TIMEOUT={restore_idle_timeout} {% endif %}
	{client.user_resume_macro|default("")}
	_CLIENT_EXTRUDE
	RESUME_BASE VELOCITY={params.VELOCITY|default(sp_move)}
	{% endif %}
	{% else %}
	RESPOND TYPE=error MSG='{"Resume aborted !!! \"%s\" detects no filament, please load filament and press RESUME" % (client.runout_sensor.split(" "))[1]}'
	{% set _d = prompt_txt.append("\"%s\" detects no filament, please load filament and press RESUME" % (client.runout_sensor.split(" "))[1]) %}
	{% endif %}
	
	{% if not (runout_resume and do_resume) %}
	RESPOND TYPE=command MSG="action:prompt_begin RESUME aborted !!!"
	{% for element in prompt_txt %}
	RESPOND TYPE=command MSG='{"action:prompt_text %s" % element}'
	{% endfor %}
	RESPOND TYPE=command MSG="action:prompt_footer_button Ok|RESPOND TYPE=command MSG=action:prompt_end|info"
	RESPOND TYPE=command MSG="action:prompt_show"
	{% endif %}

[gcode_macro SET_PAUSE_NEXT_LAYER]
description = Enable a pause if the next layer is reached
gcode = 
	{% set pause_next_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_next_layer %}
	{% set ENABLE = params.ENABLE|default(1)|int != 0 %}
	{% set MACRO = params.MACRO|default(pause_next_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_next_layer VALUE="{{ 'enable': ENABLE, 'call': MACRO }}"

[gcode_macro SET_PAUSE_AT_LAYER]
description = Enable/disable a pause if a given layer number is reached
gcode = 
	{% set pause_at_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_at_layer %}
	{% set ENABLE = params.ENABLE|int != 0 if params.ENABLE is defined
	else params.LAYER is defined %}
	{% set LAYER = params.LAYER|default(pause_at_layer.layer)|int %}
	{% set MACRO = params.MACRO|default(pause_at_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_at_layer VALUE="{{ 'enable': ENABLE, 'layer': LAYER, 'call': MACRO }}"

[gcode_macro SET_PRINT_STATS_INFO]
rename_existing = SET_PRINT_STATS_INFO_BASE
description = Overwrite, to get pause_next_layer and pause_at_layer feature
variable_pause_next_layer = { 'enable': False, 'call': "PAUSE" }
variable_pause_at_layer = { 'enable': False, 'layer': 0, 'call': "PAUSE" }
gcode = 
	{% if pause_next_layer.enable %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_next_layer" % pause_next_layer.call}'
	{pause_next_layer.call}
	SET_PAUSE_NEXT_LAYER ENABLE=0
	{% elif pause_at_layer.enable and params.CURRENT_LAYER is defined and params.CURRENT_LAYER|int == pause_at_layer.layer %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_at_layer [%d]" % (pause_at_layer.call, pause_at_layer.layer)}'
	{pause_at_layer.call}
	SET_PAUSE_AT_LAYER ENABLE=0
	{% endif %}
	SET_PRINT_STATS_INFO_BASE {rawparams}

[gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL]
description = Helper: park toolhead used in PAUSE and CANCEL_PRINT
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set use_custom     = client.use_custom_pos|default(false)|lower == 'true' %}
	{% set custom_park_x  = client.custom_park_x|default(0.0) %}
	{% set custom_park_y  = client.custom_park_y|default(0.0) %}
	{% set park_dz        = client.custom_park_dz|default(2.0)|abs %}
	{% set sp_hop         = client.speed_hop|default(15) * 60 %}
	{% set sp_move        = client.speed_move|default(velocity) * 60 %}
	
	{% set origin    = printer.gcode_move.homing_origin %}
	{% set act       = printer.gcode_move.gcode_position %}
	{% set max       = printer.toolhead.axis_maximum %}
	{% set cone      = printer.toolhead.cone_start_z|default(max.z) %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	
	{% set z_min = params.Z_MIN|default(0)|float %}
	{% set z_park = [[(act.z + park_dz), z_min]|max, (max.z - origin.z)]|min %}
	{% set x_park = params.X       if params.X is defined
	else custom_park_x  if use_custom
	else 0.0            if round_bed
	else (max.x - 5.0) %}
	{% set y_park = params.Y       if params.Y is defined
	else custom_park_y  if use_custom
	else (max.y - 5.0)  if round_bed and z_park < cone
	else 0.0            if round_bed
	else (max.y - 5.0) %}
	
	_CLIENT_RETRACT
	{% if "xyz" in printer.toolhead.homed_axes %}
	G90
	G1 Z{z_park} F{sp_hop}
	G1 X{x_park} Y{y_park} F{sp_move}
	{% if not printer.gcode_move.absolute_coordinates %} G91 {% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='Printer not homed'
	{% endif %}

[gcode_macro _CLIENT_EXTRUDE]
description = Extrudes, if the extruder is hot enough
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set use_fw_retract = (client.use_fw_retract|default(false)|lower == 'true') and (printer.firmware_retraction is defined) %}
	{% set length = params.LENGTH|default(client.unretract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_unretract)|default(35) %}
	{% set absolute_extrude = printer.gcode_move.absolute_extrude %}
	
	{% if printer.toolhead.extruder != '' %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if use_fw_retract %}
	{% if length < 0 %}
	G10
	{% else %}
	G11
	{% endif %}
	{% else %}
	M83
	G1 E{length} F{(speed|float|abs) * 60}
	{% if absolute_extrude %}
	M82
	{% endif %}
	{% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='{"\"%s\" not hot enough" % printer.toolhead.extruder}'
	{% endif %}
	{% endif %}

[gcode_macro _CLIENT_RETRACT]
description = Retracts, if the extruder is hot enough
gcode = 
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set length = params.LENGTH|default(client.retract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_retract)|default(35) %}
	
	_CLIENT_EXTRUDE LENGTH=-{length|float|abs} SPEED={speed|float|abs}

[gcode_macro START_PRINT]
gcode = 
	{% set BED_TEMP = params.BED_TEMP|default(55)|float %}
	{% set EXTRUDER_TEMP = params.EXTRUDER_TEMP|default(200)|float %}
	M117 Print Starting...
	G28 X Y
	G90
	M220 S100
	M221 S100
	G92 E0
	
	
	
	
	
	
	M140 S{BED_TEMP}
	
	M190 S{BED_TEMP}
	
	M117 Waiting for temperature
	
	
	M117 Homing All...
	
	G90
	
	G28
	
	M117 Z-Tilt Adjust
	Z_TILT_ADJUST
	
	M117 Generating mesh
	
	BED_MESH_CLEAR
	
	BED_MESH_CALIBRATE
	
	BED_MESH_PROFILE LOAD=default
	
	G1 X100 Y392 F10000
	
	M117 Heaters Recovering...
	
	
	M109 S{EXTRUDER_TEMP} T0; start warming extruder to preheat temp
	
	
	M117 Purging extruder...
	
	
	CLEAN_AND_PURGE_NOZZLE
	
	M117 Printing.....
	UPDATE_DELAYED_GCODE ID=clear_display DURATION=10

[gcode_macro END_PRINT]
gcode = 
	
	{% set th = printer.toolhead %}
	{% set x_safe = th.position.x + 20 * (1 if th.axis_maximum.x - th.position.x > 20 else -1) %}
	{% set y_safe = th.position.y + 20 * (1 if th.axis_maximum.y - th.position.y > 20 else -1) %}
	{% set z_safe = [th.position.z + 2, th.axis_maximum.z]|min %}
	
	SAVE_GCODE_STATE NAME=STATE_PRINT_END
	
	
	
	M400
	G92 E0
	
	G91
	G1 E-0.7 Z+5 F3000
	G90
	
	TURN_OFF_HEATERS
	
	G0 X{x_safe} Y{y_safe} Z{z_safe} F20000
	G0 X{th.axis_maximum.x//2} Y{th.axis_maximum.y - 2} F3600
	
	AFTER_PRINT_CLEAN_NOZZLE
	
	G0 X{th.axis_maximum.x/2} Y{th.axis_maximum.y - 2} F3600
	
	TURN_OFF_HEATERS
	
	M84 X Y E
	
	
	SET_PRESSURE_ADVANCE ADVANCE=0.0
	M117 Pressure Advance Set 0.0
	
	
	
	
	BED_MESH_CLEAR
	
	
	
	
	
	M117 Print Finished
	UPDATE_DELAYED_GCODE ID=clear_display DURATION=10
	
	RESTORE_GCODE_STATE NAME=STATE_PRINT_END

[gcode_macro PRIME_LINE]
gcode = 
	M117 Prime Line
	G92 E0
	
	G1 Z2.0 F3000
	
	G1 X40 Y2 Z0.3 F5000.0
	G1 X120 Y2 Z0.3 F500.0 E15
	G1 X120 Y2.3 Z0.3 F5000.0
	G1 X40 Y2.3 Z0.3 F500.0 E30
	G92 E0
	G1 Z2.0 F3000

[gcode_macro CLEAN_NOZZLE]
variable_start_x = 63
variable_start_y = 387
variable_wipe_dist_y = -3
variable_wipe_qty = 5
variable_wipe_spd = 50
variable_end_loc_x = 189
variable_end_loc_y = 185
gcode = 
	SAVE_GCODE_STATE NAME=STATE_PRINT_CURRENT
	
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	G90
	M220 S100
	M204 S100
	M221 S100
	
	
	G1 X{start_x} Y{start_y} F6000
	
	
	{% for wipes in range(1, (wipe_qty + 1)) %}
	
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	
	{% endfor %}
	
	G1 X{end_loc_x} F10000
	
	RESTORE_GCODE_STATE NAME=STATE_PRINT_CURRENT

[gcode_macro CLEAN_AND_PURGE_NOZZLE]
variable_start_x = 63
variable_start_y = 387
variable_start_z = 10
variable_wipe_dist_y = -3
variable_wipe_qty = 5
variable_wipe_spd = 50
variable_purge_loc_x = 100
variable_purge_loc_y = 392
variable_post_purge_y = 386
variable_end_loc_x = 189
variable_end_loc_y = 185
gcode = 
	SAVE_GCODE_STATE NAME=STATE_PRINT_CURRENT
	
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	G90
	
	
	
	
	
	G1 X{start_x} Y{start_y} F6000
	
	
	{% for wipes in range(1, (wipe_qty + 1)) %}
	
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	
	{% endfor %}
	
	G1 X{purge_loc_x}
	G1 Y{purge_loc_y}
	G92 E0
	G1 E30.0 F100
	G92 E0
	G1 E-0.5 F300
	
	G1 Y{post_purge_y} F10000
	G1 X{start_x}
	G1 X{end_loc_x} F10000
	
	RESTORE_GCODE_STATE NAME=STATE_PRINT_CURRENT

[gcode_macro AFTER_PRINT_CLEAN_NOZZLE]
variable_start_x = 63
variable_start_y = 387
variable_wipe_dist_y = -3
variable_wipe_qty = 5
variable_wipe_spd = 50
gcode = 
	SAVE_GCODE_STATE NAME=STATE_PRINT_CURRENT
	
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	G90
	
	
	
	
	G1 X{start_x} Y{start_y} F6000
	
	
	{% for wipes in range(1, (wipe_qty + 1)) %}
	
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	
	{% endfor %}
	
	RESTORE_GCODE_STATE NAME=STATE_PRINT_CURRENT

[delayed_gcode clear_display]
gcode = 
	M117

[gcode_macro Probe_Z_Height]
gcode = 
	G28
	
	PROBE_CALIBRATE

[gcode_macro automatic_bed_screw_adjust]
gcode = 
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	SCREWS_TILT_CALCULATE

[gcode_macro z_motor_alignment]
gcode = 
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	Z_TILT_ADJUST

[gcode_macro Accelerometer_Connection_Test]
gcode = 
	ACCELEROMETER_QUERY

[gcode_macro X_Axis_Resonance_Test]
gcode = 
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	TEST_RESONANCES AXIS=X

[gcode_macro Y_Axis_Resonance_Test]
gcode = 
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	TEST_RESONANCES AXIS=Y

[gcode_macro update_git]
gcode = 
	RUN_SHELL_COMMAND CMD=update_git_script

[gcode_shell_command update_git_script]
command = bash /home/pi/klipper-backup/script.sh
timeout = 90.0
verbose = True

[gcode_macro BED_MESH_CALIBRATE]
rename_existing = _BED_MESH_CALIBRATE
gcode = 
	
	{% set all_points = printer.exclude_object.objects | map(attribute='polygon') | sum(start=[]) %}
	{% set bed_mesh_min = printer.configfile.settings.bed_mesh.mesh_min %}
	{% set bed_mesh_max = printer.configfile.settings.bed_mesh.mesh_max %}
	{% set probe_count = printer.configfile.settings.bed_mesh.probe_count %}
	{% set kamp_settings = printer["gcode_macro _KAMP_Settings"] %}
	{% set verbose_enable = kamp_settings.verbose_enable | abs %}
	{% set probe_dock_enable = kamp_settings.probe_dock_enable | abs %}
	{% set attach_macro = kamp_settings.attach_macro | string %}
	{% set detach_macro = kamp_settings.detach_macro | string %}
	{% set mesh_margin = kamp_settings.mesh_margin | float %}
	{% set fuzz_amount = kamp_settings.fuzz_amount | float %}
	{% set probe_count = probe_count if probe_count|length > 1 else probe_count * 2  %}
	{% set max_probe_point_distance_x = ( bed_mesh_max[0] - bed_mesh_min[0] ) / (probe_count[0] - 1)  %}
	{% set max_probe_point_distance_y = ( bed_mesh_max[1] - bed_mesh_min[1] ) / (probe_count[1] - 1)  %}
	{% set x_min = all_points | map(attribute=0) | min | default(bed_mesh_min[0]) %}
	{% set y_min = all_points | map(attribute=1) | min | default(bed_mesh_min[1]) %}
	{% set x_max = all_points | map(attribute=0) | max | default(bed_mesh_max[0]) %}
	{% set y_max = all_points | map(attribute=1) | max | default(bed_mesh_max[1]) %}
	
	{% set fuzz_range = range((0) | int, (fuzz_amount * 100) | int + 1) %}
	{% set adapted_x_min = x_min - mesh_margin - (fuzz_range | random / 100.0) %}
	{% set adapted_y_min = y_min - mesh_margin - (fuzz_range | random / 100.0) %}
	{% set adapted_x_max = x_max + mesh_margin + (fuzz_range | random / 100.0) %}
	{% set adapted_y_max = y_max + mesh_margin + (fuzz_range | random / 100.0) %}
	
	{% set adapted_x_min = [adapted_x_min , bed_mesh_min[0]] | max %}
	{% set adapted_y_min = [adapted_y_min , bed_mesh_min[1]] | max %}
	{% set adapted_x_max = [adapted_x_max , bed_mesh_max[0]] | min %}
	{% set adapted_y_max = [adapted_y_max , bed_mesh_max[1]] | min %}
	
	{% set points_x = (((adapted_x_max - adapted_x_min) / max_probe_point_distance_x) | round(method='ceil') | int) + 1 %}
	{% set points_y = (((adapted_y_max - adapted_y_min) / max_probe_point_distance_y) | round(method='ceil') | int) + 1 %}
	
	{% if (([points_x, points_y]|max) > 6) %}
	{% set algorithm = "bicubic" %}
	{% set min_points = 4 %}
	{% else %}
	{% set algorithm = "lagrange" %}
	{% set min_points = 3 %}
	{% endif %}
	
	{% set points_x = [points_x , min_points]|max %}
	{% set points_y = [points_y , min_points]|max %}
	{% set points_x = [points_x , probe_count[0]]|min %}
	{% set points_y = [points_y , probe_count[1]]|min %}
	
	{% if verbose_enable == True %}
	{% if printer.exclude_object.objects != [] %}
	
	{ action_respond_info( "Algorithm: {}.".format(
	(algorithm),
	)) }
	
	{ action_respond_info("Default probe count: {},{}.".format(
	(probe_count[0]),
	(probe_count[1]),
	)) }
	
	{ action_respond_info("Adapted probe count: {},{}.".format(
	(points_x),
	(points_y),
	)) }
	
	{action_respond_info("Default mesh bounds: {}, {}.".format(
	(bed_mesh_min[0],bed_mesh_min[1]),
	(bed_mesh_max[0],bed_mesh_max[1]),
	)) }
	
	{% if mesh_margin > 0 %}
	{action_respond_info("Mesh margin is {}, mesh bounds extended by {}mm.".format(
	(mesh_margin),
	(mesh_margin),
	)) }
	{% else %}
	{action_respond_info("Mesh margin is 0, margin not increased.")}
	{% endif %}
	
	{% if fuzz_amount > 0 %}
	{action_respond_info("Mesh point fuzzing enabled, points fuzzed up to {}mm.".format(
	(fuzz_amount),
	)) }
	{% else %}
	{action_respond_info("Fuzz amount is 0, mesh points not fuzzed.")}
	{% endif %}
	
	{ action_respond_info("Adapted mesh bounds: {}, {}.".format(
	(adapted_x_min, adapted_y_min),
	(adapted_x_max, adapted_y_max),
	)) }
	
	{action_respond_info("KAMP adjustments successful. Happy KAMPing!")}
	
	{% else %}
	
	{action_respond_info("No objects detected! Check your gcode and make sure that EXCLUDE_OBJECT_DEFINE is happening before BED_MESH_CALIBRATE is called. Defaulting to regular meshing.")}
	G4 P5000
	{% endif %}
	
	{% endif %}
	
	{% if probe_dock_enable == True %}
	{attach_macro}
	{% endif %}
	
	_BED_MESH_CALIBRATE mesh_min={adapted_x_min},{adapted_y_min} mesh_max={adapted_x_max},{adapted_y_max} ALGORITHM={algorithm} PROBE_COUNT={points_x},{points_y}
	
	{% if probe_dock_enable == True %}
	{detach_macro}
	{% endif %}

[gcode_macro _KAMP_Settings]
description = This macro contains all adjustable settings for KAMP
variable_verbose_enable = True
variable_mesh_margin = 0
variable_fuzz_amount = 0
variable_probe_dock_enable = False
variable_attach_macro = 'Attach_Probe'
variable_detach_macro = 'Dock_Probe'
variable_purge_height = 0.8
variable_tip_distance = 0
variable_purge_margin = 10
variable_purge_amount = 30
variable_flow_rate = 12
variable_smart_park_height = 10
gcode = 
	
	{action_respond_info(" Running the KAMP_Settings macro does nothing, it is only used for storing KAMP settings. ")}

[led_effect sb_logo_busy]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (1,0,0)

[led_effect sb_logo_cleaning]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 0.02, 0.5)

[led_effect sb_logo_calibrating_z]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 0.0, 0.35)

[led_effect sb_logo_heating]
leds = 
	neopixel:sb_leds (1,3,7,8,6,2)
autostart = false
frame_rate = 24
layers = 
	comet  0.3  0 add (1, 0.18, 0)

[led_effect sb_logo_cooling]
leds = 
	neopixel:sb_leds (1,3,7,8,6,2)
autostart = false
frame_rate = 24
layers = 
	comet  0.3  0 add (0, 0, 1)

[led_effect sb_logo_homing]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 0.6, 0.2)

[led_effect sb_logo_leveling]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.5, 0.1, 0.4)

[led_effect sb_logo_meshing]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.2, 1.0, 0.0)

[led_effect sb_logo_printing]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	gradient  0.3  1 add (0.3, 0.0, 0.0),(0.3, 0.3, 0.0),(0.3, 0.1, 0.0)

[led_effect sb_logo_standby]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.01, 0.01, 0.01)

[led_effect sb_logo_part_ready]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 1.0, 0.0)

[led_effect sb_nozzle_heating]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (1.0, 0.18, 0.0, 0.0)

[led_effect sb_nozzle_cooling]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (0.0, 0.0, 1.0, 0.1)

[led_effect sb_nozzle_standby]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (0.6, 0.0, 0.0, 0.0)

[led_effect sb_nozzle_part_ready]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (0.6, 1.0, 0.0, 0.1)

[led_effect sb_critical_error]
leds = 
	neopixel:sb_leds
layers = 
	strobe         1  1.5   add        (1.0,  1.0, 1.0)
	breathing      2  0     difference (0.95, 0.0, 0.0)
	static         1  0     top        (1.0,  0.0, 0.0)
autostart = false
frame_rate = 24
run_on_error = true

[led_effect rainbow]
leds = 
	neopixel:chamber_leds
autostart = false
frame_rate = 24
layers = 
	gradient  0.3  1 add (0.3, 0.0, 0.0),(0.0, 0.3, 0.0),(0.0, 0.0, 0.3)

[led_effect set_nozzle_leds]
leds = 
	neopixel:sb_leds (9,10)
autostart = false
frame_rate = 24
layers = 
	static         0  0     top        (0.0,  0.0, 0.0, 1.0)

[led_effect set_logo_leds]
leds = 
	neopixel:sb_leds (1,2,3,4,5,6,7,8)
autostart = false
frame_rate = 24
layers = 
	static         0  0     top        (1.0,  1.0, 1.0)

[led_effect set_chamber_leds]
leds = 
	neopixel:chamber_leds
autostart = false
frame_rate = 24
layers = 
	static         0  0     top        (1.0,  1.0, 1.0)

[gcode_macro set_logo_leds_off]
gcode = 
	SET_LED_EFFECT EFFECT=set_logo_leds STOP=1

[gcode_macro set_logo_leds_on]
gcode = 
	SET_LED_EFFECT EFFECT=set_logo_leds

[gcode_macro set_nozzle_leds_on]
gcode = 
	SET_LED_EFFECT EFFECT=set_nozzle_leds

[gcode_macro set_nozzle_leds_off]
gcode = 
	SET_LED_EFFECT EFFECT=set_nozzle_leds STOP=1

[gcode_macro set_chamber_leds_off]
gcode = 
	SET_LED_EFFECT EFFECT=set_chamber_leds STOP=1

[gcode_macro set_chamber_leds_on]
gcode = 
	SET_LED_EFFECT EFFECT=set_chamber_leds

[gcode_macro status_off]
gcode = 
	STOP_LED_EFFECTS

[gcode_macro status_ready]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=rainbow

[gcode_macro status_part_ready]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_nozzle_part_ready
	SET_LED_EFFECT EFFECT=sb_logo_part_ready

[gcode_macro status_busy]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_busy
	set_nozzle_leds_on

[gcode_macro status_heating]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_heating
	SET_LED_EFFECT EFFECT=sb_nozzle_heating

[gcode_macro status_cooling]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_cooling
	SET_LED_EFFECT EFFECT=sb_nozzle_cooling

[gcode_macro status_leveling]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_leveling
	set_nozzle_leds_on

[gcode_macro status_homing]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_homing
	set_nozzle_leds_on

[gcode_macro status_cleaning]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_cleaning
	set_nozzle_leds_on

[gcode_macro status_meshing]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_meshing
	set_nozzle_leds_on

[gcode_macro status_calibrating_z]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_calibrating_z
	set_nozzle_leds_on

[gcode_macro status_printing]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_printing
	set_nozzle_leds_on

[printer]
kinematics = corexy
max_velocity = 300
max_accel = 5700
max_z_velocity = 5
max_z_accel = 100
square_corner_velocity = 5.0

[mcu]
serial = /dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00

[mcu rpi]
serial = /tmp/klipper_host_mcu

[adxl345]
cs_pin = rpi:None

[resonance_tester]
accel_chip = adxl345
probe_points = 
	189,185,20

[input_shaper]
shaper_freq_x = 61.8
shaper_type_x = mzv
shaper_freq_y = 38.4
shaper_type_y = zv

[stepper_x]
step_pin = P1.4
dir_pin = !P1.8
enable_pin = !P1.0
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 40
endstop_pin = ^P1.29
position_endstop = 383
position_min = -5
position_max = 383
homing_speed = 25
homing_retract_dist = 5.0

[tmc2209 stepper_x]
uart_pin = P1.1
interpolate = False
run_current = 1.00
stealthchop_threshold = 0

[stepper_y]
step_pin = P1.14
dir_pin = !P1.15
enable_pin = !P1.9
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 40
endstop_pin = ^P1.28
position_endstop = 392
position_min = -8
position_max = 392
homing_speed = 25
homing_retract_dist = 5.0

[tmc2209 stepper_y]
uart_pin = P1.10
interpolate = False
run_current = 1.00
stealthchop_threshold = 0

[stepper_z]
step_pin = P4.29
dir_pin = !P4.28
enable_pin = !P1.16
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 4
endstop_pin = probe:z_virtual_endstop
position_min = -5
position_max = 395

[tmc2209 stepper_z]
uart_pin = P1.17
interpolate = False
run_current = 0.580
stealthchop_threshold = 0

[stepper_z1]
step_pin = P2.11
dir_pin = !P2.12
enable_pin = !P0.21
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 4

[tmc2209 stepper_z1]
uart_pin = P0.22
interpolate = False
run_current = 0.580
stealthchop_threshold = 0

[extruder]
step_pin = P2.6
dir_pin = !P2.7
enable_pin = !P0.4
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 35.291
gear_ratio = 7.5:1
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = P2.3
sensor_type = PT1000
sensor_pin = P0.24
control = pid
pid_kp = 14.430
pid_ki = 1.023
pid_kd = 50.866
min_temp = 10
max_temp = 350
max_extrude_only_distance = 500
max_extrude_only_velocity = 120
min_extrude_temp = 180
max_extrude_cross_section = 50.
pressure_advance = 0.000
pressure_advance_smooth_time = 0.03

[tmc2209 extruder]
uart_pin = P0.5
interpolate = false
run_current = 0.79
stealthchop_threshold = 0
driver_tbl = 0
driver_hend = 6
driver_hstrt = 7
driver_toff = 4

[static_digital_output tmc_standby_pins]
pins = !P3.26, !P3.25, !P1.18, !P1.19, !P2.13

[heater_bed]
heater_pin = P2.5
sensor_type = EPCOS 100K B57560G104F
sensor_pin = P0.25
control = pid
pid_kp = 68.561
pid_ki = 0.619
pid_kd = 1897.417
min_temp = 0
max_temp = 130

[idle_timeout]
timeout = 3600

[bltouch]
sensor_pin = ^P1.27
control_pin = P1.23
x_offset = -33
y_offset = -5
z_offset = 2.500
samples = 1
samples_result = average
sample_retract_dist = 2.0
samples_tolerance = 0.05
samples_tolerance_retries = 3
stow_on_each_sample = False

[safe_z_home]
home_xy_position = 221,190
speed = 60
z_hop = 12
z_hop_speed = 5

[screws_tilt_adjust]
screw1 = 69, 319
screw1_name = rear left screw
screw2 = 368, 60
screw2_name = front right screw
screw3 = 368, 319
screw3_name = rear right screw
screw4 = 69, 60
screw4_name = front left screw
horizontal_move_z = 10.
speed = 50.
screw_thread = CW-M4

[z_tilt]
z_positions = -20, 183
	402, 183
points = 56, 183
	383, 183
speed = 50
horizontal_move_z = 10
retries = 20
retry_tolerance = 0.01

[bed_mesh]
speed = 120
horizontal_move_z = 5
mesh_min = 50, 80
mesh_max = 323, 314
probe_count = 7, 7
algorithm = bicubic
bicubic_tension = 0.5
fade_start = 0.6
fade_end = 10
fade_target = 0

[fan]
pin = P2.1

[heater_fan heatbreak_cooling_fan]
pin = P2.2

[display]
lcd_type = st7920
menu_timeout = 600
cs_pin = EXP1_7
sclk_pin = EXP1_6
sid_pin = EXP1_8
encoder_pins = ^EXP1_5, ^EXP1_3
click_pin = ^!EXP1_2

[output_pin beeper]
pin = EXP1_1

[board_pins]
aliases = 
	
	EXP1_1=P2.8,  EXP1_3=P0.19, EXP1_5=P0.20, EXP1_7=P0.17, EXP1_9=<GND>,
	EXP1_2=P0.16, EXP1_4=<RST>, EXP1_6=P0.15, EXP1_8=P0.18, EXP1_10=<5V>

[filament_motion_sensor SmartFilamentSensor_T0]
detection_length = 7.00
extruder = extruder
switch_pin = ^P1.26
pause_on_runout = True
event_delay = 3.0
pause_delay = 0.5
runout_gcode = 
	M117 Runout Detected!

[temperature_sensor raspberry_pi]
sensor_type = temperature_host
min_temp = 10
max_temp = 100

[temperature_sensor Mainboard]
sensor_type = NTC 100K MGB18-104F39050L32
sensor_pin = P1.30
min_temp = 10
max_temp = 100

[neopixel chamber_leds]
pin = P1.22
chain_count = 85
color_order = GRB
initial_red = 0.0
initial_green = 0.0
initial_blue = 0.0
initial_white = 0.0

[neopixel sb_leds]
pin = P1.24
chain_count = 10
color_order = GRB,GRB,GRB,GRB,GRB,GRB,GRB,GRB,GRBW,GRBW
initial_red = 0.0
initial_green = 0.0
initial_blue = 0.0
initial_white = 0.0

[exclude_object]

[gcode_arcs]
resolution = 0.1
=======================
Extruder max_extrude_ratio=20.787584
mcu 'mcu': Starting serial connect
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00'
webhooks client 4124091416: New connection
webhooks client 4124091416: Client info {'program': 'Moonraker', 'version': 'v0.8.0-247-g3008a13'}
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00'
Attempting MCU 'mcu' reset
Unhandled exception during post run
Traceback (most recent call last):
  File "/home/pi/klippy-env/lib/python3.9/site-packages/serial/serialposix.py", line 265, in open
    self.fd = os.open(self.portstr, os.O_RDWR | os.O_NOCTTY | os.O_NONBLOCK)
FileNotFoundError: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/pi/klipper/klippy/klippy.py", line 234, in run
    self.send_event("klippy:firmware_restart")
  File "/home/pi/klipper/klippy/klippy.py", line 263, in send_event
    return [cb(*params) for cb in self.event_handlers.get(event, [])]
  File "/home/pi/klipper/klippy/klippy.py", line 263, in <listcomp>
    return [cb(*params) for cb in self.event_handlers.get(event, [])]
  File "/home/pi/klipper/klippy/mcu.py", line 948, in _firmware_restart
    self._restart_arduino()
  File "/home/pi/klipper/klippy/mcu.py", line 908, in _restart_arduino
    serialhdl.arduino_reset(self._serialport, self._reactor)
  File "/home/pi/klipper/klippy/serialhdl.py", line 379, in arduino_reset
    ser = serial.Serial(serialport, 2400, timeout=0, exclusive=True)
  File "/home/pi/klippy-env/lib/python3.9/site-packages/serial/serialutil.py", line 240, in __init__
    self.open()
  File "/home/pi/klippy-env/lib/python3.9/site-packages/serial/serialposix.py", line 268, in open
    raise SerialException(msg.errno, "could not open port {}: {}".format(self._port, msg))
serial.serialutil.SerialException: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00'
Restarting printer
Start printer at Fri Jan 12 19:14:57 2024 (1705086898.0 1661.8)
===== Config file =====
[virtual_sdcard]
path = ~/printer_data/gcodes
on_error_gcode = CANCEL_PRINT

[pause_resume]

[display_status]

[respond]

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = CANCEL_PRINT_BASE
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set allow_park = client.park_at_cancel|default(false)|lower == 'true' %}
	{% set retract = client.cancel_retract|default(5.0)|abs %}
	
	{% set park_x = "" if (client.park_at_cancel_x|default(none) is none)
	else "X=" ~ client.park_at_cancel_x %}
	{% set park_y = "" if (client.park_at_cancel_y|default(none) is none)
	else "Y=" ~ client.park_at_cancel_y %}
	{% set custom_park = park_x|length > 0 or park_y|length > 0 %}
	
	
	{% if printer['gcode_macro RESUME'].restore_idle_timeout > 0 %}
	SET_IDLE_TIMEOUT TIMEOUT={printer['gcode_macro RESUME'].restore_idle_timeout}
	{% endif %}
	{% if (custom_park or not printer.pause_resume.is_paused) and allow_park %} _TOOLHEAD_PARK_PAUSE_CANCEL {park_x} {park_y} {% endif %}
	_CLIENT_RETRACT LENGTH={retract}
	TURN_OFF_HEATERS
	M106 S0
	{client.user_cancel_macro|default("")}
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=idle_state VALUE=False
	
	SET_PAUSE_NEXT_LAYER ENABLE=0
	SET_PAUSE_AT_LAYER ENABLE=0 LAYER=0
	CANCEL_PRINT_BASE

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = PAUSE_BASE
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set idle_timeout = client.idle_timeout|default(0) %}
	{% set temp = printer[printer.toolhead.extruder].target if printer.toolhead.extruder != '' else 0 %}
	{% set restore = False if printer.toolhead.extruder == ''
	else True  if params.RESTORE|default(1)|int == 1 else False %}
	
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=last_extruder_temp VALUE="{{'restore': restore, 'temp': temp}}"
	
	{% if idle_timeout > 0 %}
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=restore_idle_timeout VALUE={printer.configfile.settings.idle_timeout.timeout}
	SET_IDLE_TIMEOUT TIMEOUT={idle_timeout}
	{% endif %}
	PAUSE_BASE
	{client.user_pause_macro|default("")}
	_TOOLHEAD_PARK_PAUSE_CANCEL {rawparams}

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = RESUME_BASE
variable_last_extruder_temp = {'restore': False, 'temp': 0}
variable_restore_idle_timeout = 0
variable_idle_state = False
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set sp_move = client.speed_move|default(velocity) %}
	{% set runout_resume = True if client.runout_sensor|default("") == ""
	else True if not printer[client.runout_sensor].enabled
	else printer[client.runout_sensor].filament_detected %}
	{% set can_extrude = True if printer.toolhead.extruder == ''
	else printer[printer.toolhead.extruder].can_extrude %}
	{% set do_resume = False %}
	{% set prompt_txt = [] %}
	
	
	{% if printer.idle_timeout.state|upper == "IDLE" or idle_state %}
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=idle_state VALUE=False
	{% if last_extruder_temp.restore %}
	
	RESPOND TYPE=echo MSG='{"Restoring \"%s\" temperature to %3.1f\u00B0C, this may take some time" % (printer.toolhead.extruder, last_extruder_temp.temp) }'
	M109 S{last_extruder_temp.temp}
	{% set do_resume = True %}
	{% elif can_extrude %}
	{% set do_resume = True %}
	{% else %}
	RESPOND TYPE=error MSG='{"Resume aborted !!! \"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder}'
	{% set _d = prompt_txt.append("\"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder) %}
	{% endif %}
	
	{% elif can_extrude %}
	{% set do_resume = True %}
	{% else %}
	RESPOND TYPE=error MSG='{"Resume aborted !!! \"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder}'
	{% set _d = prompt_txt.append("\"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder) %}
	{% endif %}
	{% if runout_resume %}
	{% if do_resume %}
	{% if restore_idle_timeout > 0 %} SET_IDLE_TIMEOUT TIMEOUT={restore_idle_timeout} {% endif %}
	{client.user_resume_macro|default("")}
	_CLIENT_EXTRUDE
	RESUME_BASE VELOCITY={params.VELOCITY|default(sp_move)}
	{% endif %}
	{% else %}
	RESPOND TYPE=error MSG='{"Resume aborted !!! \"%s\" detects no filament, please load filament and press RESUME" % (client.runout_sensor.split(" "))[1]}'
	{% set _d = prompt_txt.append("\"%s\" detects no filament, please load filament and press RESUME" % (client.runout_sensor.split(" "))[1]) %}
	{% endif %}
	
	{% if not (runout_resume and do_resume) %}
	RESPOND TYPE=command MSG="action:prompt_begin RESUME aborted !!!"
	{% for element in prompt_txt %}
	RESPOND TYPE=command MSG='{"action:prompt_text %s" % element}'
	{% endfor %}
	RESPOND TYPE=command MSG="action:prompt_footer_button Ok|RESPOND TYPE=command MSG=action:prompt_end|info"
	RESPOND TYPE=command MSG="action:prompt_show"
	{% endif %}

[gcode_macro SET_PAUSE_NEXT_LAYER]
description = Enable a pause if the next layer is reached
gcode = 
	{% set pause_next_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_next_layer %}
	{% set ENABLE = params.ENABLE|default(1)|int != 0 %}
	{% set MACRO = params.MACRO|default(pause_next_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_next_layer VALUE="{{ 'enable': ENABLE, 'call': MACRO }}"

[gcode_macro SET_PAUSE_AT_LAYER]
description = Enable/disable a pause if a given layer number is reached
gcode = 
	{% set pause_at_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_at_layer %}
	{% set ENABLE = params.ENABLE|int != 0 if params.ENABLE is defined
	else params.LAYER is defined %}
	{% set LAYER = params.LAYER|default(pause_at_layer.layer)|int %}
	{% set MACRO = params.MACRO|default(pause_at_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_at_layer VALUE="{{ 'enable': ENABLE, 'layer': LAYER, 'call': MACRO }}"

[gcode_macro SET_PRINT_STATS_INFO]
rename_existing = SET_PRINT_STATS_INFO_BASE
description = Overwrite, to get pause_next_layer and pause_at_layer feature
variable_pause_next_layer = { 'enable': False, 'call': "PAUSE" }
variable_pause_at_layer = { 'enable': False, 'layer': 0, 'call': "PAUSE" }
gcode = 
	{% if pause_next_layer.enable %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_next_layer" % pause_next_layer.call}'
	{pause_next_layer.call}
	SET_PAUSE_NEXT_LAYER ENABLE=0
	{% elif pause_at_layer.enable and params.CURRENT_LAYER is defined and params.CURRENT_LAYER|int == pause_at_layer.layer %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_at_layer [%d]" % (pause_at_layer.call, pause_at_layer.layer)}'
	{pause_at_layer.call}
	SET_PAUSE_AT_LAYER ENABLE=0
	{% endif %}
	SET_PRINT_STATS_INFO_BASE {rawparams}

[gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL]
description = Helper: park toolhead used in PAUSE and CANCEL_PRINT
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set use_custom     = client.use_custom_pos|default(false)|lower == 'true' %}
	{% set custom_park_x  = client.custom_park_x|default(0.0) %}
	{% set custom_park_y  = client.custom_park_y|default(0.0) %}
	{% set park_dz        = client.custom_park_dz|default(2.0)|abs %}
	{% set sp_hop         = client.speed_hop|default(15) * 60 %}
	{% set sp_move        = client.speed_move|default(velocity) * 60 %}
	
	{% set origin    = printer.gcode_move.homing_origin %}
	{% set act       = printer.gcode_move.gcode_position %}
	{% set max       = printer.toolhead.axis_maximum %}
	{% set cone      = printer.toolhead.cone_start_z|default(max.z) %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	
	{% set z_min = params.Z_MIN|default(0)|float %}
	{% set z_park = [[(act.z + park_dz), z_min]|max, (max.z - origin.z)]|min %}
	{% set x_park = params.X       if params.X is defined
	else custom_park_x  if use_custom
	else 0.0            if round_bed
	else (max.x - 5.0) %}
	{% set y_park = params.Y       if params.Y is defined
	else custom_park_y  if use_custom
	else (max.y - 5.0)  if round_bed and z_park < cone
	else 0.0            if round_bed
	else (max.y - 5.0) %}
	
	_CLIENT_RETRACT
	{% if "xyz" in printer.toolhead.homed_axes %}
	G90
	G1 Z{z_park} F{sp_hop}
	G1 X{x_park} Y{y_park} F{sp_move}
	{% if not printer.gcode_move.absolute_coordinates %} G91 {% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='Printer not homed'
	{% endif %}

[gcode_macro _CLIENT_EXTRUDE]
description = Extrudes, if the extruder is hot enough
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set use_fw_retract = (client.use_fw_retract|default(false)|lower == 'true') and (printer.firmware_retraction is defined) %}
	{% set length = params.LENGTH|default(client.unretract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_unretract)|default(35) %}
	{% set absolute_extrude = printer.gcode_move.absolute_extrude %}
	
	{% if printer.toolhead.extruder != '' %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if use_fw_retract %}
	{% if length < 0 %}
	G10
	{% else %}
	G11
	{% endif %}
	{% else %}
	M83
	G1 E{length} F{(speed|float|abs) * 60}
	{% if absolute_extrude %}
	M82
	{% endif %}
	{% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='{"\"%s\" not hot enough" % printer.toolhead.extruder}'
	{% endif %}
	{% endif %}

[gcode_macro _CLIENT_RETRACT]
description = Retracts, if the extruder is hot enough
gcode = 
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set length = params.LENGTH|default(client.retract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_retract)|default(35) %}
	
	_CLIENT_EXTRUDE LENGTH=-{length|float|abs} SPEED={speed|float|abs}

[gcode_macro START_PRINT]
gcode = 
	{% set BED_TEMP = params.BED_TEMP|default(55)|float %}
	{% set EXTRUDER_TEMP = params.EXTRUDER_TEMP|default(200)|float %}
	M117 Print Starting...
	G28 X Y
	G90
	M220 S100
	M221 S100
	G92 E0
	
	
	
	
	
	
	M140 S{BED_TEMP}
	
	M190 S{BED_TEMP}
	
	M117 Waiting for temperature
	
	
	M117 Homing All...
	
	G90
	
	G28
	
	M117 Z-Tilt Adjust
	Z_TILT_ADJUST
	
	M117 Generating mesh
	
	BED_MESH_CLEAR
	
	BED_MESH_CALIBRATE
	
	BED_MESH_PROFILE LOAD=default
	
	G1 X100 Y392 F10000
	
	M117 Heaters Recovering...
	
	
	M109 S{EXTRUDER_TEMP} T0; start warming extruder to preheat temp
	
	
	M117 Purging extruder...
	
	
	CLEAN_AND_PURGE_NOZZLE
	
	M117 Printing.....
	UPDATE_DELAYED_GCODE ID=clear_display DURATION=10

[gcode_macro END_PRINT]
gcode = 
	
	{% set th = printer.toolhead %}
	{% set x_safe = th.position.x + 20 * (1 if th.axis_maximum.x - th.position.x > 20 else -1) %}
	{% set y_safe = th.position.y + 20 * (1 if th.axis_maximum.y - th.position.y > 20 else -1) %}
	{% set z_safe = [th.position.z + 2, th.axis_maximum.z]|min %}
	
	SAVE_GCODE_STATE NAME=STATE_PRINT_END
	
	
	
	M400
	G92 E0
	
	G91
	G1 E-0.7 Z+5 F3000
	G90
	
	TURN_OFF_HEATERS
	
	G0 X{x_safe} Y{y_safe} Z{z_safe} F20000
	G0 X{th.axis_maximum.x//2} Y{th.axis_maximum.y - 2} F3600
	
	AFTER_PRINT_CLEAN_NOZZLE
	
	G0 X{th.axis_maximum.x/2} Y{th.axis_maximum.y - 2} F3600
	
	TURN_OFF_HEATERS
	
	M84 X Y E
	
	
	SET_PRESSURE_ADVANCE ADVANCE=0.0
	M117 Pressure Advance Set 0.0
	
	
	
	
	BED_MESH_CLEAR
	
	
	
	
	
	M117 Print Finished
	UPDATE_DELAYED_GCODE ID=clear_display DURATION=10
	
	RESTORE_GCODE_STATE NAME=STATE_PRINT_END

[gcode_macro PRIME_LINE]
gcode = 
	M117 Prime Line
	G92 E0
	
	G1 Z2.0 F3000
	
	G1 X40 Y2 Z0.3 F5000.0
	G1 X120 Y2 Z0.3 F500.0 E15
	G1 X120 Y2.3 Z0.3 F5000.0
	G1 X40 Y2.3 Z0.3 F500.0 E30
	G92 E0
	G1 Z2.0 F3000

[gcode_macro CLEAN_NOZZLE]
variable_start_x = 63
variable_start_y = 387
variable_wipe_dist_y = -3
variable_wipe_qty = 5
variable_wipe_spd = 50
variable_end_loc_x = 189
variable_end_loc_y = 185
gcode = 
	SAVE_GCODE_STATE NAME=STATE_PRINT_CURRENT
	
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	G90
	M220 S100
	M204 S100
	M221 S100
	
	
	G1 X{start_x} Y{start_y} F6000
	
	
	{% for wipes in range(1, (wipe_qty + 1)) %}
	
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	
	{% endfor %}
	
	G1 X{end_loc_x} F10000
	
	RESTORE_GCODE_STATE NAME=STATE_PRINT_CURRENT

[gcode_macro CLEAN_AND_PURGE_NOZZLE]
variable_start_x = 63
variable_start_y = 387
variable_start_z = 10
variable_wipe_dist_y = -3
variable_wipe_qty = 5
variable_wipe_spd = 50
variable_purge_loc_x = 100
variable_purge_loc_y = 392
variable_post_purge_y = 386
variable_end_loc_x = 189
variable_end_loc_y = 185
gcode = 
	SAVE_GCODE_STATE NAME=STATE_PRINT_CURRENT
	
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	G90
	
	
	
	
	
	G1 X{start_x} Y{start_y} F6000
	
	
	{% for wipes in range(1, (wipe_qty + 1)) %}
	
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	
	{% endfor %}
	
	G1 X{purge_loc_x}
	G1 Y{purge_loc_y}
	G92 E0
	G1 E30.0 F100
	G92 E0
	G1 E-0.5 F300
	
	G1 Y{post_purge_y} F10000
	G1 X{start_x}
	G1 X{end_loc_x} F10000
	
	RESTORE_GCODE_STATE NAME=STATE_PRINT_CURRENT

[gcode_macro AFTER_PRINT_CLEAN_NOZZLE]
variable_start_x = 63
variable_start_y = 387
variable_wipe_dist_y = -3
variable_wipe_qty = 5
variable_wipe_spd = 50
gcode = 
	SAVE_GCODE_STATE NAME=STATE_PRINT_CURRENT
	
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	G90
	
	
	
	
	G1 X{start_x} Y{start_y} F6000
	
	
	{% for wipes in range(1, (wipe_qty + 1)) %}
	
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	
	{% endfor %}
	
	RESTORE_GCODE_STATE NAME=STATE_PRINT_CURRENT

[delayed_gcode clear_display]
gcode = 
	M117

[gcode_macro Probe_Z_Height]
gcode = 
	G28
	
	PROBE_CALIBRATE

[gcode_macro automatic_bed_screw_adjust]
gcode = 
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	SCREWS_TILT_CALCULATE

[gcode_macro z_motor_alignment]
gcode = 
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	Z_TILT_ADJUST

[gcode_macro Accelerometer_Connection_Test]
gcode = 
	ACCELEROMETER_QUERY

[gcode_macro X_Axis_Resonance_Test]
gcode = 
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	TEST_RESONANCES AXIS=X

[gcode_macro Y_Axis_Resonance_Test]
gcode = 
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	TEST_RESONANCES AXIS=Y

[gcode_macro update_git]
gcode = 
	RUN_SHELL_COMMAND CMD=update_git_script

[gcode_shell_command update_git_script]
command = bash /home/pi/klipper-backup/script.sh
timeout = 90.0
verbose = True

[gcode_macro BED_MESH_CALIBRATE]
rename_existing = _BED_MESH_CALIBRATE
gcode = 
	
	{% set all_points = printer.exclude_object.objects | map(attribute='polygon') | sum(start=[]) %}
	{% set bed_mesh_min = printer.configfile.settings.bed_mesh.mesh_min %}
	{% set bed_mesh_max = printer.configfile.settings.bed_mesh.mesh_max %}
	{% set probe_count = printer.configfile.settings.bed_mesh.probe_count %}
	{% set kamp_settings = printer["gcode_macro _KAMP_Settings"] %}
	{% set verbose_enable = kamp_settings.verbose_enable | abs %}
	{% set probe_dock_enable = kamp_settings.probe_dock_enable | abs %}
	{% set attach_macro = kamp_settings.attach_macro | string %}
	{% set detach_macro = kamp_settings.detach_macro | string %}
	{% set mesh_margin = kamp_settings.mesh_margin | float %}
	{% set fuzz_amount = kamp_settings.fuzz_amount | float %}
	{% set probe_count = probe_count if probe_count|length > 1 else probe_count * 2  %}
	{% set max_probe_point_distance_x = ( bed_mesh_max[0] - bed_mesh_min[0] ) / (probe_count[0] - 1)  %}
	{% set max_probe_point_distance_y = ( bed_mesh_max[1] - bed_mesh_min[1] ) / (probe_count[1] - 1)  %}
	{% set x_min = all_points | map(attribute=0) | min | default(bed_mesh_min[0]) %}
	{% set y_min = all_points | map(attribute=1) | min | default(bed_mesh_min[1]) %}
	{% set x_max = all_points | map(attribute=0) | max | default(bed_mesh_max[0]) %}
	{% set y_max = all_points | map(attribute=1) | max | default(bed_mesh_max[1]) %}
	
	{% set fuzz_range = range((0) | int, (fuzz_amount * 100) | int + 1) %}
	{% set adapted_x_min = x_min - mesh_margin - (fuzz_range | random / 100.0) %}
	{% set adapted_y_min = y_min - mesh_margin - (fuzz_range | random / 100.0) %}
	{% set adapted_x_max = x_max + mesh_margin + (fuzz_range | random / 100.0) %}
	{% set adapted_y_max = y_max + mesh_margin + (fuzz_range | random / 100.0) %}
	
	{% set adapted_x_min = [adapted_x_min , bed_mesh_min[0]] | max %}
	{% set adapted_y_min = [adapted_y_min , bed_mesh_min[1]] | max %}
	{% set adapted_x_max = [adapted_x_max , bed_mesh_max[0]] | min %}
	{% set adapted_y_max = [adapted_y_max , bed_mesh_max[1]] | min %}
	
	{% set points_x = (((adapted_x_max - adapted_x_min) / max_probe_point_distance_x) | round(method='ceil') | int) + 1 %}
	{% set points_y = (((adapted_y_max - adapted_y_min) / max_probe_point_distance_y) | round(method='ceil') | int) + 1 %}
	
	{% if (([points_x, points_y]|max) > 6) %}
	{% set algorithm = "bicubic" %}
	{% set min_points = 4 %}
	{% else %}
	{% set algorithm = "lagrange" %}
	{% set min_points = 3 %}
	{% endif %}
	
	{% set points_x = [points_x , min_points]|max %}
	{% set points_y = [points_y , min_points]|max %}
	{% set points_x = [points_x , probe_count[0]]|min %}
	{% set points_y = [points_y , probe_count[1]]|min %}
	
	{% if verbose_enable == True %}
	{% if printer.exclude_object.objects != [] %}
	
	{ action_respond_info( "Algorithm: {}.".format(
	(algorithm),
	)) }
	
	{ action_respond_info("Default probe count: {},{}.".format(
	(probe_count[0]),
	(probe_count[1]),
	)) }
	
	{ action_respond_info("Adapted probe count: {},{}.".format(
	(points_x),
	(points_y),
	)) }
	
	{action_respond_info("Default mesh bounds: {}, {}.".format(
	(bed_mesh_min[0],bed_mesh_min[1]),
	(bed_mesh_max[0],bed_mesh_max[1]),
	)) }
	
	{% if mesh_margin > 0 %}
	{action_respond_info("Mesh margin is {}, mesh bounds extended by {}mm.".format(
	(mesh_margin),
	(mesh_margin),
	)) }
	{% else %}
	{action_respond_info("Mesh margin is 0, margin not increased.")}
	{% endif %}
	
	{% if fuzz_amount > 0 %}
	{action_respond_info("Mesh point fuzzing enabled, points fuzzed up to {}mm.".format(
	(fuzz_amount),
	)) }
	{% else %}
	{action_respond_info("Fuzz amount is 0, mesh points not fuzzed.")}
	{% endif %}
	
	{ action_respond_info("Adapted mesh bounds: {}, {}.".format(
	(adapted_x_min, adapted_y_min),
	(adapted_x_max, adapted_y_max),
	)) }
	
	{action_respond_info("KAMP adjustments successful. Happy KAMPing!")}
	
	{% else %}
	
	{action_respond_info("No objects detected! Check your gcode and make sure that EXCLUDE_OBJECT_DEFINE is happening before BED_MESH_CALIBRATE is called. Defaulting to regular meshing.")}
	G4 P5000
	{% endif %}
	
	{% endif %}
	
	{% if probe_dock_enable == True %}
	{attach_macro}
	{% endif %}
	
	_BED_MESH_CALIBRATE mesh_min={adapted_x_min},{adapted_y_min} mesh_max={adapted_x_max},{adapted_y_max} ALGORITHM={algorithm} PROBE_COUNT={points_x},{points_y}
	
	{% if probe_dock_enable == True %}
	{detach_macro}
	{% endif %}

[gcode_macro _KAMP_Settings]
description = This macro contains all adjustable settings for KAMP
variable_verbose_enable = True
variable_mesh_margin = 0
variable_fuzz_amount = 0
variable_probe_dock_enable = False
variable_attach_macro = 'Attach_Probe'
variable_detach_macro = 'Dock_Probe'
variable_purge_height = 0.8
variable_tip_distance = 0
variable_purge_margin = 10
variable_purge_amount = 30
variable_flow_rate = 12
variable_smart_park_height = 10
gcode = 
	
	{action_respond_info(" Running the KAMP_Settings macro does nothing, it is only used for storing KAMP settings. ")}

[led_effect sb_logo_busy]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (1,0,0)

[led_effect sb_logo_cleaning]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 0.02, 0.5)

[led_effect sb_logo_calibrating_z]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 0.0, 0.35)

[led_effect sb_logo_heating]
leds = 
	neopixel:sb_leds (1,3,7,8,6,2)
autostart = false
frame_rate = 24
layers = 
	comet  0.3  0 add (1, 0.18, 0)

[led_effect sb_logo_cooling]
leds = 
	neopixel:sb_leds (1,3,7,8,6,2)
autostart = false
frame_rate = 24
layers = 
	comet  0.3  0 add (0, 0, 1)

[led_effect sb_logo_homing]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 0.6, 0.2)

[led_effect sb_logo_leveling]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.5, 0.1, 0.4)

[led_effect sb_logo_meshing]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.2, 1.0, 0.0)

[led_effect sb_logo_printing]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	gradient  0.3  1 add (0.3, 0.0, 0.0),(0.3, 0.3, 0.0),(0.3, 0.1, 0.0)

[led_effect sb_logo_standby]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.01, 0.01, 0.01)

[led_effect sb_logo_part_ready]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 1.0, 0.0)

[led_effect sb_nozzle_heating]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (1.0, 0.18, 0.0, 0.0)

[led_effect sb_nozzle_cooling]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (0.0, 0.0, 1.0, 0.1)

[led_effect sb_nozzle_standby]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (0.6, 0.0, 0.0, 0.0)

[led_effect sb_nozzle_part_ready]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (0.6, 1.0, 0.0, 0.1)

[led_effect sb_critical_error]
leds = 
	neopixel:sb_leds
layers = 
	strobe         1  1.5   add        (1.0,  1.0, 1.0)
	breathing      2  0     difference (0.95, 0.0, 0.0)
	static         1  0     top        (1.0,  0.0, 0.0)
autostart = false
frame_rate = 24
run_on_error = true

[led_effect rainbow]
leds = 
	neopixel:chamber_leds
autostart = false
frame_rate = 24
layers = 
	gradient  0.3  1 add (0.3, 0.0, 0.0),(0.0, 0.3, 0.0),(0.0, 0.0, 0.3)

[led_effect set_nozzle_leds]
leds = 
	neopixel:sb_leds (9,10)
autostart = false
frame_rate = 24
layers = 
	static         0  0     top        (0.0,  0.0, 0.0, 1.0)

[led_effect set_logo_leds]
leds = 
	neopixel:sb_leds (1,2,3,4,5,6,7,8)
autostart = false
frame_rate = 24
layers = 
	static         0  0     top        (1.0,  1.0, 1.0)

[led_effect set_chamber_leds]
leds = 
	neopixel:chamber_leds
autostart = false
frame_rate = 24
layers = 
	static         0  0     top        (1.0,  1.0, 1.0)

[gcode_macro set_logo_leds_off]
gcode = 
	SET_LED_EFFECT EFFECT=set_logo_leds STOP=1

[gcode_macro set_logo_leds_on]
gcode = 
	SET_LED_EFFECT EFFECT=set_logo_leds

[gcode_macro set_nozzle_leds_on]
gcode = 
	SET_LED_EFFECT EFFECT=set_nozzle_leds

[gcode_macro set_nozzle_leds_off]
gcode = 
	SET_LED_EFFECT EFFECT=set_nozzle_leds STOP=1

[gcode_macro set_chamber_leds_off]
gcode = 
	SET_LED_EFFECT EFFECT=set_chamber_leds STOP=1

[gcode_macro set_chamber_leds_on]
gcode = 
	SET_LED_EFFECT EFFECT=set_chamber_leds

[gcode_macro status_off]
gcode = 
	STOP_LED_EFFECTS

[gcode_macro status_ready]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=rainbow

[gcode_macro status_part_ready]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_nozzle_part_ready
	SET_LED_EFFECT EFFECT=sb_logo_part_ready

[gcode_macro status_busy]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_busy
	set_nozzle_leds_on

[gcode_macro status_heating]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_heating
	SET_LED_EFFECT EFFECT=sb_nozzle_heating

[gcode_macro status_cooling]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_cooling
	SET_LED_EFFECT EFFECT=sb_nozzle_cooling

[gcode_macro status_leveling]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_leveling
	set_nozzle_leds_on

[gcode_macro status_homing]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_homing
	set_nozzle_leds_on

[gcode_macro status_cleaning]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_cleaning
	set_nozzle_leds_on

[gcode_macro status_meshing]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_meshing
	set_nozzle_leds_on

[gcode_macro status_calibrating_z]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_calibrating_z
	set_nozzle_leds_on

[gcode_macro status_printing]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_printing
	set_nozzle_leds_on

[printer]
kinematics = corexy
max_velocity = 300
max_accel = 5700
max_z_velocity = 5
max_z_accel = 100
square_corner_velocity = 5.0

[mcu]
serial = /dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00

[mcu rpi]
serial = /tmp/klipper_host_mcu

[adxl345]
cs_pin = rpi:None

[resonance_tester]
accel_chip = adxl345
probe_points = 
	189,185,20

[input_shaper]
shaper_freq_x = 61.8
shaper_type_x = mzv
shaper_freq_y = 38.4
shaper_type_y = zv

[stepper_x]
step_pin = P1.4
dir_pin = !P1.8
enable_pin = !P1.0
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 40
endstop_pin = ^P1.29
position_endstop = 383
position_min = -5
position_max = 383
homing_speed = 25
homing_retract_dist = 5.0

[tmc2209 stepper_x]
uart_pin = P1.1
interpolate = False
run_current = 1.00
stealthchop_threshold = 0

[stepper_y]
step_pin = P1.14
dir_pin = !P1.15
enable_pin = !P1.9
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 40
endstop_pin = ^P1.28
position_endstop = 392
position_min = -8
position_max = 392
homing_speed = 25
homing_retract_dist = 5.0

[tmc2209 stepper_y]
uart_pin = P1.10
interpolate = False
run_current = 1.00
stealthchop_threshold = 0

[stepper_z]
step_pin = P4.29
dir_pin = !P4.28
enable_pin = !P1.16
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 4
endstop_pin = probe:z_virtual_endstop
position_min = -5
position_max = 395

[tmc2209 stepper_z]
uart_pin = P1.17
interpolate = False
run_current = 0.580
stealthchop_threshold = 0

[stepper_z1]
step_pin = P2.11
dir_pin = !P2.12
enable_pin = !P0.21
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 4

[tmc2209 stepper_z1]
uart_pin = P0.22
interpolate = False
run_current = 0.580
stealthchop_threshold = 0

[extruder]
step_pin = P2.6
dir_pin = !P2.7
enable_pin = !P0.4
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 35.291
gear_ratio = 7.5:1
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = P2.3
sensor_type = PT1000
sensor_pin = P0.24
control = pid
pid_kp = 14.430
pid_ki = 1.023
pid_kd = 50.866
min_temp = 10
max_temp = 350
max_extrude_only_distance = 500
max_extrude_only_velocity = 120
min_extrude_temp = 180
max_extrude_cross_section = 50.
pressure_advance = 0.000
pressure_advance_smooth_time = 0.03

[tmc2209 extruder]
uart_pin = P0.5
interpolate = false
run_current = 0.79
stealthchop_threshold = 0
driver_tbl = 0
driver_hend = 6
driver_hstrt = 7
driver_toff = 4

[static_digital_output tmc_standby_pins]
pins = !P3.26, !P3.25, !P1.18, !P1.19, !P2.13

[heater_bed]
heater_pin = P2.5
sensor_type = EPCOS 100K B57560G104F
sensor_pin = P0.25
control = pid
pid_kp = 68.561
pid_ki = 0.619
pid_kd = 1897.417
min_temp = 0
max_temp = 130

[idle_timeout]
timeout = 3600

[bltouch]
sensor_pin = ^P1.27
control_pin = P1.23
x_offset = -33
y_offset = -5
z_offset = 2.500
samples = 1
samples_result = average
sample_retract_dist = 2.0
samples_tolerance = 0.05
samples_tolerance_retries = 3
stow_on_each_sample = False

[safe_z_home]
home_xy_position = 221,190
speed = 60
z_hop = 12
z_hop_speed = 5

[screws_tilt_adjust]
screw1 = 69, 319
screw1_name = rear left screw
screw2 = 368, 60
screw2_name = front right screw
screw3 = 368, 319
screw3_name = rear right screw
screw4 = 69, 60
screw4_name = front left screw
horizontal_move_z = 10.
speed = 50.
screw_thread = CW-M4

[z_tilt]
z_positions = -20, 183
	402, 183
points = 56, 183
	383, 183
speed = 50
horizontal_move_z = 10
retries = 20
retry_tolerance = 0.01

[bed_mesh]
speed = 120
horizontal_move_z = 5
mesh_min = 50, 80
mesh_max = 323, 314
probe_count = 7, 7
algorithm = bicubic
bicubic_tension = 0.5
fade_start = 0.6
fade_end = 10
fade_target = 0

[fan]
pin = P2.1

[heater_fan heatbreak_cooling_fan]
pin = P2.2

[display]
lcd_type = st7920
menu_timeout = 600
cs_pin = EXP1_7
sclk_pin = EXP1_6
sid_pin = EXP1_8
encoder_pins = ^EXP1_5, ^EXP1_3
click_pin = ^!EXP1_2

[output_pin beeper]
pin = EXP1_1

[board_pins]
aliases = 
	
	EXP1_1=P2.8,  EXP1_3=P0.19, EXP1_5=P0.20, EXP1_7=P0.17, EXP1_9=<GND>,
	EXP1_2=P0.16, EXP1_4=<RST>, EXP1_6=P0.15, EXP1_8=P0.18, EXP1_10=<5V>

[filament_motion_sensor SmartFilamentSensor_T0]
detection_length = 7.00
extruder = extruder
switch_pin = ^P1.26
pause_on_runout = True
event_delay = 3.0
pause_delay = 0.5
runout_gcode = 
	M117 Runout Detected!

[temperature_sensor raspberry_pi]
sensor_type = temperature_host
min_temp = 10
max_temp = 100

[temperature_sensor Mainboard]
sensor_type = NTC 100K MGB18-104F39050L32
sensor_pin = P1.30
min_temp = 10
max_temp = 100

[neopixel chamber_leds]
pin = P1.22
chain_count = 85
color_order = GRB
initial_red = 0.0
initial_green = 0.0
initial_blue = 0.0
initial_white = 0.0

[neopixel sb_leds]
pin = P1.24
chain_count = 10
color_order = GRB,GRB,GRB,GRB,GRB,GRB,GRB,GRB,GRBW,GRBW
initial_red = 0.0
initial_green = 0.0
initial_blue = 0.0
initial_white = 0.0

[exclude_object]

[gcode_arcs]
resolution = 0.1
=======================
Extruder max_extrude_ratio=20.787584
mcu 'mcu': Starting serial connect
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00'
webhooks client 4123718152: New connection
webhooks client 4123718152: Client info {'program': 'Moonraker', 'version': 'v0.8.0-247-g3008a13'}
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00'
Starting Klippy...
Args: ['/home/pi/klipper/klippy/klippy.py', '/home/pi/printer_data/config/printer.cfg', '-l', '/home/pi/printer_data/logs/klippy.log', '-I', '/home/pi/printer_data/comms/klippy.serial', '-a', '/home/pi/printer_data/comms/klippy.sock']
Git version: 'v0.12.0-65-g96ab9069-dirty'
Untracked files: klippy/extras/gcode_shell_command.py, klippy/extras/led_effect.py
Branch: master
Remote: origin
Tracked URL: https://github.com/Klipper3d/klipper.git
CPU: 4 core ?
Python: '3.9.2 (default, Mar 12 2021, 04:06:34) \n[GCC 10.2.1 20210110]'
Start printer at Fri Jan 12 19:15:10 2024 (1705086910.6 1674.5)
===== Config file =====
[virtual_sdcard]
path = ~/printer_data/gcodes
on_error_gcode = CANCEL_PRINT

[pause_resume]

[display_status]

[respond]

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = CANCEL_PRINT_BASE
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set allow_park = client.park_at_cancel|default(false)|lower == 'true' %}
	{% set retract = client.cancel_retract|default(5.0)|abs %}
	
	{% set park_x = "" if (client.park_at_cancel_x|default(none) is none)
	else "X=" ~ client.park_at_cancel_x %}
	{% set park_y = "" if (client.park_at_cancel_y|default(none) is none)
	else "Y=" ~ client.park_at_cancel_y %}
	{% set custom_park = park_x|length > 0 or park_y|length > 0 %}
	
	
	{% if printer['gcode_macro RESUME'].restore_idle_timeout > 0 %}
	SET_IDLE_TIMEOUT TIMEOUT={printer['gcode_macro RESUME'].restore_idle_timeout}
	{% endif %}
	{% if (custom_park or not printer.pause_resume.is_paused) and allow_park %} _TOOLHEAD_PARK_PAUSE_CANCEL {park_x} {park_y} {% endif %}
	_CLIENT_RETRACT LENGTH={retract}
	TURN_OFF_HEATERS
	M106 S0
	{client.user_cancel_macro|default("")}
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=idle_state VALUE=False
	
	SET_PAUSE_NEXT_LAYER ENABLE=0
	SET_PAUSE_AT_LAYER ENABLE=0 LAYER=0
	CANCEL_PRINT_BASE

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = PAUSE_BASE
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set idle_timeout = client.idle_timeout|default(0) %}
	{% set temp = printer[printer.toolhead.extruder].target if printer.toolhead.extruder != '' else 0 %}
	{% set restore = False if printer.toolhead.extruder == ''
	else True  if params.RESTORE|default(1)|int == 1 else False %}
	
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=last_extruder_temp VALUE="{{'restore': restore, 'temp': temp}}"
	
	{% if idle_timeout > 0 %}
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=restore_idle_timeout VALUE={printer.configfile.settings.idle_timeout.timeout}
	SET_IDLE_TIMEOUT TIMEOUT={idle_timeout}
	{% endif %}
	PAUSE_BASE
	{client.user_pause_macro|default("")}
	_TOOLHEAD_PARK_PAUSE_CANCEL {rawparams}

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = RESUME_BASE
variable_last_extruder_temp = {'restore': False, 'temp': 0}
variable_restore_idle_timeout = 0
variable_idle_state = False
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set sp_move = client.speed_move|default(velocity) %}
	{% set runout_resume = True if client.runout_sensor|default("") == ""
	else True if not printer[client.runout_sensor].enabled
	else printer[client.runout_sensor].filament_detected %}
	{% set can_extrude = True if printer.toolhead.extruder == ''
	else printer[printer.toolhead.extruder].can_extrude %}
	{% set do_resume = False %}
	{% set prompt_txt = [] %}
	
	
	{% if printer.idle_timeout.state|upper == "IDLE" or idle_state %}
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=idle_state VALUE=False
	{% if last_extruder_temp.restore %}
	
	RESPOND TYPE=echo MSG='{"Restoring \"%s\" temperature to %3.1f\u00B0C, this may take some time" % (printer.toolhead.extruder, last_extruder_temp.temp) }'
	M109 S{last_extruder_temp.temp}
	{% set do_resume = True %}
	{% elif can_extrude %}
	{% set do_resume = True %}
	{% else %}
	RESPOND TYPE=error MSG='{"Resume aborted !!! \"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder}'
	{% set _d = prompt_txt.append("\"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder) %}
	{% endif %}
	
	{% elif can_extrude %}
	{% set do_resume = True %}
	{% else %}
	RESPOND TYPE=error MSG='{"Resume aborted !!! \"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder}'
	{% set _d = prompt_txt.append("\"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder) %}
	{% endif %}
	{% if runout_resume %}
	{% if do_resume %}
	{% if restore_idle_timeout > 0 %} SET_IDLE_TIMEOUT TIMEOUT={restore_idle_timeout} {% endif %}
	{client.user_resume_macro|default("")}
	_CLIENT_EXTRUDE
	RESUME_BASE VELOCITY={params.VELOCITY|default(sp_move)}
	{% endif %}
	{% else %}
	RESPOND TYPE=error MSG='{"Resume aborted !!! \"%s\" detects no filament, please load filament and press RESUME" % (client.runout_sensor.split(" "))[1]}'
	{% set _d = prompt_txt.append("\"%s\" detects no filament, please load filament and press RESUME" % (client.runout_sensor.split(" "))[1]) %}
	{% endif %}
	
	{% if not (runout_resume and do_resume) %}
	RESPOND TYPE=command MSG="action:prompt_begin RESUME aborted !!!"
	{% for element in prompt_txt %}
	RESPOND TYPE=command MSG='{"action:prompt_text %s" % element}'
	{% endfor %}
	RESPOND TYPE=command MSG="action:prompt_footer_button Ok|RESPOND TYPE=command MSG=action:prompt_end|info"
	RESPOND TYPE=command MSG="action:prompt_show"
	{% endif %}

[gcode_macro SET_PAUSE_NEXT_LAYER]
description = Enable a pause if the next layer is reached
gcode = 
	{% set pause_next_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_next_layer %}
	{% set ENABLE = params.ENABLE|default(1)|int != 0 %}
	{% set MACRO = params.MACRO|default(pause_next_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_next_layer VALUE="{{ 'enable': ENABLE, 'call': MACRO }}"

[gcode_macro SET_PAUSE_AT_LAYER]
description = Enable/disable a pause if a given layer number is reached
gcode = 
	{% set pause_at_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_at_layer %}
	{% set ENABLE = params.ENABLE|int != 0 if params.ENABLE is defined
	else params.LAYER is defined %}
	{% set LAYER = params.LAYER|default(pause_at_layer.layer)|int %}
	{% set MACRO = params.MACRO|default(pause_at_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_at_layer VALUE="{{ 'enable': ENABLE, 'layer': LAYER, 'call': MACRO }}"

[gcode_macro SET_PRINT_STATS_INFO]
rename_existing = SET_PRINT_STATS_INFO_BASE
description = Overwrite, to get pause_next_layer and pause_at_layer feature
variable_pause_next_layer = { 'enable': False, 'call': "PAUSE" }
variable_pause_at_layer = { 'enable': False, 'layer': 0, 'call': "PAUSE" }
gcode = 
	{% if pause_next_layer.enable %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_next_layer" % pause_next_layer.call}'
	{pause_next_layer.call}
	SET_PAUSE_NEXT_LAYER ENABLE=0
	{% elif pause_at_layer.enable and params.CURRENT_LAYER is defined and params.CURRENT_LAYER|int == pause_at_layer.layer %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_at_layer [%d]" % (pause_at_layer.call, pause_at_layer.layer)}'
	{pause_at_layer.call}
	SET_PAUSE_AT_LAYER ENABLE=0
	{% endif %}
	SET_PRINT_STATS_INFO_BASE {rawparams}

[gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL]
description = Helper: park toolhead used in PAUSE and CANCEL_PRINT
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set use_custom     = client.use_custom_pos|default(false)|lower == 'true' %}
	{% set custom_park_x  = client.custom_park_x|default(0.0) %}
	{% set custom_park_y  = client.custom_park_y|default(0.0) %}
	{% set park_dz        = client.custom_park_dz|default(2.0)|abs %}
	{% set sp_hop         = client.speed_hop|default(15) * 60 %}
	{% set sp_move        = client.speed_move|default(velocity) * 60 %}
	
	{% set origin    = printer.gcode_move.homing_origin %}
	{% set act       = printer.gcode_move.gcode_position %}
	{% set max       = printer.toolhead.axis_maximum %}
	{% set cone      = printer.toolhead.cone_start_z|default(max.z) %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	
	{% set z_min = params.Z_MIN|default(0)|float %}
	{% set z_park = [[(act.z + park_dz), z_min]|max, (max.z - origin.z)]|min %}
	{% set x_park = params.X       if params.X is defined
	else custom_park_x  if use_custom
	else 0.0            if round_bed
	else (max.x - 5.0) %}
	{% set y_park = params.Y       if params.Y is defined
	else custom_park_y  if use_custom
	else (max.y - 5.0)  if round_bed and z_park < cone
	else 0.0            if round_bed
	else (max.y - 5.0) %}
	
	_CLIENT_RETRACT
	{% if "xyz" in printer.toolhead.homed_axes %}
	G90
	G1 Z{z_park} F{sp_hop}
	G1 X{x_park} Y{y_park} F{sp_move}
	{% if not printer.gcode_move.absolute_coordinates %} G91 {% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='Printer not homed'
	{% endif %}

[gcode_macro _CLIENT_EXTRUDE]
description = Extrudes, if the extruder is hot enough
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set use_fw_retract = (client.use_fw_retract|default(false)|lower == 'true') and (printer.firmware_retraction is defined) %}
	{% set length = params.LENGTH|default(client.unretract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_unretract)|default(35) %}
	{% set absolute_extrude = printer.gcode_move.absolute_extrude %}
	
	{% if printer.toolhead.extruder != '' %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if use_fw_retract %}
	{% if length < 0 %}
	G10
	{% else %}
	G11
	{% endif %}
	{% else %}
	M83
	G1 E{length} F{(speed|float|abs) * 60}
	{% if absolute_extrude %}
	M82
	{% endif %}
	{% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='{"\"%s\" not hot enough" % printer.toolhead.extruder}'
	{% endif %}
	{% endif %}

[gcode_macro _CLIENT_RETRACT]
description = Retracts, if the extruder is hot enough
gcode = 
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set length = params.LENGTH|default(client.retract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_retract)|default(35) %}
	
	_CLIENT_EXTRUDE LENGTH=-{length|float|abs} SPEED={speed|float|abs}

[gcode_macro START_PRINT]
gcode = 
	{% set BED_TEMP = params.BED_TEMP|default(55)|float %}
	{% set EXTRUDER_TEMP = params.EXTRUDER_TEMP|default(200)|float %}
	M117 Print Starting...
	G28 X Y
	G90
	M220 S100
	M221 S100
	G92 E0
	
	
	
	
	
	
	M140 S{BED_TEMP}
	
	M190 S{BED_TEMP}
	
	M117 Waiting for temperature
	
	
	M117 Homing All...
	
	G90
	
	G28
	
	M117 Z-Tilt Adjust
	Z_TILT_ADJUST
	
	M117 Generating mesh
	
	BED_MESH_CLEAR
	
	BED_MESH_CALIBRATE
	
	BED_MESH_PROFILE LOAD=default
	
	G1 X100 Y392 F10000
	
	M117 Heaters Recovering...
	
	
	M109 S{EXTRUDER_TEMP} T0; start warming extruder to preheat temp
	
	
	M117 Purging extruder...
	
	
	CLEAN_AND_PURGE_NOZZLE
	
	M117 Printing.....
	UPDATE_DELAYED_GCODE ID=clear_display DURATION=10

[gcode_macro END_PRINT]
gcode = 
	
	{% set th = printer.toolhead %}
	{% set x_safe = th.position.x + 20 * (1 if th.axis_maximum.x - th.position.x > 20 else -1) %}
	{% set y_safe = th.position.y + 20 * (1 if th.axis_maximum.y - th.position.y > 20 else -1) %}
	{% set z_safe = [th.position.z + 2, th.axis_maximum.z]|min %}
	
	SAVE_GCODE_STATE NAME=STATE_PRINT_END
	
	
	
	M400
	G92 E0
	
	G91
	G1 E-0.7 Z+5 F3000
	G90
	
	TURN_OFF_HEATERS
	
	G0 X{x_safe} Y{y_safe} Z{z_safe} F20000
	G0 X{th.axis_maximum.x//2} Y{th.axis_maximum.y - 2} F3600
	
	AFTER_PRINT_CLEAN_NOZZLE
	
	G0 X{th.axis_maximum.x/2} Y{th.axis_maximum.y - 2} F3600
	
	TURN_OFF_HEATERS
	
	M84 X Y E
	
	
	SET_PRESSURE_ADVANCE ADVANCE=0.0
	M117 Pressure Advance Set 0.0
	
	
	
	
	BED_MESH_CLEAR
	
	
	
	
	
	M117 Print Finished
	UPDATE_DELAYED_GCODE ID=clear_display DURATION=10
	
	RESTORE_GCODE_STATE NAME=STATE_PRINT_END

[gcode_macro PRIME_LINE]
gcode = 
	M117 Prime Line
	G92 E0
	
	G1 Z2.0 F3000
	
	G1 X40 Y2 Z0.3 F5000.0
	G1 X120 Y2 Z0.3 F500.0 E15
	G1 X120 Y2.3 Z0.3 F5000.0
	G1 X40 Y2.3 Z0.3 F500.0 E30
	G92 E0
	G1 Z2.0 F3000

[gcode_macro CLEAN_NOZZLE]
variable_start_x = 63
variable_start_y = 387
variable_wipe_dist_y = -3
variable_wipe_qty = 5
variable_wipe_spd = 50
variable_end_loc_x = 189
variable_end_loc_y = 185
gcode = 
	SAVE_GCODE_STATE NAME=STATE_PRINT_CURRENT
	
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	G90
	M220 S100
	M204 S100
	M221 S100
	
	
	G1 X{start_x} Y{start_y} F6000
	
	
	{% for wipes in range(1, (wipe_qty + 1)) %}
	
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	
	{% endfor %}
	
	G1 X{end_loc_x} F10000
	
	RESTORE_GCODE_STATE NAME=STATE_PRINT_CURRENT

[gcode_macro CLEAN_AND_PURGE_NOZZLE]
variable_start_x = 63
variable_start_y = 387
variable_start_z = 10
variable_wipe_dist_y = -3
variable_wipe_qty = 5
variable_wipe_spd = 50
variable_purge_loc_x = 100
variable_purge_loc_y = 392
variable_post_purge_y = 386
variable_end_loc_x = 189
variable_end_loc_y = 185
gcode = 
	SAVE_GCODE_STATE NAME=STATE_PRINT_CURRENT
	
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	G90
	
	
	
	
	
	G1 X{start_x} Y{start_y} F6000
	
	
	{% for wipes in range(1, (wipe_qty + 1)) %}
	
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	
	{% endfor %}
	
	G1 X{purge_loc_x}
	G1 Y{purge_loc_y}
	G92 E0
	G1 E30.0 F100
	G92 E0
	G1 E-0.5 F300
	
	G1 Y{post_purge_y} F10000
	G1 X{start_x}
	G1 X{end_loc_x} F10000
	
	RESTORE_GCODE_STATE NAME=STATE_PRINT_CURRENT

[gcode_macro AFTER_PRINT_CLEAN_NOZZLE]
variable_start_x = 63
variable_start_y = 387
variable_wipe_dist_y = -3
variable_wipe_qty = 5
variable_wipe_spd = 50
gcode = 
	SAVE_GCODE_STATE NAME=STATE_PRINT_CURRENT
	
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	G90
	
	
	
	
	G1 X{start_x} Y{start_y} F6000
	
	
	{% for wipes in range(1, (wipe_qty + 1)) %}
	
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	
	{% endfor %}
	
	RESTORE_GCODE_STATE NAME=STATE_PRINT_CURRENT

[delayed_gcode clear_display]
gcode = 
	M117

[gcode_macro Probe_Z_Height]
gcode = 
	G28
	
	PROBE_CALIBRATE

[gcode_macro automatic_bed_screw_adjust]
gcode = 
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	SCREWS_TILT_CALCULATE

[gcode_macro z_motor_alignment]
gcode = 
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	Z_TILT_ADJUST

[gcode_macro Accelerometer_Connection_Test]
gcode = 
	ACCELEROMETER_QUERY

[gcode_macro X_Axis_Resonance_Test]
gcode = 
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	TEST_RESONANCES AXIS=X

[gcode_macro Y_Axis_Resonance_Test]
gcode = 
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	TEST_RESONANCES AXIS=Y

[gcode_macro update_git]
gcode = 
	RUN_SHELL_COMMAND CMD=update_git_script

[gcode_shell_command update_git_script]
command = bash /home/pi/klipper-backup/script.sh
timeout = 90.0
verbose = True

[gcode_macro BED_MESH_CALIBRATE]
rename_existing = _BED_MESH_CALIBRATE
gcode = 
	
	{% set all_points = printer.exclude_object.objects | map(attribute='polygon') | sum(start=[]) %}
	{% set bed_mesh_min = printer.configfile.settings.bed_mesh.mesh_min %}
	{% set bed_mesh_max = printer.configfile.settings.bed_mesh.mesh_max %}
	{% set probe_count = printer.configfile.settings.bed_mesh.probe_count %}
	{% set kamp_settings = printer["gcode_macro _KAMP_Settings"] %}
	{% set verbose_enable = kamp_settings.verbose_enable | abs %}
	{% set probe_dock_enable = kamp_settings.probe_dock_enable | abs %}
	{% set attach_macro = kamp_settings.attach_macro | string %}
	{% set detach_macro = kamp_settings.detach_macro | string %}
	{% set mesh_margin = kamp_settings.mesh_margin | float %}
	{% set fuzz_amount = kamp_settings.fuzz_amount | float %}
	{% set probe_count = probe_count if probe_count|length > 1 else probe_count * 2  %}
	{% set max_probe_point_distance_x = ( bed_mesh_max[0] - bed_mesh_min[0] ) / (probe_count[0] - 1)  %}
	{% set max_probe_point_distance_y = ( bed_mesh_max[1] - bed_mesh_min[1] ) / (probe_count[1] - 1)  %}
	{% set x_min = all_points | map(attribute=0) | min | default(bed_mesh_min[0]) %}
	{% set y_min = all_points | map(attribute=1) | min | default(bed_mesh_min[1]) %}
	{% set x_max = all_points | map(attribute=0) | max | default(bed_mesh_max[0]) %}
	{% set y_max = all_points | map(attribute=1) | max | default(bed_mesh_max[1]) %}
	
	{% set fuzz_range = range((0) | int, (fuzz_amount * 100) | int + 1) %}
	{% set adapted_x_min = x_min - mesh_margin - (fuzz_range | random / 100.0) %}
	{% set adapted_y_min = y_min - mesh_margin - (fuzz_range | random / 100.0) %}
	{% set adapted_x_max = x_max + mesh_margin + (fuzz_range | random / 100.0) %}
	{% set adapted_y_max = y_max + mesh_margin + (fuzz_range | random / 100.0) %}
	
	{% set adapted_x_min = [adapted_x_min , bed_mesh_min[0]] | max %}
	{% set adapted_y_min = [adapted_y_min , bed_mesh_min[1]] | max %}
	{% set adapted_x_max = [adapted_x_max , bed_mesh_max[0]] | min %}
	{% set adapted_y_max = [adapted_y_max , bed_mesh_max[1]] | min %}
	
	{% set points_x = (((adapted_x_max - adapted_x_min) / max_probe_point_distance_x) | round(method='ceil') | int) + 1 %}
	{% set points_y = (((adapted_y_max - adapted_y_min) / max_probe_point_distance_y) | round(method='ceil') | int) + 1 %}
	
	{% if (([points_x, points_y]|max) > 6) %}
	{% set algorithm = "bicubic" %}
	{% set min_points = 4 %}
	{% else %}
	{% set algorithm = "lagrange" %}
	{% set min_points = 3 %}
	{% endif %}
	
	{% set points_x = [points_x , min_points]|max %}
	{% set points_y = [points_y , min_points]|max %}
	{% set points_x = [points_x , probe_count[0]]|min %}
	{% set points_y = [points_y , probe_count[1]]|min %}
	
	{% if verbose_enable == True %}
	{% if printer.exclude_object.objects != [] %}
	
	{ action_respond_info( "Algorithm: {}.".format(
	(algorithm),
	)) }
	
	{ action_respond_info("Default probe count: {},{}.".format(
	(probe_count[0]),
	(probe_count[1]),
	)) }
	
	{ action_respond_info("Adapted probe count: {},{}.".format(
	(points_x),
	(points_y),
	)) }
	
	{action_respond_info("Default mesh bounds: {}, {}.".format(
	(bed_mesh_min[0],bed_mesh_min[1]),
	(bed_mesh_max[0],bed_mesh_max[1]),
	)) }
	
	{% if mesh_margin > 0 %}
	{action_respond_info("Mesh margin is {}, mesh bounds extended by {}mm.".format(
	(mesh_margin),
	(mesh_margin),
	)) }
	{% else %}
	{action_respond_info("Mesh margin is 0, margin not increased.")}
	{% endif %}
	
	{% if fuzz_amount > 0 %}
	{action_respond_info("Mesh point fuzzing enabled, points fuzzed up to {}mm.".format(
	(fuzz_amount),
	)) }
	{% else %}
	{action_respond_info("Fuzz amount is 0, mesh points not fuzzed.")}
	{% endif %}
	
	{ action_respond_info("Adapted mesh bounds: {}, {}.".format(
	(adapted_x_min, adapted_y_min),
	(adapted_x_max, adapted_y_max),
	)) }
	
	{action_respond_info("KAMP adjustments successful. Happy KAMPing!")}
	
	{% else %}
	
	{action_respond_info("No objects detected! Check your gcode and make sure that EXCLUDE_OBJECT_DEFINE is happening before BED_MESH_CALIBRATE is called. Defaulting to regular meshing.")}
	G4 P5000
	{% endif %}
	
	{% endif %}
	
	{% if probe_dock_enable == True %}
	{attach_macro}
	{% endif %}
	
	_BED_MESH_CALIBRATE mesh_min={adapted_x_min},{adapted_y_min} mesh_max={adapted_x_max},{adapted_y_max} ALGORITHM={algorithm} PROBE_COUNT={points_x},{points_y}
	
	{% if probe_dock_enable == True %}
	{detach_macro}
	{% endif %}

[gcode_macro _KAMP_Settings]
description = This macro contains all adjustable settings for KAMP
variable_verbose_enable = True
variable_mesh_margin = 0
variable_fuzz_amount = 0
variable_probe_dock_enable = False
variable_attach_macro = 'Attach_Probe'
variable_detach_macro = 'Dock_Probe'
variable_purge_height = 0.8
variable_tip_distance = 0
variable_purge_margin = 10
variable_purge_amount = 30
variable_flow_rate = 12
variable_smart_park_height = 10
gcode = 
	
	{action_respond_info(" Running the KAMP_Settings macro does nothing, it is only used for storing KAMP settings. ")}

[led_effect sb_logo_busy]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (1,0,0)

[led_effect sb_logo_cleaning]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 0.02, 0.5)

[led_effect sb_logo_calibrating_z]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 0.0, 0.35)

[led_effect sb_logo_heating]
leds = 
	neopixel:sb_leds (1,3,7,8,6,2)
autostart = false
frame_rate = 24
layers = 
	comet  0.3  0 add (1, 0.18, 0)

[led_effect sb_logo_cooling]
leds = 
	neopixel:sb_leds (1,3,7,8,6,2)
autostart = false
frame_rate = 24
layers = 
	comet  0.3  0 add (0, 0, 1)

[led_effect sb_logo_homing]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 0.6, 0.2)

[led_effect sb_logo_leveling]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.5, 0.1, 0.4)

[led_effect sb_logo_meshing]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.2, 1.0, 0.0)

[led_effect sb_logo_printing]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	gradient  0.3  1 add (0.3, 0.0, 0.0),(0.3, 0.3, 0.0),(0.3, 0.1, 0.0)

[led_effect sb_logo_standby]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.01, 0.01, 0.01)

[led_effect sb_logo_part_ready]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 1.0, 0.0)

[led_effect sb_nozzle_heating]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (1.0, 0.18, 0.0, 0.0)

[led_effect sb_nozzle_cooling]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (0.0, 0.0, 1.0, 0.1)

[led_effect sb_nozzle_standby]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (0.6, 0.0, 0.0, 0.0)

[led_effect sb_nozzle_part_ready]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (0.6, 1.0, 0.0, 0.1)

[led_effect sb_critical_error]
leds = 
	neopixel:sb_leds
layers = 
	strobe         1  1.5   add        (1.0,  1.0, 1.0)
	breathing      2  0     difference (0.95, 0.0, 0.0)
	static         1  0     top        (1.0,  0.0, 0.0)
autostart = false
frame_rate = 24
run_on_error = true

[led_effect rainbow]
leds = 
	neopixel:chamber_leds
autostart = false
frame_rate = 24
layers = 
	gradient  0.3  1 add (0.3, 0.0, 0.0),(0.0, 0.3, 0.0),(0.0, 0.0, 0.3)

[led_effect set_nozzle_leds]
leds = 
	neopixel:sb_leds (9,10)
autostart = false
frame_rate = 24
layers = 
	static         0  0     top        (0.0,  0.0, 0.0, 1.0)

[led_effect set_logo_leds]
leds = 
	neopixel:sb_leds (1,2,3,4,5,6,7,8)
autostart = false
frame_rate = 24
layers = 
	static         0  0     top        (1.0,  1.0, 1.0)

[led_effect set_chamber_leds]
leds = 
	neopixel:chamber_leds
autostart = false
frame_rate = 24
layers = 
	static         0  0     top        (1.0,  1.0, 1.0)

[gcode_macro set_logo_leds_off]
gcode = 
	SET_LED_EFFECT EFFECT=set_logo_leds STOP=1

[gcode_macro set_logo_leds_on]
gcode = 
	SET_LED_EFFECT EFFECT=set_logo_leds

[gcode_macro set_nozzle_leds_on]
gcode = 
	SET_LED_EFFECT EFFECT=set_nozzle_leds

[gcode_macro set_nozzle_leds_off]
gcode = 
	SET_LED_EFFECT EFFECT=set_nozzle_leds STOP=1

[gcode_macro set_chamber_leds_off]
gcode = 
	SET_LED_EFFECT EFFECT=set_chamber_leds STOP=1

[gcode_macro set_chamber_leds_on]
gcode = 
	SET_LED_EFFECT EFFECT=set_chamber_leds

[gcode_macro status_off]
gcode = 
	STOP_LED_EFFECTS

[gcode_macro status_ready]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=rainbow

[gcode_macro status_part_ready]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_nozzle_part_ready
	SET_LED_EFFECT EFFECT=sb_logo_part_ready

[gcode_macro status_busy]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_busy
	set_nozzle_leds_on

[gcode_macro status_heating]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_heating
	SET_LED_EFFECT EFFECT=sb_nozzle_heating

[gcode_macro status_cooling]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_cooling
	SET_LED_EFFECT EFFECT=sb_nozzle_cooling

[gcode_macro status_leveling]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_leveling
	set_nozzle_leds_on

[gcode_macro status_homing]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_homing
	set_nozzle_leds_on

[gcode_macro status_cleaning]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_cleaning
	set_nozzle_leds_on

[gcode_macro status_meshing]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_meshing
	set_nozzle_leds_on

[gcode_macro status_calibrating_z]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_calibrating_z
	set_nozzle_leds_on

[gcode_macro status_printing]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_printing
	set_nozzle_leds_on

[printer]
kinematics = corexy
max_velocity = 300
max_accel = 5700
max_z_velocity = 5
max_z_accel = 100
square_corner_velocity = 5.0

[mcu]
serial = /dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00

[mcu rpi]
serial = /tmp/klipper_host_mcu

[adxl345]
cs_pin = rpi:None

[resonance_tester]
accel_chip = adxl345
probe_points = 
	189,185,20

[input_shaper]
shaper_freq_x = 61.8
shaper_type_x = mzv
shaper_freq_y = 38.4
shaper_type_y = zv

[stepper_x]
step_pin = P1.4
dir_pin = !P1.8
enable_pin = !P1.0
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 40
endstop_pin = ^P1.29
position_endstop = 383
position_min = -5
position_max = 383
homing_speed = 25
homing_retract_dist = 5.0

[tmc2209 stepper_x]
uart_pin = P1.1
interpolate = False
run_current = 1.00
stealthchop_threshold = 0

[stepper_y]
step_pin = P1.14
dir_pin = !P1.15
enable_pin = !P1.9
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 40
endstop_pin = ^P1.28
position_endstop = 392
position_min = -8
position_max = 392
homing_speed = 25
homing_retract_dist = 5.0

[tmc2209 stepper_y]
uart_pin = P1.10
interpolate = False
run_current = 1.00
stealthchop_threshold = 0

[stepper_z]
step_pin = P4.29
dir_pin = !P4.28
enable_pin = !P1.16
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 4
endstop_pin = probe:z_virtual_endstop
position_min = -5
position_max = 395

[tmc2209 stepper_z]
uart_pin = P1.17
interpolate = False
run_current = 0.580
stealthchop_threshold = 0

[stepper_z1]
step_pin = P2.11
dir_pin = !P2.12
enable_pin = !P0.21
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 4

[tmc2209 stepper_z1]
uart_pin = P0.22
interpolate = False
run_current = 0.580
stealthchop_threshold = 0

[extruder]
step_pin = P2.6
dir_pin = !P2.7
enable_pin = !P0.4
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 35.291
gear_ratio = 7.5:1
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = P2.3
sensor_type = PT1000
sensor_pin = P0.24
control = pid
pid_kp = 14.430
pid_ki = 1.023
pid_kd = 50.866
min_temp = 10
max_temp = 350
max_extrude_only_distance = 500
max_extrude_only_velocity = 120
min_extrude_temp = 180
max_extrude_cross_section = 50.
pressure_advance = 0.000
pressure_advance_smooth_time = 0.03

[tmc2209 extruder]
uart_pin = P0.5
interpolate = false
run_current = 0.79
stealthchop_threshold = 0
driver_tbl = 0
driver_hend = 6
driver_hstrt = 7
driver_toff = 4

[static_digital_output tmc_standby_pins]
pins = !P3.26, !P3.25, !P1.18, !P1.19, !P2.13

[heater_bed]
heater_pin = P2.5
sensor_type = EPCOS 100K B57560G104F
sensor_pin = P0.25
control = pid
pid_kp = 68.561
pid_ki = 0.619
pid_kd = 1897.417
min_temp = 0
max_temp = 130

[idle_timeout]
timeout = 3600

[bltouch]
sensor_pin = ^P1.27
control_pin = P1.23
x_offset = -33
y_offset = -5
z_offset = 2.500
samples = 1
samples_result = average
sample_retract_dist = 2.0
samples_tolerance = 0.05
samples_tolerance_retries = 3
stow_on_each_sample = False

[safe_z_home]
home_xy_position = 221,190
speed = 60
z_hop = 12
z_hop_speed = 5

[screws_tilt_adjust]
screw1 = 69, 319
screw1_name = rear left screw
screw2 = 368, 60
screw2_name = front right screw
screw3 = 368, 319
screw3_name = rear right screw
screw4 = 69, 60
screw4_name = front left screw
horizontal_move_z = 10.
speed = 50.
screw_thread = CW-M4

[z_tilt]
z_positions = -20, 183
	402, 183
points = 56, 183
	383, 183
speed = 50
horizontal_move_z = 10
retries = 20
retry_tolerance = 0.01

[bed_mesh]
speed = 120
horizontal_move_z = 5
mesh_min = 50, 80
mesh_max = 323, 314
probe_count = 7, 7
algorithm = bicubic
bicubic_tension = 0.5
fade_start = 0.6
fade_end = 10
fade_target = 0

[fan]
pin = P2.1

[heater_fan heatbreak_cooling_fan]
pin = P2.2

[display]
lcd_type = st7920
menu_timeout = 600
cs_pin = EXP1_7
sclk_pin = EXP1_6
sid_pin = EXP1_8
encoder_pins = ^EXP1_5, ^EXP1_3
click_pin = ^!EXP1_2

[output_pin beeper]
pin = EXP1_1

[board_pins]
aliases = 
	
	EXP1_1=P2.8,  EXP1_3=P0.19, EXP1_5=P0.20, EXP1_7=P0.17, EXP1_9=<GND>,
	EXP1_2=P0.16, EXP1_4=<RST>, EXP1_6=P0.15, EXP1_8=P0.18, EXP1_10=<5V>

[filament_motion_sensor SmartFilamentSensor_T0]
detection_length = 7.00
extruder = extruder
switch_pin = ^P1.26
pause_on_runout = True
event_delay = 3.0
pause_delay = 0.5
runout_gcode = 
	M117 Runout Detected!

[temperature_sensor raspberry_pi]
sensor_type = temperature_host
min_temp = 10
max_temp = 100

[temperature_sensor Mainboard]
sensor_type = NTC 100K MGB18-104F39050L32
sensor_pin = P1.30
min_temp = 10
max_temp = 100

[neopixel chamber_leds]
pin = P1.22
chain_count = 85
color_order = GRB
initial_red = 0.0
initial_green = 0.0
initial_blue = 0.0
initial_white = 0.0

[neopixel sb_leds]
pin = P1.24
chain_count = 10
color_order = GRB,GRB,GRB,GRB,GRB,GRB,GRB,GRB,GRBW,GRBW
initial_red = 0.0
initial_green = 0.0
initial_blue = 0.0
initial_white = 0.0

[exclude_object]

[gcode_arcs]
resolution = 0.1
=======================
Extruder max_extrude_ratio=20.787584
mcu 'mcu': Starting serial connect
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00'
webhooks client 4122604448: New connection
webhooks client 4122604448: Client info {'program': 'Moonraker', 'version': 'v0.8.0-247-g3008a13'}
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00'
Attempting MCU 'mcu' reset
Unhandled exception during post run
Traceback (most recent call last):
  File "/home/pi/klippy-env/lib/python3.9/site-packages/serial/serialposix.py", line 265, in open
    self.fd = os.open(self.portstr, os.O_RDWR | os.O_NOCTTY | os.O_NONBLOCK)
FileNotFoundError: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/pi/klipper/klippy/klippy.py", line 234, in run
    self.send_event("klippy:firmware_restart")
  File "/home/pi/klipper/klippy/klippy.py", line 263, in send_event
    return [cb(*params) for cb in self.event_handlers.get(event, [])]
  File "/home/pi/klipper/klippy/klippy.py", line 263, in <listcomp>
    return [cb(*params) for cb in self.event_handlers.get(event, [])]
  File "/home/pi/klipper/klippy/mcu.py", line 948, in _firmware_restart
    self._restart_arduino()
  File "/home/pi/klipper/klippy/mcu.py", line 908, in _restart_arduino
    serialhdl.arduino_reset(self._serialport, self._reactor)
  File "/home/pi/klipper/klippy/serialhdl.py", line 379, in arduino_reset
    ser = serial.Serial(serialport, 2400, timeout=0, exclusive=True)
  File "/home/pi/klippy-env/lib/python3.9/site-packages/serial/serialutil.py", line 240, in __init__
    self.open()
  File "/home/pi/klippy-env/lib/python3.9/site-packages/serial/serialposix.py", line 268, in open
    raise SerialException(msg.errno, "could not open port {}: {}".format(self._port, msg))
serial.serialutil.SerialException: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00'
Restarting printer
Start printer at Fri Jan 12 19:15:42 2024 (1705086942.3 1706.2)
===== Config file =====
[virtual_sdcard]
path = ~/printer_data/gcodes
on_error_gcode = CANCEL_PRINT

[pause_resume]

[display_status]

[respond]

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = CANCEL_PRINT_BASE
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set allow_park = client.park_at_cancel|default(false)|lower == 'true' %}
	{% set retract = client.cancel_retract|default(5.0)|abs %}
	
	{% set park_x = "" if (client.park_at_cancel_x|default(none) is none)
	else "X=" ~ client.park_at_cancel_x %}
	{% set park_y = "" if (client.park_at_cancel_y|default(none) is none)
	else "Y=" ~ client.park_at_cancel_y %}
	{% set custom_park = park_x|length > 0 or park_y|length > 0 %}
	
	
	{% if printer['gcode_macro RESUME'].restore_idle_timeout > 0 %}
	SET_IDLE_TIMEOUT TIMEOUT={printer['gcode_macro RESUME'].restore_idle_timeout}
	{% endif %}
	{% if (custom_park or not printer.pause_resume.is_paused) and allow_park %} _TOOLHEAD_PARK_PAUSE_CANCEL {park_x} {park_y} {% endif %}
	_CLIENT_RETRACT LENGTH={retract}
	TURN_OFF_HEATERS
	M106 S0
	{client.user_cancel_macro|default("")}
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=idle_state VALUE=False
	
	SET_PAUSE_NEXT_LAYER ENABLE=0
	SET_PAUSE_AT_LAYER ENABLE=0 LAYER=0
	CANCEL_PRINT_BASE

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = PAUSE_BASE
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set idle_timeout = client.idle_timeout|default(0) %}
	{% set temp = printer[printer.toolhead.extruder].target if printer.toolhead.extruder != '' else 0 %}
	{% set restore = False if printer.toolhead.extruder == ''
	else True  if params.RESTORE|default(1)|int == 1 else False %}
	
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=last_extruder_temp VALUE="{{'restore': restore, 'temp': temp}}"
	
	{% if idle_timeout > 0 %}
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=restore_idle_timeout VALUE={printer.configfile.settings.idle_timeout.timeout}
	SET_IDLE_TIMEOUT TIMEOUT={idle_timeout}
	{% endif %}
	PAUSE_BASE
	{client.user_pause_macro|default("")}
	_TOOLHEAD_PARK_PAUSE_CANCEL {rawparams}

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = RESUME_BASE
variable_last_extruder_temp = {'restore': False, 'temp': 0}
variable_restore_idle_timeout = 0
variable_idle_state = False
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set sp_move = client.speed_move|default(velocity) %}
	{% set runout_resume = True if client.runout_sensor|default("") == ""
	else True if not printer[client.runout_sensor].enabled
	else printer[client.runout_sensor].filament_detected %}
	{% set can_extrude = True if printer.toolhead.extruder == ''
	else printer[printer.toolhead.extruder].can_extrude %}
	{% set do_resume = False %}
	{% set prompt_txt = [] %}
	
	
	{% if printer.idle_timeout.state|upper == "IDLE" or idle_state %}
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=idle_state VALUE=False
	{% if last_extruder_temp.restore %}
	
	RESPOND TYPE=echo MSG='{"Restoring \"%s\" temperature to %3.1f\u00B0C, this may take some time" % (printer.toolhead.extruder, last_extruder_temp.temp) }'
	M109 S{last_extruder_temp.temp}
	{% set do_resume = True %}
	{% elif can_extrude %}
	{% set do_resume = True %}
	{% else %}
	RESPOND TYPE=error MSG='{"Resume aborted !!! \"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder}'
	{% set _d = prompt_txt.append("\"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder) %}
	{% endif %}
	
	{% elif can_extrude %}
	{% set do_resume = True %}
	{% else %}
	RESPOND TYPE=error MSG='{"Resume aborted !!! \"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder}'
	{% set _d = prompt_txt.append("\"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder) %}
	{% endif %}
	{% if runout_resume %}
	{% if do_resume %}
	{% if restore_idle_timeout > 0 %} SET_IDLE_TIMEOUT TIMEOUT={restore_idle_timeout} {% endif %}
	{client.user_resume_macro|default("")}
	_CLIENT_EXTRUDE
	RESUME_BASE VELOCITY={params.VELOCITY|default(sp_move)}
	{% endif %}
	{% else %}
	RESPOND TYPE=error MSG='{"Resume aborted !!! \"%s\" detects no filament, please load filament and press RESUME" % (client.runout_sensor.split(" "))[1]}'
	{% set _d = prompt_txt.append("\"%s\" detects no filament, please load filament and press RESUME" % (client.runout_sensor.split(" "))[1]) %}
	{% endif %}
	
	{% if not (runout_resume and do_resume) %}
	RESPOND TYPE=command MSG="action:prompt_begin RESUME aborted !!!"
	{% for element in prompt_txt %}
	RESPOND TYPE=command MSG='{"action:prompt_text %s" % element}'
	{% endfor %}
	RESPOND TYPE=command MSG="action:prompt_footer_button Ok|RESPOND TYPE=command MSG=action:prompt_end|info"
	RESPOND TYPE=command MSG="action:prompt_show"
	{% endif %}

[gcode_macro SET_PAUSE_NEXT_LAYER]
description = Enable a pause if the next layer is reached
gcode = 
	{% set pause_next_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_next_layer %}
	{% set ENABLE = params.ENABLE|default(1)|int != 0 %}
	{% set MACRO = params.MACRO|default(pause_next_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_next_layer VALUE="{{ 'enable': ENABLE, 'call': MACRO }}"

[gcode_macro SET_PAUSE_AT_LAYER]
description = Enable/disable a pause if a given layer number is reached
gcode = 
	{% set pause_at_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_at_layer %}
	{% set ENABLE = params.ENABLE|int != 0 if params.ENABLE is defined
	else params.LAYER is defined %}
	{% set LAYER = params.LAYER|default(pause_at_layer.layer)|int %}
	{% set MACRO = params.MACRO|default(pause_at_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_at_layer VALUE="{{ 'enable': ENABLE, 'layer': LAYER, 'call': MACRO }}"

[gcode_macro SET_PRINT_STATS_INFO]
rename_existing = SET_PRINT_STATS_INFO_BASE
description = Overwrite, to get pause_next_layer and pause_at_layer feature
variable_pause_next_layer = { 'enable': False, 'call': "PAUSE" }
variable_pause_at_layer = { 'enable': False, 'layer': 0, 'call': "PAUSE" }
gcode = 
	{% if pause_next_layer.enable %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_next_layer" % pause_next_layer.call}'
	{pause_next_layer.call}
	SET_PAUSE_NEXT_LAYER ENABLE=0
	{% elif pause_at_layer.enable and params.CURRENT_LAYER is defined and params.CURRENT_LAYER|int == pause_at_layer.layer %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_at_layer [%d]" % (pause_at_layer.call, pause_at_layer.layer)}'
	{pause_at_layer.call}
	SET_PAUSE_AT_LAYER ENABLE=0
	{% endif %}
	SET_PRINT_STATS_INFO_BASE {rawparams}

[gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL]
description = Helper: park toolhead used in PAUSE and CANCEL_PRINT
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set use_custom     = client.use_custom_pos|default(false)|lower == 'true' %}
	{% set custom_park_x  = client.custom_park_x|default(0.0) %}
	{% set custom_park_y  = client.custom_park_y|default(0.0) %}
	{% set park_dz        = client.custom_park_dz|default(2.0)|abs %}
	{% set sp_hop         = client.speed_hop|default(15) * 60 %}
	{% set sp_move        = client.speed_move|default(velocity) * 60 %}
	
	{% set origin    = printer.gcode_move.homing_origin %}
	{% set act       = printer.gcode_move.gcode_position %}
	{% set max       = printer.toolhead.axis_maximum %}
	{% set cone      = printer.toolhead.cone_start_z|default(max.z) %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	
	{% set z_min = params.Z_MIN|default(0)|float %}
	{% set z_park = [[(act.z + park_dz), z_min]|max, (max.z - origin.z)]|min %}
	{% set x_park = params.X       if params.X is defined
	else custom_park_x  if use_custom
	else 0.0            if round_bed
	else (max.x - 5.0) %}
	{% set y_park = params.Y       if params.Y is defined
	else custom_park_y  if use_custom
	else (max.y - 5.0)  if round_bed and z_park < cone
	else 0.0            if round_bed
	else (max.y - 5.0) %}
	
	_CLIENT_RETRACT
	{% if "xyz" in printer.toolhead.homed_axes %}
	G90
	G1 Z{z_park} F{sp_hop}
	G1 X{x_park} Y{y_park} F{sp_move}
	{% if not printer.gcode_move.absolute_coordinates %} G91 {% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='Printer not homed'
	{% endif %}

[gcode_macro _CLIENT_EXTRUDE]
description = Extrudes, if the extruder is hot enough
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set use_fw_retract = (client.use_fw_retract|default(false)|lower == 'true') and (printer.firmware_retraction is defined) %}
	{% set length = params.LENGTH|default(client.unretract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_unretract)|default(35) %}
	{% set absolute_extrude = printer.gcode_move.absolute_extrude %}
	
	{% if printer.toolhead.extruder != '' %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if use_fw_retract %}
	{% if length < 0 %}
	G10
	{% else %}
	G11
	{% endif %}
	{% else %}
	M83
	G1 E{length} F{(speed|float|abs) * 60}
	{% if absolute_extrude %}
	M82
	{% endif %}
	{% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='{"\"%s\" not hot enough" % printer.toolhead.extruder}'
	{% endif %}
	{% endif %}

[gcode_macro _CLIENT_RETRACT]
description = Retracts, if the extruder is hot enough
gcode = 
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set length = params.LENGTH|default(client.retract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_retract)|default(35) %}
	
	_CLIENT_EXTRUDE LENGTH=-{length|float|abs} SPEED={speed|float|abs}

[gcode_macro START_PRINT]
gcode = 
	{% set BED_TEMP = params.BED_TEMP|default(55)|float %}
	{% set EXTRUDER_TEMP = params.EXTRUDER_TEMP|default(200)|float %}
	M117 Print Starting...
	G28 X Y
	G90
	M220 S100
	M221 S100
	G92 E0
	
	
	
	
	
	
	M140 S{BED_TEMP}
	
	M190 S{BED_TEMP}
	
	M117 Waiting for temperature
	
	
	M117 Homing All...
	
	G90
	
	G28
	
	M117 Z-Tilt Adjust
	Z_TILT_ADJUST
	
	M117 Generating mesh
	
	BED_MESH_CLEAR
	
	BED_MESH_CALIBRATE
	
	BED_MESH_PROFILE LOAD=default
	
	G1 X100 Y392 F10000
	
	M117 Heaters Recovering...
	
	
	M109 S{EXTRUDER_TEMP} T0; start warming extruder to preheat temp
	
	
	M117 Purging extruder...
	
	
	CLEAN_AND_PURGE_NOZZLE
	
	M117 Printing.....
	UPDATE_DELAYED_GCODE ID=clear_display DURATION=10

[gcode_macro END_PRINT]
gcode = 
	
	{% set th = printer.toolhead %}
	{% set x_safe = th.position.x + 20 * (1 if th.axis_maximum.x - th.position.x > 20 else -1) %}
	{% set y_safe = th.position.y + 20 * (1 if th.axis_maximum.y - th.position.y > 20 else -1) %}
	{% set z_safe = [th.position.z + 2, th.axis_maximum.z]|min %}
	
	SAVE_GCODE_STATE NAME=STATE_PRINT_END
	
	
	
	M400
	G92 E0
	
	G91
	G1 E-0.7 Z+5 F3000
	G90
	
	TURN_OFF_HEATERS
	
	G0 X{x_safe} Y{y_safe} Z{z_safe} F20000
	G0 X{th.axis_maximum.x//2} Y{th.axis_maximum.y - 2} F3600
	
	AFTER_PRINT_CLEAN_NOZZLE
	
	G0 X{th.axis_maximum.x/2} Y{th.axis_maximum.y - 2} F3600
	
	TURN_OFF_HEATERS
	
	M84 X Y E
	
	
	SET_PRESSURE_ADVANCE ADVANCE=0.0
	M117 Pressure Advance Set 0.0
	
	
	
	
	BED_MESH_CLEAR
	
	
	
	
	
	M117 Print Finished
	UPDATE_DELAYED_GCODE ID=clear_display DURATION=10
	
	RESTORE_GCODE_STATE NAME=STATE_PRINT_END

[gcode_macro PRIME_LINE]
gcode = 
	M117 Prime Line
	G92 E0
	
	G1 Z2.0 F3000
	
	G1 X40 Y2 Z0.3 F5000.0
	G1 X120 Y2 Z0.3 F500.0 E15
	G1 X120 Y2.3 Z0.3 F5000.0
	G1 X40 Y2.3 Z0.3 F500.0 E30
	G92 E0
	G1 Z2.0 F3000

[gcode_macro CLEAN_NOZZLE]
variable_start_x = 63
variable_start_y = 387
variable_wipe_dist_y = -3
variable_wipe_qty = 5
variable_wipe_spd = 50
variable_end_loc_x = 189
variable_end_loc_y = 185
gcode = 
	SAVE_GCODE_STATE NAME=STATE_PRINT_CURRENT
	
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	G90
	M220 S100
	M204 S100
	M221 S100
	
	
	G1 X{start_x} Y{start_y} F6000
	
	
	{% for wipes in range(1, (wipe_qty + 1)) %}
	
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	
	{% endfor %}
	
	G1 X{end_loc_x} F10000
	
	RESTORE_GCODE_STATE NAME=STATE_PRINT_CURRENT

[gcode_macro CLEAN_AND_PURGE_NOZZLE]
variable_start_x = 63
variable_start_y = 387
variable_start_z = 10
variable_wipe_dist_y = -3
variable_wipe_qty = 5
variable_wipe_spd = 50
variable_purge_loc_x = 100
variable_purge_loc_y = 392
variable_post_purge_y = 386
variable_end_loc_x = 189
variable_end_loc_y = 185
gcode = 
	SAVE_GCODE_STATE NAME=STATE_PRINT_CURRENT
	
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	G90
	
	
	
	
	
	G1 X{start_x} Y{start_y} F6000
	
	
	{% for wipes in range(1, (wipe_qty + 1)) %}
	
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	
	{% endfor %}
	
	G1 X{purge_loc_x}
	G1 Y{purge_loc_y}
	G92 E0
	G1 E30.0 F100
	G92 E0
	G1 E-0.5 F300
	
	G1 Y{post_purge_y} F10000
	G1 X{start_x}
	G1 X{end_loc_x} F10000
	
	RESTORE_GCODE_STATE NAME=STATE_PRINT_CURRENT

[gcode_macro AFTER_PRINT_CLEAN_NOZZLE]
variable_start_x = 63
variable_start_y = 387
variable_wipe_dist_y = -3
variable_wipe_qty = 5
variable_wipe_spd = 50
gcode = 
	SAVE_GCODE_STATE NAME=STATE_PRINT_CURRENT
	
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	G90
	
	
	
	
	G1 X{start_x} Y{start_y} F6000
	
	
	{% for wipes in range(1, (wipe_qty + 1)) %}
	
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	
	{% endfor %}
	
	RESTORE_GCODE_STATE NAME=STATE_PRINT_CURRENT

[delayed_gcode clear_display]
gcode = 
	M117

[gcode_macro Probe_Z_Height]
gcode = 
	G28
	
	PROBE_CALIBRATE

[gcode_macro automatic_bed_screw_adjust]
gcode = 
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	SCREWS_TILT_CALCULATE

[gcode_macro z_motor_alignment]
gcode = 
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	Z_TILT_ADJUST

[gcode_macro Accelerometer_Connection_Test]
gcode = 
	ACCELEROMETER_QUERY

[gcode_macro X_Axis_Resonance_Test]
gcode = 
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	TEST_RESONANCES AXIS=X

[gcode_macro Y_Axis_Resonance_Test]
gcode = 
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	TEST_RESONANCES AXIS=Y

[gcode_macro update_git]
gcode = 
	RUN_SHELL_COMMAND CMD=update_git_script

[gcode_shell_command update_git_script]
command = bash /home/pi/klipper-backup/script.sh
timeout = 90.0
verbose = True

[gcode_macro BED_MESH_CALIBRATE]
rename_existing = _BED_MESH_CALIBRATE
gcode = 
	
	{% set all_points = printer.exclude_object.objects | map(attribute='polygon') | sum(start=[]) %}
	{% set bed_mesh_min = printer.configfile.settings.bed_mesh.mesh_min %}
	{% set bed_mesh_max = printer.configfile.settings.bed_mesh.mesh_max %}
	{% set probe_count = printer.configfile.settings.bed_mesh.probe_count %}
	{% set kamp_settings = printer["gcode_macro _KAMP_Settings"] %}
	{% set verbose_enable = kamp_settings.verbose_enable | abs %}
	{% set probe_dock_enable = kamp_settings.probe_dock_enable | abs %}
	{% set attach_macro = kamp_settings.attach_macro | string %}
	{% set detach_macro = kamp_settings.detach_macro | string %}
	{% set mesh_margin = kamp_settings.mesh_margin | float %}
	{% set fuzz_amount = kamp_settings.fuzz_amount | float %}
	{% set probe_count = probe_count if probe_count|length > 1 else probe_count * 2  %}
	{% set max_probe_point_distance_x = ( bed_mesh_max[0] - bed_mesh_min[0] ) / (probe_count[0] - 1)  %}
	{% set max_probe_point_distance_y = ( bed_mesh_max[1] - bed_mesh_min[1] ) / (probe_count[1] - 1)  %}
	{% set x_min = all_points | map(attribute=0) | min | default(bed_mesh_min[0]) %}
	{% set y_min = all_points | map(attribute=1) | min | default(bed_mesh_min[1]) %}
	{% set x_max = all_points | map(attribute=0) | max | default(bed_mesh_max[0]) %}
	{% set y_max = all_points | map(attribute=1) | max | default(bed_mesh_max[1]) %}
	
	{% set fuzz_range = range((0) | int, (fuzz_amount * 100) | int + 1) %}
	{% set adapted_x_min = x_min - mesh_margin - (fuzz_range | random / 100.0) %}
	{% set adapted_y_min = y_min - mesh_margin - (fuzz_range | random / 100.0) %}
	{% set adapted_x_max = x_max + mesh_margin + (fuzz_range | random / 100.0) %}
	{% set adapted_y_max = y_max + mesh_margin + (fuzz_range | random / 100.0) %}
	
	{% set adapted_x_min = [adapted_x_min , bed_mesh_min[0]] | max %}
	{% set adapted_y_min = [adapted_y_min , bed_mesh_min[1]] | max %}
	{% set adapted_x_max = [adapted_x_max , bed_mesh_max[0]] | min %}
	{% set adapted_y_max = [adapted_y_max , bed_mesh_max[1]] | min %}
	
	{% set points_x = (((adapted_x_max - adapted_x_min) / max_probe_point_distance_x) | round(method='ceil') | int) + 1 %}
	{% set points_y = (((adapted_y_max - adapted_y_min) / max_probe_point_distance_y) | round(method='ceil') | int) + 1 %}
	
	{% if (([points_x, points_y]|max) > 6) %}
	{% set algorithm = "bicubic" %}
	{% set min_points = 4 %}
	{% else %}
	{% set algorithm = "lagrange" %}
	{% set min_points = 3 %}
	{% endif %}
	
	{% set points_x = [points_x , min_points]|max %}
	{% set points_y = [points_y , min_points]|max %}
	{% set points_x = [points_x , probe_count[0]]|min %}
	{% set points_y = [points_y , probe_count[1]]|min %}
	
	{% if verbose_enable == True %}
	{% if printer.exclude_object.objects != [] %}
	
	{ action_respond_info( "Algorithm: {}.".format(
	(algorithm),
	)) }
	
	{ action_respond_info("Default probe count: {},{}.".format(
	(probe_count[0]),
	(probe_count[1]),
	)) }
	
	{ action_respond_info("Adapted probe count: {},{}.".format(
	(points_x),
	(points_y),
	)) }
	
	{action_respond_info("Default mesh bounds: {}, {}.".format(
	(bed_mesh_min[0],bed_mesh_min[1]),
	(bed_mesh_max[0],bed_mesh_max[1]),
	)) }
	
	{% if mesh_margin > 0 %}
	{action_respond_info("Mesh margin is {}, mesh bounds extended by {}mm.".format(
	(mesh_margin),
	(mesh_margin),
	)) }
	{% else %}
	{action_respond_info("Mesh margin is 0, margin not increased.")}
	{% endif %}
	
	{% if fuzz_amount > 0 %}
	{action_respond_info("Mesh point fuzzing enabled, points fuzzed up to {}mm.".format(
	(fuzz_amount),
	)) }
	{% else %}
	{action_respond_info("Fuzz amount is 0, mesh points not fuzzed.")}
	{% endif %}
	
	{ action_respond_info("Adapted mesh bounds: {}, {}.".format(
	(adapted_x_min, adapted_y_min),
	(adapted_x_max, adapted_y_max),
	)) }
	
	{action_respond_info("KAMP adjustments successful. Happy KAMPing!")}
	
	{% else %}
	
	{action_respond_info("No objects detected! Check your gcode and make sure that EXCLUDE_OBJECT_DEFINE is happening before BED_MESH_CALIBRATE is called. Defaulting to regular meshing.")}
	G4 P5000
	{% endif %}
	
	{% endif %}
	
	{% if probe_dock_enable == True %}
	{attach_macro}
	{% endif %}
	
	_BED_MESH_CALIBRATE mesh_min={adapted_x_min},{adapted_y_min} mesh_max={adapted_x_max},{adapted_y_max} ALGORITHM={algorithm} PROBE_COUNT={points_x},{points_y}
	
	{% if probe_dock_enable == True %}
	{detach_macro}
	{% endif %}

[gcode_macro _KAMP_Settings]
description = This macro contains all adjustable settings for KAMP
variable_verbose_enable = True
variable_mesh_margin = 0
variable_fuzz_amount = 0
variable_probe_dock_enable = False
variable_attach_macro = 'Attach_Probe'
variable_detach_macro = 'Dock_Probe'
variable_purge_height = 0.8
variable_tip_distance = 0
variable_purge_margin = 10
variable_purge_amount = 30
variable_flow_rate = 12
variable_smart_park_height = 10
gcode = 
	
	{action_respond_info(" Running the KAMP_Settings macro does nothing, it is only used for storing KAMP settings. ")}

[led_effect sb_logo_busy]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (1,0,0)

[led_effect sb_logo_cleaning]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 0.02, 0.5)

[led_effect sb_logo_calibrating_z]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 0.0, 0.35)

[led_effect sb_logo_heating]
leds = 
	neopixel:sb_leds (1,3,7,8,6,2)
autostart = false
frame_rate = 24
layers = 
	comet  0.3  0 add (1, 0.18, 0)

[led_effect sb_logo_cooling]
leds = 
	neopixel:sb_leds (1,3,7,8,6,2)
autostart = false
frame_rate = 24
layers = 
	comet  0.3  0 add (0, 0, 1)

[led_effect sb_logo_homing]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 0.6, 0.2)

[led_effect sb_logo_leveling]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.5, 0.1, 0.4)

[led_effect sb_logo_meshing]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.2, 1.0, 0.0)

[led_effect sb_logo_printing]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	gradient  0.3  1 add (0.3, 0.0, 0.0),(0.3, 0.3, 0.0),(0.3, 0.1, 0.0)

[led_effect sb_logo_standby]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.01, 0.01, 0.01)

[led_effect sb_logo_part_ready]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 1.0, 0.0)

[led_effect sb_nozzle_heating]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (1.0, 0.18, 0.0, 0.0)

[led_effect sb_nozzle_cooling]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (0.0, 0.0, 1.0, 0.1)

[led_effect sb_nozzle_standby]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (0.6, 0.0, 0.0, 0.0)

[led_effect sb_nozzle_part_ready]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (0.6, 1.0, 0.0, 0.1)

[led_effect sb_critical_error]
leds = 
	neopixel:sb_leds
layers = 
	strobe         1  1.5   add        (1.0,  1.0, 1.0)
	breathing      2  0     difference (0.95, 0.0, 0.0)
	static         1  0     top        (1.0,  0.0, 0.0)
autostart = false
frame_rate = 24
run_on_error = true

[led_effect rainbow]
leds = 
	neopixel:chamber_leds
autostart = false
frame_rate = 24
layers = 
	gradient  0.3  1 add (0.3, 0.0, 0.0),(0.0, 0.3, 0.0),(0.0, 0.0, 0.3)

[led_effect set_nozzle_leds]
leds = 
	neopixel:sb_leds (9,10)
autostart = false
frame_rate = 24
layers = 
	static         0  0     top        (0.0,  0.0, 0.0, 1.0)

[led_effect set_logo_leds]
leds = 
	neopixel:sb_leds (1,2,3,4,5,6,7,8)
autostart = false
frame_rate = 24
layers = 
	static         0  0     top        (1.0,  1.0, 1.0)

[led_effect set_chamber_leds]
leds = 
	neopixel:chamber_leds
autostart = false
frame_rate = 24
layers = 
	static         0  0     top        (1.0,  1.0, 1.0)

[gcode_macro set_logo_leds_off]
gcode = 
	SET_LED_EFFECT EFFECT=set_logo_leds STOP=1

[gcode_macro set_logo_leds_on]
gcode = 
	SET_LED_EFFECT EFFECT=set_logo_leds

[gcode_macro set_nozzle_leds_on]
gcode = 
	SET_LED_EFFECT EFFECT=set_nozzle_leds

[gcode_macro set_nozzle_leds_off]
gcode = 
	SET_LED_EFFECT EFFECT=set_nozzle_leds STOP=1

[gcode_macro set_chamber_leds_off]
gcode = 
	SET_LED_EFFECT EFFECT=set_chamber_leds STOP=1

[gcode_macro set_chamber_leds_on]
gcode = 
	SET_LED_EFFECT EFFECT=set_chamber_leds

[gcode_macro status_off]
gcode = 
	STOP_LED_EFFECTS

[gcode_macro status_ready]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=rainbow

[gcode_macro status_part_ready]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_nozzle_part_ready
	SET_LED_EFFECT EFFECT=sb_logo_part_ready

[gcode_macro status_busy]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_busy
	set_nozzle_leds_on

[gcode_macro status_heating]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_heating
	SET_LED_EFFECT EFFECT=sb_nozzle_heating

[gcode_macro status_cooling]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_cooling
	SET_LED_EFFECT EFFECT=sb_nozzle_cooling

[gcode_macro status_leveling]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_leveling
	set_nozzle_leds_on

[gcode_macro status_homing]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_homing
	set_nozzle_leds_on

[gcode_macro status_cleaning]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_cleaning
	set_nozzle_leds_on

[gcode_macro status_meshing]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_meshing
	set_nozzle_leds_on

[gcode_macro status_calibrating_z]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_calibrating_z
	set_nozzle_leds_on

[gcode_macro status_printing]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_printing
	set_nozzle_leds_on

[printer]
kinematics = corexy
max_velocity = 300
max_accel = 5700
max_z_velocity = 5
max_z_accel = 100
square_corner_velocity = 5.0

[mcu]
serial = /dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00

[mcu rpi]
serial = /tmp/klipper_host_mcu

[adxl345]
cs_pin = rpi:None

[resonance_tester]
accel_chip = adxl345
probe_points = 
	189,185,20

[input_shaper]
shaper_freq_x = 61.8
shaper_type_x = mzv
shaper_freq_y = 38.4
shaper_type_y = zv

[stepper_x]
step_pin = P1.4
dir_pin = !P1.8
enable_pin = !P1.0
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 40
endstop_pin = ^P1.29
position_endstop = 383
position_min = -5
position_max = 383
homing_speed = 25
homing_retract_dist = 5.0

[tmc2209 stepper_x]
uart_pin = P1.1
interpolate = False
run_current = 1.00
stealthchop_threshold = 0

[stepper_y]
step_pin = P1.14
dir_pin = !P1.15
enable_pin = !P1.9
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 40
endstop_pin = ^P1.28
position_endstop = 392
position_min = -8
position_max = 392
homing_speed = 25
homing_retract_dist = 5.0

[tmc2209 stepper_y]
uart_pin = P1.10
interpolate = False
run_current = 1.00
stealthchop_threshold = 0

[stepper_z]
step_pin = P4.29
dir_pin = !P4.28
enable_pin = !P1.16
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 4
endstop_pin = probe:z_virtual_endstop
position_min = -5
position_max = 395

[tmc2209 stepper_z]
uart_pin = P1.17
interpolate = False
run_current = 0.580
stealthchop_threshold = 0

[stepper_z1]
step_pin = P2.11
dir_pin = !P2.12
enable_pin = !P0.21
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 4

[tmc2209 stepper_z1]
uart_pin = P0.22
interpolate = False
run_current = 0.580
stealthchop_threshold = 0

[extruder]
step_pin = P2.6
dir_pin = !P2.7
enable_pin = !P0.4
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 35.291
gear_ratio = 7.5:1
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = P2.3
sensor_type = PT1000
sensor_pin = P0.24
control = pid
pid_kp = 14.430
pid_ki = 1.023
pid_kd = 50.866
min_temp = 10
max_temp = 350
max_extrude_only_distance = 500
max_extrude_only_velocity = 120
min_extrude_temp = 180
max_extrude_cross_section = 50.
pressure_advance = 0.000
pressure_advance_smooth_time = 0.03

[tmc2209 extruder]
uart_pin = P0.5
interpolate = false
run_current = 0.79
stealthchop_threshold = 0
driver_tbl = 0
driver_hend = 6
driver_hstrt = 7
driver_toff = 4

[static_digital_output tmc_standby_pins]
pins = !P3.26, !P3.25, !P1.18, !P1.19, !P2.13

[heater_bed]
heater_pin = P2.5
sensor_type = EPCOS 100K B57560G104F
sensor_pin = P0.25
control = pid
pid_kp = 68.561
pid_ki = 0.619
pid_kd = 1897.417
min_temp = 0
max_temp = 130

[idle_timeout]
timeout = 3600

[bltouch]
sensor_pin = ^P1.27
control_pin = P1.23
x_offset = -33
y_offset = -5
z_offset = 2.500
samples = 1
samples_result = average
sample_retract_dist = 2.0
samples_tolerance = 0.05
samples_tolerance_retries = 3
stow_on_each_sample = False

[safe_z_home]
home_xy_position = 221,190
speed = 60
z_hop = 12
z_hop_speed = 5

[screws_tilt_adjust]
screw1 = 69, 319
screw1_name = rear left screw
screw2 = 368, 60
screw2_name = front right screw
screw3 = 368, 319
screw3_name = rear right screw
screw4 = 69, 60
screw4_name = front left screw
horizontal_move_z = 10.
speed = 50.
screw_thread = CW-M4

[z_tilt]
z_positions = -20, 183
	402, 183
points = 56, 183
	383, 183
speed = 50
horizontal_move_z = 10
retries = 20
retry_tolerance = 0.01

[bed_mesh]
speed = 120
horizontal_move_z = 5
mesh_min = 50, 80
mesh_max = 323, 314
probe_count = 7, 7
algorithm = bicubic
bicubic_tension = 0.5
fade_start = 0.6
fade_end = 10
fade_target = 0

[fan]
pin = P2.1

[heater_fan heatbreak_cooling_fan]
pin = P2.2

[display]
lcd_type = st7920
menu_timeout = 600
cs_pin = EXP1_7
sclk_pin = EXP1_6
sid_pin = EXP1_8
encoder_pins = ^EXP1_5, ^EXP1_3
click_pin = ^!EXP1_2

[output_pin beeper]
pin = EXP1_1

[board_pins]
aliases = 
	
	EXP1_1=P2.8,  EXP1_3=P0.19, EXP1_5=P0.20, EXP1_7=P0.17, EXP1_9=<GND>,
	EXP1_2=P0.16, EXP1_4=<RST>, EXP1_6=P0.15, EXP1_8=P0.18, EXP1_10=<5V>

[filament_motion_sensor SmartFilamentSensor_T0]
detection_length = 7.00
extruder = extruder
switch_pin = ^P1.26
pause_on_runout = True
event_delay = 3.0
pause_delay = 0.5
runout_gcode = 
	M117 Runout Detected!

[temperature_sensor raspberry_pi]
sensor_type = temperature_host
min_temp = 10
max_temp = 100

[temperature_sensor Mainboard]
sensor_type = NTC 100K MGB18-104F39050L32
sensor_pin = P1.30
min_temp = 10
max_temp = 100

[neopixel chamber_leds]
pin = P1.22
chain_count = 85
color_order = GRB
initial_red = 0.0
initial_green = 0.0
initial_blue = 0.0
initial_white = 0.0

[neopixel sb_leds]
pin = P1.24
chain_count = 10
color_order = GRB,GRB,GRB,GRB,GRB,GRB,GRB,GRB,GRBW,GRBW
initial_red = 0.0
initial_green = 0.0
initial_blue = 0.0
initial_white = 0.0

[exclude_object]

[gcode_arcs]
resolution = 0.1
=======================
Extruder max_extrude_ratio=20.787584
mcu 'mcu': Starting serial connect
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00'
webhooks client 4123008496: New connection
webhooks client 4123008496: Client info {'program': 'Moonraker', 'version': 'v0.8.0-247-g3008a13'}
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00'
webhooks client 4123008496: Disconnected
Starting Klippy...
Args: ['/home/pi/klipper/klippy/klippy.py', '/home/pi/printer_data/config/printer.cfg', '-l', '/home/pi/printer_data/logs/klippy.log', '-I', '/home/pi/printer_data/comms/klippy.serial', '-a', '/home/pi/printer_data/comms/klippy.sock']
Git version: 'v0.12.0-65-g96ab9069-dirty'
Untracked files: klippy/extras/gcode_shell_command.py, klippy/extras/led_effect.py
Branch: master
Remote: origin
Tracked URL: https://github.com/Klipper3d/klipper.git
CPU: 4 core ?
Python: '3.9.2 (default, Mar 12 2021, 04:06:34) \n[GCC 10.2.1 20210110]'
Start printer at Fri Jan 12 19:16:29 2024 (1705086989.7 22.3)
===== Config file =====
[virtual_sdcard]
path = ~/printer_data/gcodes
on_error_gcode = CANCEL_PRINT

[pause_resume]

[display_status]

[respond]

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = CANCEL_PRINT_BASE
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set allow_park = client.park_at_cancel|default(false)|lower == 'true' %}
	{% set retract = client.cancel_retract|default(5.0)|abs %}
	
	{% set park_x = "" if (client.park_at_cancel_x|default(none) is none)
	else "X=" ~ client.park_at_cancel_x %}
	{% set park_y = "" if (client.park_at_cancel_y|default(none) is none)
	else "Y=" ~ client.park_at_cancel_y %}
	{% set custom_park = park_x|length > 0 or park_y|length > 0 %}
	
	
	{% if printer['gcode_macro RESUME'].restore_idle_timeout > 0 %}
	SET_IDLE_TIMEOUT TIMEOUT={printer['gcode_macro RESUME'].restore_idle_timeout}
	{% endif %}
	{% if (custom_park or not printer.pause_resume.is_paused) and allow_park %} _TOOLHEAD_PARK_PAUSE_CANCEL {park_x} {park_y} {% endif %}
	_CLIENT_RETRACT LENGTH={retract}
	TURN_OFF_HEATERS
	M106 S0
	{client.user_cancel_macro|default("")}
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=idle_state VALUE=False
	
	SET_PAUSE_NEXT_LAYER ENABLE=0
	SET_PAUSE_AT_LAYER ENABLE=0 LAYER=0
	CANCEL_PRINT_BASE

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = PAUSE_BASE
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set idle_timeout = client.idle_timeout|default(0) %}
	{% set temp = printer[printer.toolhead.extruder].target if printer.toolhead.extruder != '' else 0 %}
	{% set restore = False if printer.toolhead.extruder == ''
	else True  if params.RESTORE|default(1)|int == 1 else False %}
	
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=last_extruder_temp VALUE="{{'restore': restore, 'temp': temp}}"
	
	{% if idle_timeout > 0 %}
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=restore_idle_timeout VALUE={printer.configfile.settings.idle_timeout.timeout}
	SET_IDLE_TIMEOUT TIMEOUT={idle_timeout}
	{% endif %}
	PAUSE_BASE
	{client.user_pause_macro|default("")}
	_TOOLHEAD_PARK_PAUSE_CANCEL {rawparams}

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = RESUME_BASE
variable_last_extruder_temp = {'restore': False, 'temp': 0}
variable_restore_idle_timeout = 0
variable_idle_state = False
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set sp_move = client.speed_move|default(velocity) %}
	{% set runout_resume = True if client.runout_sensor|default("") == ""
	else True if not printer[client.runout_sensor].enabled
	else printer[client.runout_sensor].filament_detected %}
	{% set can_extrude = True if printer.toolhead.extruder == ''
	else printer[printer.toolhead.extruder].can_extrude %}
	{% set do_resume = False %}
	{% set prompt_txt = [] %}
	
	
	{% if printer.idle_timeout.state|upper == "IDLE" or idle_state %}
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=idle_state VALUE=False
	{% if last_extruder_temp.restore %}
	
	RESPOND TYPE=echo MSG='{"Restoring \"%s\" temperature to %3.1f\u00B0C, this may take some time" % (printer.toolhead.extruder, last_extruder_temp.temp) }'
	M109 S{last_extruder_temp.temp}
	{% set do_resume = True %}
	{% elif can_extrude %}
	{% set do_resume = True %}
	{% else %}
	RESPOND TYPE=error MSG='{"Resume aborted !!! \"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder}'
	{% set _d = prompt_txt.append("\"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder) %}
	{% endif %}
	
	{% elif can_extrude %}
	{% set do_resume = True %}
	{% else %}
	RESPOND TYPE=error MSG='{"Resume aborted !!! \"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder}'
	{% set _d = prompt_txt.append("\"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder) %}
	{% endif %}
	{% if runout_resume %}
	{% if do_resume %}
	{% if restore_idle_timeout > 0 %} SET_IDLE_TIMEOUT TIMEOUT={restore_idle_timeout} {% endif %}
	{client.user_resume_macro|default("")}
	_CLIENT_EXTRUDE
	RESUME_BASE VELOCITY={params.VELOCITY|default(sp_move)}
	{% endif %}
	{% else %}
	RESPOND TYPE=error MSG='{"Resume aborted !!! \"%s\" detects no filament, please load filament and press RESUME" % (client.runout_sensor.split(" "))[1]}'
	{% set _d = prompt_txt.append("\"%s\" detects no filament, please load filament and press RESUME" % (client.runout_sensor.split(" "))[1]) %}
	{% endif %}
	
	{% if not (runout_resume and do_resume) %}
	RESPOND TYPE=command MSG="action:prompt_begin RESUME aborted !!!"
	{% for element in prompt_txt %}
	RESPOND TYPE=command MSG='{"action:prompt_text %s" % element}'
	{% endfor %}
	RESPOND TYPE=command MSG="action:prompt_footer_button Ok|RESPOND TYPE=command MSG=action:prompt_end|info"
	RESPOND TYPE=command MSG="action:prompt_show"
	{% endif %}

[gcode_macro SET_PAUSE_NEXT_LAYER]
description = Enable a pause if the next layer is reached
gcode = 
	{% set pause_next_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_next_layer %}
	{% set ENABLE = params.ENABLE|default(1)|int != 0 %}
	{% set MACRO = params.MACRO|default(pause_next_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_next_layer VALUE="{{ 'enable': ENABLE, 'call': MACRO }}"

[gcode_macro SET_PAUSE_AT_LAYER]
description = Enable/disable a pause if a given layer number is reached
gcode = 
	{% set pause_at_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_at_layer %}
	{% set ENABLE = params.ENABLE|int != 0 if params.ENABLE is defined
	else params.LAYER is defined %}
	{% set LAYER = params.LAYER|default(pause_at_layer.layer)|int %}
	{% set MACRO = params.MACRO|default(pause_at_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_at_layer VALUE="{{ 'enable': ENABLE, 'layer': LAYER, 'call': MACRO }}"

[gcode_macro SET_PRINT_STATS_INFO]
rename_existing = SET_PRINT_STATS_INFO_BASE
description = Overwrite, to get pause_next_layer and pause_at_layer feature
variable_pause_next_layer = { 'enable': False, 'call': "PAUSE" }
variable_pause_at_layer = { 'enable': False, 'layer': 0, 'call': "PAUSE" }
gcode = 
	{% if pause_next_layer.enable %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_next_layer" % pause_next_layer.call}'
	{pause_next_layer.call}
	SET_PAUSE_NEXT_LAYER ENABLE=0
	{% elif pause_at_layer.enable and params.CURRENT_LAYER is defined and params.CURRENT_LAYER|int == pause_at_layer.layer %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_at_layer [%d]" % (pause_at_layer.call, pause_at_layer.layer)}'
	{pause_at_layer.call}
	SET_PAUSE_AT_LAYER ENABLE=0
	{% endif %}
	SET_PRINT_STATS_INFO_BASE {rawparams}

[gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL]
description = Helper: park toolhead used in PAUSE and CANCEL_PRINT
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set use_custom     = client.use_custom_pos|default(false)|lower == 'true' %}
	{% set custom_park_x  = client.custom_park_x|default(0.0) %}
	{% set custom_park_y  = client.custom_park_y|default(0.0) %}
	{% set park_dz        = client.custom_park_dz|default(2.0)|abs %}
	{% set sp_hop         = client.speed_hop|default(15) * 60 %}
	{% set sp_move        = client.speed_move|default(velocity) * 60 %}
	
	{% set origin    = printer.gcode_move.homing_origin %}
	{% set act       = printer.gcode_move.gcode_position %}
	{% set max       = printer.toolhead.axis_maximum %}
	{% set cone      = printer.toolhead.cone_start_z|default(max.z) %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	
	{% set z_min = params.Z_MIN|default(0)|float %}
	{% set z_park = [[(act.z + park_dz), z_min]|max, (max.z - origin.z)]|min %}
	{% set x_park = params.X       if params.X is defined
	else custom_park_x  if use_custom
	else 0.0            if round_bed
	else (max.x - 5.0) %}
	{% set y_park = params.Y       if params.Y is defined
	else custom_park_y  if use_custom
	else (max.y - 5.0)  if round_bed and z_park < cone
	else 0.0            if round_bed
	else (max.y - 5.0) %}
	
	_CLIENT_RETRACT
	{% if "xyz" in printer.toolhead.homed_axes %}
	G90
	G1 Z{z_park} F{sp_hop}
	G1 X{x_park} Y{y_park} F{sp_move}
	{% if not printer.gcode_move.absolute_coordinates %} G91 {% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='Printer not homed'
	{% endif %}

[gcode_macro _CLIENT_EXTRUDE]
description = Extrudes, if the extruder is hot enough
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set use_fw_retract = (client.use_fw_retract|default(false)|lower == 'true') and (printer.firmware_retraction is defined) %}
	{% set length = params.LENGTH|default(client.unretract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_unretract)|default(35) %}
	{% set absolute_extrude = printer.gcode_move.absolute_extrude %}
	
	{% if printer.toolhead.extruder != '' %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if use_fw_retract %}
	{% if length < 0 %}
	G10
	{% else %}
	G11
	{% endif %}
	{% else %}
	M83
	G1 E{length} F{(speed|float|abs) * 60}
	{% if absolute_extrude %}
	M82
	{% endif %}
	{% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='{"\"%s\" not hot enough" % printer.toolhead.extruder}'
	{% endif %}
	{% endif %}

[gcode_macro _CLIENT_RETRACT]
description = Retracts, if the extruder is hot enough
gcode = 
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set length = params.LENGTH|default(client.retract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_retract)|default(35) %}
	
	_CLIENT_EXTRUDE LENGTH=-{length|float|abs} SPEED={speed|float|abs}

[gcode_macro START_PRINT]
gcode = 
	{% set BED_TEMP = params.BED_TEMP|default(55)|float %}
	{% set EXTRUDER_TEMP = params.EXTRUDER_TEMP|default(200)|float %}
	M117 Print Starting...
	G28 X Y
	G90
	M220 S100
	M221 S100
	G92 E0
	
	
	
	
	
	
	M140 S{BED_TEMP}
	
	M190 S{BED_TEMP}
	
	M117 Waiting for temperature
	
	
	M117 Homing All...
	
	G90
	
	G28
	
	M117 Z-Tilt Adjust
	Z_TILT_ADJUST
	
	M117 Generating mesh
	
	BED_MESH_CLEAR
	
	BED_MESH_CALIBRATE
	
	BED_MESH_PROFILE LOAD=default
	
	G1 X100 Y392 F10000
	
	M117 Heaters Recovering...
	
	
	M109 S{EXTRUDER_TEMP} T0; start warming extruder to preheat temp
	
	
	M117 Purging extruder...
	
	
	CLEAN_AND_PURGE_NOZZLE
	
	M117 Printing.....
	UPDATE_DELAYED_GCODE ID=clear_display DURATION=10

[gcode_macro END_PRINT]
gcode = 
	
	{% set th = printer.toolhead %}
	{% set x_safe = th.position.x + 20 * (1 if th.axis_maximum.x - th.position.x > 20 else -1) %}
	{% set y_safe = th.position.y + 20 * (1 if th.axis_maximum.y - th.position.y > 20 else -1) %}
	{% set z_safe = [th.position.z + 2, th.axis_maximum.z]|min %}
	
	SAVE_GCODE_STATE NAME=STATE_PRINT_END
	
	
	
	M400
	G92 E0
	
	G91
	G1 E-0.7 Z+5 F3000
	G90
	
	TURN_OFF_HEATERS
	
	G0 X{x_safe} Y{y_safe} Z{z_safe} F20000
	G0 X{th.axis_maximum.x//2} Y{th.axis_maximum.y - 2} F3600
	
	AFTER_PRINT_CLEAN_NOZZLE
	
	G0 X{th.axis_maximum.x/2} Y{th.axis_maximum.y - 2} F3600
	
	TURN_OFF_HEATERS
	
	M84 X Y E
	
	
	SET_PRESSURE_ADVANCE ADVANCE=0.0
	M117 Pressure Advance Set 0.0
	
	
	
	
	BED_MESH_CLEAR
	
	
	
	
	
	M117 Print Finished
	UPDATE_DELAYED_GCODE ID=clear_display DURATION=10
	
	RESTORE_GCODE_STATE NAME=STATE_PRINT_END

[gcode_macro PRIME_LINE]
gcode = 
	M117 Prime Line
	G92 E0
	
	G1 Z2.0 F3000
	
	G1 X40 Y2 Z0.3 F5000.0
	G1 X120 Y2 Z0.3 F500.0 E15
	G1 X120 Y2.3 Z0.3 F5000.0
	G1 X40 Y2.3 Z0.3 F500.0 E30
	G92 E0
	G1 Z2.0 F3000

[gcode_macro CLEAN_NOZZLE]
variable_start_x = 63
variable_start_y = 387
variable_wipe_dist_y = -3
variable_wipe_qty = 5
variable_wipe_spd = 50
variable_end_loc_x = 189
variable_end_loc_y = 185
gcode = 
	SAVE_GCODE_STATE NAME=STATE_PRINT_CURRENT
	
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	G90
	M220 S100
	M204 S100
	M221 S100
	
	
	G1 X{start_x} Y{start_y} F6000
	
	
	{% for wipes in range(1, (wipe_qty + 1)) %}
	
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	
	{% endfor %}
	
	G1 X{end_loc_x} F10000
	
	RESTORE_GCODE_STATE NAME=STATE_PRINT_CURRENT

[gcode_macro CLEAN_AND_PURGE_NOZZLE]
variable_start_x = 63
variable_start_y = 387
variable_start_z = 10
variable_wipe_dist_y = -3
variable_wipe_qty = 5
variable_wipe_spd = 50
variable_purge_loc_x = 100
variable_purge_loc_y = 392
variable_post_purge_y = 386
variable_end_loc_x = 189
variable_end_loc_y = 185
gcode = 
	SAVE_GCODE_STATE NAME=STATE_PRINT_CURRENT
	
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	G90
	
	
	
	
	
	G1 X{start_x} Y{start_y} F6000
	
	
	{% for wipes in range(1, (wipe_qty + 1)) %}
	
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	
	{% endfor %}
	
	G1 X{purge_loc_x}
	G1 Y{purge_loc_y}
	G92 E0
	G1 E30.0 F100
	G92 E0
	G1 E-0.5 F300
	
	G1 Y{post_purge_y} F10000
	G1 X{start_x}
	G1 X{end_loc_x} F10000
	
	RESTORE_GCODE_STATE NAME=STATE_PRINT_CURRENT

[gcode_macro AFTER_PRINT_CLEAN_NOZZLE]
variable_start_x = 63
variable_start_y = 387
variable_wipe_dist_y = -3
variable_wipe_qty = 5
variable_wipe_spd = 50
gcode = 
	SAVE_GCODE_STATE NAME=STATE_PRINT_CURRENT
	
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	G90
	
	
	
	
	G1 X{start_x} Y{start_y} F6000
	
	
	{% for wipes in range(1, (wipe_qty + 1)) %}
	
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x + 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y - wipe_dist_y} F{wipe_spd * 300}
	G1 X{start_x - 10} Y{start_y + wipe_dist_y} F{wipe_spd * 300}
	
	{% endfor %}
	
	RESTORE_GCODE_STATE NAME=STATE_PRINT_CURRENT

[delayed_gcode clear_display]
gcode = 
	M117

[gcode_macro Probe_Z_Height]
gcode = 
	G28
	
	PROBE_CALIBRATE

[gcode_macro automatic_bed_screw_adjust]
gcode = 
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	SCREWS_TILT_CALCULATE

[gcode_macro z_motor_alignment]
gcode = 
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	Z_TILT_ADJUST

[gcode_macro Accelerometer_Connection_Test]
gcode = 
	ACCELEROMETER_QUERY

[gcode_macro X_Axis_Resonance_Test]
gcode = 
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	
	TEST_RESONANCES AXIS=X

[gcode_macro Y_Axis_Resonance_Test]
gcode = 
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	TEST_RESONANCES AXIS=Y

[gcode_macro update_git]
gcode = 
	RUN_SHELL_COMMAND CMD=update_git_script

[gcode_shell_command update_git_script]
command = bash /home/pi/klipper-backup/script.sh
timeout = 90.0
verbose = True

[gcode_macro BED_MESH_CALIBRATE]
rename_existing = _BED_MESH_CALIBRATE
gcode = 
	
	{% set all_points = printer.exclude_object.objects | map(attribute='polygon') | sum(start=[]) %}
	{% set bed_mesh_min = printer.configfile.settings.bed_mesh.mesh_min %}
	{% set bed_mesh_max = printer.configfile.settings.bed_mesh.mesh_max %}
	{% set probe_count = printer.configfile.settings.bed_mesh.probe_count %}
	{% set kamp_settings = printer["gcode_macro _KAMP_Settings"] %}
	{% set verbose_enable = kamp_settings.verbose_enable | abs %}
	{% set probe_dock_enable = kamp_settings.probe_dock_enable | abs %}
	{% set attach_macro = kamp_settings.attach_macro | string %}
	{% set detach_macro = kamp_settings.detach_macro | string %}
	{% set mesh_margin = kamp_settings.mesh_margin | float %}
	{% set fuzz_amount = kamp_settings.fuzz_amount | float %}
	{% set probe_count = probe_count if probe_count|length > 1 else probe_count * 2  %}
	{% set max_probe_point_distance_x = ( bed_mesh_max[0] - bed_mesh_min[0] ) / (probe_count[0] - 1)  %}
	{% set max_probe_point_distance_y = ( bed_mesh_max[1] - bed_mesh_min[1] ) / (probe_count[1] - 1)  %}
	{% set x_min = all_points | map(attribute=0) | min | default(bed_mesh_min[0]) %}
	{% set y_min = all_points | map(attribute=1) | min | default(bed_mesh_min[1]) %}
	{% set x_max = all_points | map(attribute=0) | max | default(bed_mesh_max[0]) %}
	{% set y_max = all_points | map(attribute=1) | max | default(bed_mesh_max[1]) %}
	
	{% set fuzz_range = range((0) | int, (fuzz_amount * 100) | int + 1) %}
	{% set adapted_x_min = x_min - mesh_margin - (fuzz_range | random / 100.0) %}
	{% set adapted_y_min = y_min - mesh_margin - (fuzz_range | random / 100.0) %}
	{% set adapted_x_max = x_max + mesh_margin + (fuzz_range | random / 100.0) %}
	{% set adapted_y_max = y_max + mesh_margin + (fuzz_range | random / 100.0) %}
	
	{% set adapted_x_min = [adapted_x_min , bed_mesh_min[0]] | max %}
	{% set adapted_y_min = [adapted_y_min , bed_mesh_min[1]] | max %}
	{% set adapted_x_max = [adapted_x_max , bed_mesh_max[0]] | min %}
	{% set adapted_y_max = [adapted_y_max , bed_mesh_max[1]] | min %}
	
	{% set points_x = (((adapted_x_max - adapted_x_min) / max_probe_point_distance_x) | round(method='ceil') | int) + 1 %}
	{% set points_y = (((adapted_y_max - adapted_y_min) / max_probe_point_distance_y) | round(method='ceil') | int) + 1 %}
	
	{% if (([points_x, points_y]|max) > 6) %}
	{% set algorithm = "bicubic" %}
	{% set min_points = 4 %}
	{% else %}
	{% set algorithm = "lagrange" %}
	{% set min_points = 3 %}
	{% endif %}
	
	{% set points_x = [points_x , min_points]|max %}
	{% set points_y = [points_y , min_points]|max %}
	{% set points_x = [points_x , probe_count[0]]|min %}
	{% set points_y = [points_y , probe_count[1]]|min %}
	
	{% if verbose_enable == True %}
	{% if printer.exclude_object.objects != [] %}
	
	{ action_respond_info( "Algorithm: {}.".format(
	(algorithm),
	)) }
	
	{ action_respond_info("Default probe count: {},{}.".format(
	(probe_count[0]),
	(probe_count[1]),
	)) }
	
	{ action_respond_info("Adapted probe count: {},{}.".format(
	(points_x),
	(points_y),
	)) }
	
	{action_respond_info("Default mesh bounds: {}, {}.".format(
	(bed_mesh_min[0],bed_mesh_min[1]),
	(bed_mesh_max[0],bed_mesh_max[1]),
	)) }
	
	{% if mesh_margin > 0 %}
	{action_respond_info("Mesh margin is {}, mesh bounds extended by {}mm.".format(
	(mesh_margin),
	(mesh_margin),
	)) }
	{% else %}
	{action_respond_info("Mesh margin is 0, margin not increased.")}
	{% endif %}
	
	{% if fuzz_amount > 0 %}
	{action_respond_info("Mesh point fuzzing enabled, points fuzzed up to {}mm.".format(
	(fuzz_amount),
	)) }
	{% else %}
	{action_respond_info("Fuzz amount is 0, mesh points not fuzzed.")}
	{% endif %}
	
	{ action_respond_info("Adapted mesh bounds: {}, {}.".format(
	(adapted_x_min, adapted_y_min),
	(adapted_x_max, adapted_y_max),
	)) }
	
	{action_respond_info("KAMP adjustments successful. Happy KAMPing!")}
	
	{% else %}
	
	{action_respond_info("No objects detected! Check your gcode and make sure that EXCLUDE_OBJECT_DEFINE is happening before BED_MESH_CALIBRATE is called. Defaulting to regular meshing.")}
	G4 P5000
	{% endif %}
	
	{% endif %}
	
	{% if probe_dock_enable == True %}
	{attach_macro}
	{% endif %}
	
	_BED_MESH_CALIBRATE mesh_min={adapted_x_min},{adapted_y_min} mesh_max={adapted_x_max},{adapted_y_max} ALGORITHM={algorithm} PROBE_COUNT={points_x},{points_y}
	
	{% if probe_dock_enable == True %}
	{detach_macro}
	{% endif %}

[gcode_macro _KAMP_Settings]
description = This macro contains all adjustable settings for KAMP
variable_verbose_enable = True
variable_mesh_margin = 0
variable_fuzz_amount = 0
variable_probe_dock_enable = False
variable_attach_macro = 'Attach_Probe'
variable_detach_macro = 'Dock_Probe'
variable_purge_height = 0.8
variable_tip_distance = 0
variable_purge_margin = 10
variable_purge_amount = 30
variable_flow_rate = 12
variable_smart_park_height = 10
gcode = 
	
	{action_respond_info(" Running the KAMP_Settings macro does nothing, it is only used for storing KAMP settings. ")}

[led_effect sb_logo_busy]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (1,0,0)

[led_effect sb_logo_cleaning]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 0.02, 0.5)

[led_effect sb_logo_calibrating_z]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 0.0, 0.35)

[led_effect sb_logo_heating]
leds = 
	neopixel:sb_leds (1,3,7,8,6,2)
autostart = false
frame_rate = 24
layers = 
	comet  0.3  0 add (1, 0.18, 0)

[led_effect sb_logo_cooling]
leds = 
	neopixel:sb_leds (1,3,7,8,6,2)
autostart = false
frame_rate = 24
layers = 
	comet  0.3  0 add (0, 0, 1)

[led_effect sb_logo_homing]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 0.6, 0.2)

[led_effect sb_logo_leveling]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.5, 0.1, 0.4)

[led_effect sb_logo_meshing]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.2, 1.0, 0.0)

[led_effect sb_logo_printing]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	gradient  0.3  1 add (0.3, 0.0, 0.0),(0.3, 0.3, 0.0),(0.3, 0.1, 0.0)

[led_effect sb_logo_standby]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.01, 0.01, 0.01)

[led_effect sb_logo_part_ready]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 1.0, 0.0)

[led_effect sb_nozzle_heating]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (1.0, 0.18, 0.0, 0.0)

[led_effect sb_nozzle_cooling]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (0.0, 0.0, 1.0, 0.1)

[led_effect sb_nozzle_standby]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (0.6, 0.0, 0.0, 0.0)

[led_effect sb_nozzle_part_ready]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (0.6, 1.0, 0.0, 0.1)

[led_effect sb_critical_error]
leds = 
	neopixel:sb_leds
layers = 
	strobe         1  1.5   add        (1.0,  1.0, 1.0)
	breathing      2  0     difference (0.95, 0.0, 0.0)
	static         1  0     top        (1.0,  0.0, 0.0)
autostart = false
frame_rate = 24
run_on_error = true

[led_effect rainbow]
leds = 
	neopixel:chamber_leds
autostart = false
frame_rate = 24
layers = 
	gradient  0.3  1 add (0.3, 0.0, 0.0),(0.0, 0.3, 0.0),(0.0, 0.0, 0.3)

[led_effect set_nozzle_leds]
leds = 
	neopixel:sb_leds (9,10)
autostart = false
frame_rate = 24
layers = 
	static         0  0     top        (0.0,  0.0, 0.0, 1.0)

[led_effect set_logo_leds]
leds = 
	neopixel:sb_leds (1,2,3,4,5,6,7,8)
autostart = false
frame_rate = 24
layers = 
	static         0  0     top        (1.0,  1.0, 1.0)

[led_effect set_chamber_leds]
leds = 
	neopixel:chamber_leds
autostart = false
frame_rate = 24
layers = 
	static         0  0     top        (1.0,  1.0, 1.0)

[gcode_macro set_logo_leds_off]
gcode = 
	SET_LED_EFFECT EFFECT=set_logo_leds STOP=1

[gcode_macro set_logo_leds_on]
gcode = 
	SET_LED_EFFECT EFFECT=set_logo_leds

[gcode_macro set_nozzle_leds_on]
gcode = 
	SET_LED_EFFECT EFFECT=set_nozzle_leds

[gcode_macro set_nozzle_leds_off]
gcode = 
	SET_LED_EFFECT EFFECT=set_nozzle_leds STOP=1

[gcode_macro set_chamber_leds_off]
gcode = 
	SET_LED_EFFECT EFFECT=set_chamber_leds STOP=1

[gcode_macro set_chamber_leds_on]
gcode = 
	SET_LED_EFFECT EFFECT=set_chamber_leds

[gcode_macro status_off]
gcode = 
	STOP_LED_EFFECTS

[gcode_macro status_ready]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=rainbow

[gcode_macro status_part_ready]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_nozzle_part_ready
	SET_LED_EFFECT EFFECT=sb_logo_part_ready

[gcode_macro status_busy]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_busy
	set_nozzle_leds_on

[gcode_macro status_heating]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_heating
	SET_LED_EFFECT EFFECT=sb_nozzle_heating

[gcode_macro status_cooling]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_cooling
	SET_LED_EFFECT EFFECT=sb_nozzle_cooling

[gcode_macro status_leveling]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_leveling
	set_nozzle_leds_on

[gcode_macro status_homing]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_homing
	set_nozzle_leds_on

[gcode_macro status_cleaning]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_cleaning
	set_nozzle_leds_on

[gcode_macro status_meshing]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_meshing
	set_nozzle_leds_on

[gcode_macro status_calibrating_z]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_calibrating_z
	set_nozzle_leds_on

[gcode_macro status_printing]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_printing
	set_nozzle_leds_on

[printer]
kinematics = corexy
max_velocity = 300
max_accel = 5700
max_z_velocity = 5
max_z_accel = 100
square_corner_velocity = 5.0

[mcu]
serial = /dev/serial/by-id/usb-Klipper_lpc1769_1520010CC09869AF0AC1405EC52000F5-if00

[mcu rpi]
serial = /tmp/klipper_host_mcu

[adxl345]
cs_pin = rpi:None

[resonance_tester]
accel_chip = adxl345
probe_points = 
	189,185,20

[input_shaper]
shaper_freq_x = 61.8
shaper_type_x = mzv
shaper_freq_y = 38.4
shaper_type_y = zv

[stepper_x]
step_pin = P1.4
dir_pin = !P1.8
enable_pin = !P1.0
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 40
endstop_pin = ^P1.29
position_endstop = 383
position_min = -5
position_max = 383
homing_speed = 25
homing_retract_dist = 5.0

[tmc2209 stepper_x]
uart_pin = P1.1
interpolate = False
run_current = 1.00
stealthchop_threshold = 0

[stepper_y]
step_pin = P1.14
dir_pin = !P1.15
enable_pin = !P1.9
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 40
endstop_pin = ^P1.28
position_endstop = 392
position_min = -8
position_max = 392
homing_speed = 25
homing_retract_dist = 5.0

[tmc2209 stepper_y]
uart_pin = P1.10
interpolate = False
run_current = 1.00
stealthchop_threshold = 0

[stepper_z]
step_pin = P4.29
dir_pin = !P4.28
enable_pin = !P1.16
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 4
endstop_pin = probe:z_virtual_endstop
position_min = -5
position_max = 395

[tmc2209 stepper_z]
uart_pin = P1.17
interpolate = False
run_current = 0.580
stealthchop_threshold = 0

[stepper_z1]
step_pin = P2.11
dir_pin = !P2.12
enable_pin = !P0.21
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 4

[tmc2209 stepper_z1]
uart_pin = P0.22
interpolate = False
run_current = 0.580
stealthchop_threshold = 0

[extruder]
step_pin = P2.6
dir_pin = !P2.7
enable_pin = !P0.4
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 35.291
gear_ratio = 7.5:1
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = P2.3
sensor_type = PT1000
sensor_pin = P0.24
control = pid
pid_kp = 14.430
pid_ki = 1.023
pid_kd = 50.866
min_temp = 10
max_temp = 350
max_extrude_only_distance = 500
max_extrude_only_velocity = 120
min_extrude_temp = 180
max_extrude_cross_section = 50.
pressure_advance = 0.000
pressure_advance_smooth_time = 0.03

[tmc2209 extruder]
uart_pin = P0.5
interpolate = false
run_current = 0.79
stealthchop_threshold = 0
driver_tbl = 0
driver_hend = 6
driver_hstrt = 7
driver_toff = 4

[static_digital_output tmc_standby_pins]
pins = !P3.26, !P3.25, !P1.18, !P1.19, !P2.13

[heater_bed]
heater_pin = P2.5
sensor_type = EPCOS 100K B57560G104F
sensor_pin = P0.25
control = pid
pid_kp = 68.561
pid_ki = 0.619
pid_kd = 1897.417
min_temp = 0
max_temp = 130

[idle_timeout]
timeout = 3600

[bltouch]
sensor_pin = ^P1.27
control_pin = P1.23
x_offset = -33
y_offset = -5
z_offset = 2.500
samples = 1
samples_result = average
sample_retract_dist = 2.0
samples_tolerance = 0.05
samples_tolerance_retries = 3
stow_on_each_sample = False

[safe_z_home]
home_xy_position = 221,190
speed = 60
z_hop = 12
z_hop_speed = 5

[screws_tilt_adjust]
screw1 = 69, 319
screw1_name = rear left screw
screw2 = 368, 60
screw2_name = front right screw
screw3 = 368, 319
screw3_name = rear right screw
screw4 = 69, 60
screw4_name = front left screw
horizontal_move_z = 10.
speed = 50.
screw_thread = CW-M4

[z_tilt]
z_positions = -20, 183
	402, 183
points = 56, 183
	383, 183
speed = 50
horizontal_move_z = 10
retries = 20
retry_tolerance = 0.01

[bed_mesh]
speed = 120
horizontal_move_z = 5
mesh_min = 50, 80
mesh_max = 323, 314
probe_count = 7, 7
algorithm = bicubic
bicubic_tension = 0.5
fade_start = 0.6
fade_end = 10
fade_target = 0

[fan]
pin = P2.1

[heater_fan heatbreak_cooling_fan]
pin = P2.2

[display]
lcd_type = st7920
menu_timeout = 600
cs_pin = EXP1_7
sclk_pin = EXP1_6
sid_pin = EXP1_8
encoder_pins = ^EXP1_5, ^EXP1_3
click_pin = ^!EXP1_2

[output_pin beeper]
pin = EXP1_1

[board_pins]
aliases = 
	
	EXP1_1=P2.8,  EXP1_3=P0.19, EXP1_5=P0.20, EXP1_7=P0.17, EXP1_9=<GND>,
	EXP1_2=P0.16, EXP1_4=<RST>, EXP1_6=P0.15, EXP1_8=P0.18, EXP1_10=<5V>

[filament_motion_sensor SmartFilamentSensor_T0]
detection_length = 7.00
extruder = extruder
switch_pin = ^P1.26
pause_on_runout = True
event_delay = 3.0
pause_delay = 0.5
runout_gcode = 
	M117 Runout Detected!

[temperature_sensor raspberry_pi]
sensor_type = temperature_host
min_temp = 10
max_temp = 100

[temperature_sensor Mainboard]
sensor_type = NTC 100K MGB18-104F39050L32
sensor_pin = P1.30
min_temp = 10
max_temp = 100

[neopixel chamber_leds]
pin = P1.22
chain_count = 85
color_order = GRB
initial_red = 0.0
initial_green = 0.0
initial_blue = 0.0
initial_white = 0.0

[neopixel sb_leds]
pin = P1.24
chain_count = 10
color_order = GRB,GRB,GRB,GRB,GRB,GRB,GRB,GRB,GRBW,GRBW
initial_red = 0.0
initial_green = 0.0
initial_blue = 0.0
initial_white = 0.0

[exclude_object]

[gcode_arcs]
resolution = 0.1
=======================
Extruder max_extrude_ratio=20.787584
mcu 'mcu': Starting serial connect
Loaded MCU 'mcu' 105 commands (v0.11.0-205-g5f0d252b / gcc: (15:8-2019-q3-1+b1) 8.3.1 20190703 (release) [gcc-8-branch revision 273027] binutils: (2.34-4+rpi1+14) 2.34)
MCU 'mcu' config: ADC_MAX=4095 BUS_PINS_i2c0=P0.28,P0.27 BUS_PINS_i2c1=P0.1,P0.0 BUS_PINS_i2c1a=P0.20,P0.19 BUS_PINS_i2c2=P0.11,P0.10 BUS_PINS_ssp0=P0.17,P0.18,P0.15 BUS_PINS_ssp1=P0.8,P0.9,P0.7 CLOCK_FREQ=120000000 MCU=lpc1769 PWM_MAX=255 RESERVE_PINS_USB=P0.30,P0.29,P2.9 STATS_SUMSQ_BASE=256 STEPPER_BOTH_EDGE=1
mcu 'rpi': Starting connect
Loaded MCU 'rpi' 113 commands (v0.11.0-240-g6d48adf9 / gcc: (Raspbian 10.2.1-6+rpi1) 10.2.1 20210110 binutils: (GNU Binutils for Raspbian) 2.35.2)
MCU 'rpi' config: ADC_MAX=4095 CLOCK_FREQ=50000000 MCU=linux PCA9685_MAX=4096 PWM_MAX=32768 STATS_SUMSQ_BASE=256
Sending MCU 'mcu' printer configuration...
Configured MCU 'mcu' (1024 moves)
Sending MCU 'rpi' printer configuration...
Configured MCU 'rpi' (1024 moves)
Starting heater checks for heater_bed
bed_mesh: generated points
Index |  Tool Adjusted  |   Probe
  0   | (83.0, 85.0)    | (50.0, 80.0)
  1   | (128.5, 85.0)   | (95.5, 80.0)
  2   | (174.0, 85.0)   | (141.0, 80.0)
  3   | (219.5, 85.0)   | (186.5, 80.0)
  4   | (265.0, 85.0)   | (232.0, 80.0)
  5   | (310.5, 85.0)   | (277.5, 80.0)
  6   | (356.0, 85.0)   | (323.0, 80.0)
  7   | (356.0, 124.0)  | (323.0, 119.0)
  8   | (310.5, 124.0)  | (277.5, 119.0)
  9   | (265.0, 124.0)  | (232.0, 119.0)
  10  | (219.5, 124.0)  | (186.5, 119.0)
  11  | (174.0, 124.0)  | (141.0, 119.0)
  12  | (128.5, 124.0)  | (95.5, 119.0)
  13  | (83.0, 124.0)   | (50.0, 119.0)
  14  | (83.0, 163.0)   | (50.0, 158.0)
  15  | (128.5, 163.0)  | (95.5, 158.0)
  16  | (174.0, 163.0)  | (141.0, 158.0)
  17  | (219.5, 163.0)  | (186.5, 158.0)
  18  | (265.0, 163.0)  | (232.0, 158.0)
  19  | (310.5, 163.0)  | (277.5, 158.0)
  20  | (356.0, 163.0)  | (323.0, 158.0)
  21  | (356.0, 202.0)  | (323.0, 197.0)
  22  | (310.5, 202.0)  | (277.5, 197.0)
  23  | (265.0, 202.0)  | (232.0, 197.0)
  24  | (219.5, 202.0)  | (186.5, 197.0)
  25  | (174.0, 202.0)  | (141.0, 197.0)
  26  | (128.5, 202.0)  | (95.5, 197.0)
  27  | (83.0, 202.0)   | (50.0, 197.0)
  28  | (83.0, 241.0)   | (50.0, 236.0)
  29  | (128.5, 241.0)  | (95.5, 236.0)
  30  | (174.0, 241.0)  | (141.0, 236.0)
  31  | (219.5, 241.0)  | (186.5, 236.0)
  32  | (265.0, 241.0)  | (232.0, 236.0)
  33  | (310.5, 241.0)  | (277.5, 236.0)
  34  | (356.0, 241.0)  | (323.0, 236.0)
  35  | (356.0, 280.0)  | (323.0, 275.0)
  36  | (310.5, 280.0)  | (277.5, 275.0)
  37  | (265.0, 280.0)  | (232.0, 275.0)
  38  | (219.5, 280.0)  | (186.5, 275.0)
  39  | (174.0, 280.0)  | (141.0, 275.0)
  40  | (128.5, 280.0)  | (95.5, 275.0)
  41  | (83.0, 280.0)   | (50.0, 275.0)
  42  | (83.0, 319.0)   | (50.0, 314.0)
  43  | (128.5, 319.0)  | (95.5, 314.0)
  44  | (174.0, 319.0)  | (141.0, 314.0)
  45  | (219.5, 319.0)  | (186.5, 314.0)
  46  | (265.0, 319.0)  | (232.0, 314.0)
  47  | (310.5, 319.0)  | (277.5, 314.0)
  48  | (356.0, 319.0)  | (323.0, 314.0)
Starting heater checks for extruder
webhooks client 4126636304: New connection
webhooks client 4126636304: Client info {'program': 'Moonraker', 'version': 'v0.8.0-247-g3008a13'}
webhooks: registering remote method 'shutdown_machine' for connection id: 4126636304
webhooks: registering remote method 'reboot_machine' for connection id: 4126636304
webhooks: registering remote method 'pause_job_queue' for connection id: 4126636304
webhooks: registering remote method 'start_job_queue' for connection id: 4126636304
Running Command {update_git_script}...:
Resetting prediction variance 81.687: freq=50000042 diff=14420705 stddev=19724.968
Klipper-backup is up to date


